/*! For license information please see gcanvas.min.js.LICENSE.txt */
(()=>{var t={6729:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,r,o,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,o||t,a),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],s]:t._events[u].push(s):(t._events[u]=s,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=new Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,i,o,a){var s=n?n+t:t;if(!this._events[s])return!1;var u,c,h=this._events[s],l=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),l){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,r),!0;case 4:return h.fn.call(h.context,e,r,i),!0;case 5:return h.fn.call(h.context,e,r,i,o),!0;case 6:return h.fn.call(h.context,e,r,i,o,a),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];h.fn.apply(h.context,u)}else{var p,f=h.length;for(c=0;c<f;c++)switch(h[c].once&&this.removeListener(t,h[c].fn,void 0,!0),l){case 1:h[c].fn.call(h[c].context);break;case 2:h[c].fn.call(h[c].context,e);break;case 3:h[c].fn.call(h[c].context,e,r);break;case 4:h[c].fn.call(h[c].context,e,r,i);break;default:if(!u)for(p=1,u=new Array(l-1);p<l;p++)u[p-1]=arguments[p];h[c].fn.apply(h[c].context,u)}}return!0},s.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,i){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,c=[],h=s.length;u<h;u++)(s[u].fn!==e||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s},9934:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tagProperty=e.tagParameter=e.decorate=void 0;var r=n(6674),i=n(6867);function o(t,e,n,i,o){var a={},s="number"==typeof o,u=void 0!==o&&s?o.toString():n;if(s&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(t,e)&&(a=Reflect.getMetadata(t,e));var c=a[u];if(Array.isArray(c))for(var h=0,l=c;h<l.length;h++){var p=l[h];if(p.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+p.key.toString())}else c=[];c.push(i),a[u]=c,Reflect.defineMetadata(t,a,e)}function a(t,e){Reflect.decorate(t,e)}function s(t,e){return function(n,r){e(n,r,t)}}e.tagParameter=function(t,e,n,r){o(i.TAGGED,t,e,r,n)},e.tagProperty=function(t,e,n){o(i.TAGGED_PROP,t.constructor,e,n)},e.decorate=function(t,e,n){"number"==typeof n?a([s(n,t)],e):"string"==typeof n?Reflect.decorate([t],e,n):a([t],e)}},5744:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.inject=e.LazyServiceIdentifer=void 0;var r=n(6674),i=n(6867),o=n(7738),a=n(9934),s=function(){function t(t){this._cb=t}return t.prototype.unwrap=function(){return this._cb()},t}();e.LazyServiceIdentifer=s,e.inject=function(t){return function(e,n,s){if(void 0===t)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(e.name));var u=new o.Metadata(i.INJECT_TAG,t);"number"==typeof s?a.tagParameter(e,n,s,u):a.tagProperty(e,n,u)}}},4315:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.injectable=void 0;var r=n(6674),i=n(6867);e.injectable=function(){return function(t){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,t))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,t)||[];return Reflect.defineMetadata(i.PARAM_TYPES,e,t),t}}},1693:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiInject=void 0;var r=n(6867),i=n(7738),o=n(9934);e.multiInject=function(t){return function(e,n,a){var s=new i.Metadata(r.MULTI_INJECT_TAG,t);"number"==typeof a?o.tagParameter(e,n,a,s):o.tagProperty(e,n,s)}}},8085:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.named=void 0;var r=n(6867),i=n(7738),o=n(9934);e.named=function(t){return function(e,n,a){var s=new i.Metadata(r.NAMED_TAG,t);"number"==typeof a?o.tagParameter(e,n,a,s):o.tagProperty(e,n,s)}}},6515:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.optional=void 0;var r=n(6867),i=n(7738),o=n(9934);e.optional=function(){return function(t,e,n){var a=new i.Metadata(r.OPTIONAL_TAG,!0);"number"==typeof n?o.tagParameter(t,e,n,a):o.tagProperty(t,e,a)}}},7014:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.postConstruct=void 0;var r=n(6674),i=n(6867),o=n(7738);e.postConstruct=function(){return function(t,e,n){var a=new o.Metadata(i.POST_CONSTRUCT,e);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,t.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,a,t.constructor)}}},2052:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.tagged=void 0;var r=n(7738),i=n(9934);e.tagged=function(t,e){return function(n,o,a){var s=new r.Metadata(t,e);"number"==typeof a?i.tagParameter(n,o,a,s):i.tagProperty(n,o,s)}}},5638:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.targetName=void 0;var r=n(6867),i=n(7738),o=n(9934);e.targetName=function(t){return function(e,n,a){var s=new i.Metadata(r.NAME_TAG,t);o.tagParameter(e,n,a,s)}}},6757:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.unmanaged=void 0;var r=n(6867),i=n(7738),o=n(9934);e.unmanaged=function(){return function(t,e,n){var a=new i.Metadata(r.UNMANAGED_TAG,!0);o.tagParameter(t,e,n,a)}}},4290:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Binding=void 0;var r=n(8421),i=n(7791),o=function(){function t(t,e){this.id=i.id(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(t){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return t.prototype.clone=function(){var e=new t(this.serviceIdentifier,this.scope);return e.activated=e.scope===r.BindingScopeEnum.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.cache=this.cache,e},t}();e.Binding=o},3184:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingCount=void 0,e.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},6674:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STACK_OVERFLOW=e.CIRCULAR_DEPENDENCY_IN_FACTORY=e.POST_CONSTRUCT_ERROR=e.MULTIPLE_POST_CONSTRUCT_METHODS=e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=e.ARGUMENTS_LENGTH_MISMATCH=e.INVALID_DECORATOR_OPERATION=e.INVALID_TO_SELF_VALUE=e.INVALID_FUNCTION_BINDING=e.INVALID_MIDDLEWARE_RETURN=e.NO_MORE_SNAPSHOTS_AVAILABLE=e.INVALID_BINDING_TYPE=e.NOT_IMPLEMENTED=e.CIRCULAR_DEPENDENCY=e.UNDEFINED_INJECT_ANNOTATION=e.MISSING_INJECT_ANNOTATION=e.MISSING_INJECTABLE_ANNOTATION=e.NOT_REGISTERED=e.CANNOT_UNBIND=e.AMBIGUOUS_MATCH=e.KEY_NOT_FOUND=e.NULL_ARGUMENT=e.DUPLICATED_METADATA=e.DUPLICATED_INJECTABLE_DECORATOR=void 0,e.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",e.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",e.NULL_ARGUMENT="NULL argument",e.KEY_NOT_FOUND="Key Not Found",e.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",e.CANNOT_UNBIND="Could not unbind serviceIdentifier:",e.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",e.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",e.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",e.UNDEFINED_INJECT_ANNOTATION=function(t){return"@inject called with undefined this could mean that the class "+t+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},e.CIRCULAR_DEPENDENCY="Circular dependency found:",e.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",e.INVALID_BINDING_TYPE="Invalid binding type:",e.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",e.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",e.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",e.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",e.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",e.ARGUMENTS_LENGTH_MISMATCH=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"The number of constructor arguments in the derived class "+t[0]+" must be >= than the number of constructor arguments of its base class."},e.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",e.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",e.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",e.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",e.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",e.POST_CONSTRUCT_ERROR=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"@postConstruct error in class "+t[0]+": "+t[1]},e.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return"It looks like there is a circular dependency in one of the '"+t[0]+"' bindings. Please investigate bindings withservice identifier '"+t[1]+"'."},e.STACK_OVERFLOW="Maximum call stack size exceeded"},8421:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TargetTypeEnum=e.BindingTypeEnum=e.BindingScopeEnum=void 0,e.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"},e.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},e.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},6867:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NON_CUSTOM_TAG_KEYS=e.POST_CONSTRUCT=e.DESIGN_PARAM_TYPES=e.PARAM_TYPES=e.TAGGED_PROP=e.TAGGED=e.MULTI_INJECT_TAG=e.INJECT_TAG=e.OPTIONAL_TAG=e.UNMANAGED_TAG=e.NAME_TAG=e.NAMED_TAG=void 0,e.NAMED_TAG="named",e.NAME_TAG="name",e.UNMANAGED_TAG="unmanaged",e.OPTIONAL_TAG="optional",e.INJECT_TAG="inject",e.MULTI_INJECT_TAG="multi_inject",e.TAGGED="inversify:tagged",e.TAGGED_PROP="inversify:tagged_props",e.PARAM_TYPES="inversify:paramtypes",e.DESIGN_PARAM_TYPES="design:paramtypes",e.POST_CONSTRUCT="post_construct",e.NON_CUSTOM_TAG_KEYS=[e.INJECT_TAG,e.MULTI_INJECT_TAG,e.NAME_TAG,e.UNMANAGED_TAG,e.NAMED_TAG,e.OPTIONAL_TAG]},1389:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;var a=n(4290),s=n(6674),u=n(8421),c=n(6867),h=n(1377),l=n(6311),p=n(1927),f=n(1860),d=n(7791),y=n(5800),v=n(5700),g=n(175),m=function(){function t(t){this._appliedMiddleware=[];var e=t||{};if("object"!=typeof e)throw new Error(""+s.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===e.defaultScope)e.defaultScope=u.BindingScopeEnum.Transient;else if(e.defaultScope!==u.BindingScopeEnum.Singleton&&e.defaultScope!==u.BindingScopeEnum.Transient&&e.defaultScope!==u.BindingScopeEnum.Request)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===e.autoBindInjectable)e.autoBindInjectable=!1;else if("boolean"!=typeof e.autoBindInjectable)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===e.skipBaseClassChecks)e.skipBaseClassChecks=!1;else if("boolean"!=typeof e.skipBaseClassChecks)throw new Error(""+s.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:e.autoBindInjectable,defaultScope:e.defaultScope,skipBaseClassChecks:e.skipBaseClassChecks},this.id=d.id(),this._bindingDictionary=new g.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new h.MetadataReader}return t.merge=function(e,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var a=new t,s=o([e,n],r).map((function(t){return l.getBindingDictionary(t)})),u=l.getBindingDictionary(a);function c(t,e){t.traverse((function(t,n){n.forEach((function(t){e.add(t.serviceIdentifier,t.clone())}))}))}return s.forEach((function(t){c(t,u)})),a},t.prototype.load=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=t;r<i.length;r++){var o=i[r],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)}},t.prototype.loadAsync=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(this,void 0,void 0,(function(){var e,n,r,o,a;return i(this,(function(i){switch(i.label){case 0:e=this._getContainerModuleHelpersFactory(),n=0,r=t,i.label=1;case 1:return n<r.length?(o=r[n],a=e(o.id),[4,o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.unload=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(t){return function(e){return e.moduleId===t}};e.forEach((function(e){var n=r(e.id);t._bindingDictionary.removeByCondition(n)}))},t.prototype.bind=function(t){var e=this.options.defaultScope||u.BindingScopeEnum.Transient,n=new a.Binding(t,e);return this._bindingDictionary.add(t,n),new f.BindingToSyntax(n)},t.prototype.rebind=function(t){return this.unbind(t),this.bind(t)},t.prototype.unbind=function(t){try{this._bindingDictionary.remove(t)}catch(e){throw new Error(s.CANNOT_UNBIND+" "+y.getServiceIdentifierAsString(t))}},t.prototype.unbindAll=function(){this._bindingDictionary=new g.Lookup},t.prototype.isBound=function(t){var e=this._bindingDictionary.hasKey(t);return!e&&this.parent&&(e=this.parent.isBound(t)),e},t.prototype.isBoundNamed=function(t,e){return this.isBoundTagged(t,c.NAMED_TAG,e)},t.prototype.isBoundTagged=function(t,e,n){var r=!1;if(this._bindingDictionary.hasKey(t)){var i=this._bindingDictionary.get(t),o=l.createMockRequest(this,t,e,n);r=i.some((function(t){return t.constraint(o)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(t,e,n)),r},t.prototype.snapshot=function(){this._snapshots.push(v.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},t.prototype.restore=function(){var t=this._snapshots.pop();if(void 0===t)throw new Error(s.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=t.bindings,this._middleware=t.middleware},t.prototype.createChild=function(e){var n=new t(e||this.options);return n.parent=this,n},t.prototype.applyMiddleware=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._appliedMiddleware=this._appliedMiddleware.concat(t);var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=t.reduce((function(t,e){return e(t)}),n)},t.prototype.applyCustomMetadataReader=function(t){this._metadataReader=t},t.prototype.get=function(t){return this._get(!1,!1,u.TargetTypeEnum.Variable,t)},t.prototype.getTagged=function(t,e,n){return this._get(!1,!1,u.TargetTypeEnum.Variable,t,e,n)},t.prototype.getNamed=function(t,e){return this.getTagged(t,c.NAMED_TAG,e)},t.prototype.getAll=function(t){return this._get(!0,!0,u.TargetTypeEnum.Variable,t)},t.prototype.getAllTagged=function(t,e,n){return this._get(!1,!0,u.TargetTypeEnum.Variable,t,e,n)},t.prototype.getAllNamed=function(t,e){return this.getAllTagged(t,c.NAMED_TAG,e)},t.prototype.resolve=function(t){var e=this.createChild();return e.bind(t).toSelf(),this._appliedMiddleware.forEach((function(t){e.applyMiddleware(t)})),e.get(t)},t.prototype._getContainerModuleHelpersFactory=function(){var t=this,e=function(t,e){t._binding.moduleId=e},n=function(n){return function(r){var i=t.rebind.bind(t)(r);return e(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=t.bind.bind(t)(n);return e(r,i),r}),isboundFunction:function(e){return t.isBound.bind(t)(e)},rebindFunction:n(r),unbindFunction:function(e){t.unbind.bind(t)(e)}};var i}},t.prototype._get=function(t,e,n,r,i,o){var a=null,u={avoidConstraints:t,contextInterceptor:function(t){return t},isMultiInject:e,key:i,serviceIdentifier:r,targetType:n,value:o};if(this._middleware){if(null==(a=this._middleware(u)))throw new Error(s.INVALID_MIDDLEWARE_RETURN)}else a=this._planAndResolve()(u);return a},t.prototype._planAndResolve=function(){var t=this;return function(e){var n=l.plan(t._metadataReader,t,e.isMultiInject,e.targetType,e.serviceIdentifier,e.key,e.value,e.avoidConstraints);return n=e.contextInterceptor(n),p.resolve(n)}},t}();e.Container=m},3244:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AsyncContainerModule=e.ContainerModule=void 0;var r=n(7791);e.ContainerModule=function(t){this.id=r.id(),this.registry=t};e.AsyncContainerModule=function(t){this.id=r.id(),this.registry=t}},5700:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ContainerSnapshot=void 0;var n=function(){function t(){}return t.of=function(e,n){var r=new t;return r.bindings=e,r.middleware=n,r},t}();e.ContainerSnapshot=n},175:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Lookup=void 0;var r=n(6674),i=function(){function t(){this._map=new Map}return t.prototype.getMap=function(){return this._map},t.prototype.add=function(t,e){if(null==t)throw new Error(r.NULL_ARGUMENT);if(null==e)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(t);void 0!==n?(n.push(e),this._map.set(t,n)):this._map.set(t,[e])},t.prototype.get=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);var e=this._map.get(t);if(void 0!==e)return e;throw new Error(r.KEY_NOT_FOUND)},t.prototype.remove=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(t))throw new Error(r.KEY_NOT_FOUND)},t.prototype.removeByCondition=function(t){var e=this;this._map.forEach((function(n,r){var i=n.filter((function(e){return!t(e)}));i.length>0?e._map.set(r,i):e._map.delete(r)}))},t.prototype.hasKey=function(t){if(null==t)throw new Error(r.NULL_ARGUMENT);return this._map.has(t)},t.prototype.clone=function(){var e=new t;return this._map.forEach((function(t,n){t.forEach((function(t){return e.add(n,t.clone())}))})),e},t.prototype.traverse=function(t){this._map.forEach((function(e,n){t(n,e)}))},t}();e.Lookup=i},6700:(t,e,n)=>{"use strict";e.GW=e.zY=e.f3=e.t6=e.b2=e.W2=void 0,n(6867);var r=n(1389);Object.defineProperty(e,"W2",{enumerable:!0,get:function(){return r.Container}});n(8421),n(3244);var i=n(4315);Object.defineProperty(e,"b2",{enumerable:!0,get:function(){return i.injectable}});n(2052);var o=n(8085);Object.defineProperty(e,"t6",{enumerable:!0,get:function(){return o.named}});var a=n(5744);Object.defineProperty(e,"f3",{enumerable:!0,get:function(){return a.inject}});n(6515),n(6757),n(1693),n(5638);var s=n(7014);Object.defineProperty(e,"zY",{enumerable:!0,get:function(){return s.postConstruct}});n(1377),n(7791);var u=n(9934);Object.defineProperty(e,"GW",{enumerable:!0,get:function(){return u.decorate}});n(758),n(5800),n(600)},5228:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Context=void 0;var r=n(7791),i=function(){function t(t){this.id=r.id(),this.container=t}return t.prototype.addPlan=function(t){this.plan=t},t.prototype.setCurrentRequest=function(t){this.currentRequest=t},t}();e.Context=i},7738:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var r=n(6867),i=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},t}();e.Metadata=i},1377:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MetadataReader=void 0;var r=n(6867),i=function(){function t(){}return t.prototype.getConstructorMetadata=function(t){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,t),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,t)||{}}},t.prototype.getPropertiesMetadata=function(t){return Reflect.getMetadata(r.TAGGED_PROP,t)||[]},t}();e.MetadataReader=i},5314:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plan=void 0;e.Plan=function(t,e){this.parentContext=t,this.rootRequest=e}},6311:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBindingDictionary=e.createMockRequest=e.plan=void 0;var r=n(3184),i=n(6674),o=n(8421),a=n(6867),s=n(5265),u=n(5800),c=n(5228),h=n(7738),l=n(5314),p=n(6e3),f=n(6748),d=n(8924);function y(t){return t._bindingDictionary}function v(t,e,n,o,a){var s,c=m(n.container,a.serviceIdentifier);return c.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof a.serviceIdentifier&&t.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(a.serviceIdentifier).toSelf(),c=m(n.container,a.serviceIdentifier)),s=e?c:c.filter((function(t){var e=new f.Request(t.serviceIdentifier,n,o,t,a);return t.constraint(e)})),function(t,e,n,o){switch(e.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return e;var a=u.getServiceIdentifierAsString(t),s=i.NOT_REGISTERED;throw s+=u.listMetadataForTarget(a,n),s+=u.listRegisteredBindingsForServiceIdentifier(o,a,m),new Error(s);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return e;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return e;throw a=u.getServiceIdentifierAsString(t),s=i.AMBIGUOUS_MATCH+" "+a,s+=u.listRegisteredBindingsForServiceIdentifier(o,a,m),new Error(s)}}(a.serviceIdentifier,s,a,n.container),s}function g(t,e,n,r,a,s){var u,c;if(null===a){u=v(t,e,r,null,s),c=new f.Request(n,r,null,u,s);var h=new l.Plan(r,c);r.addPlan(h)}else u=v(t,e,r,a,s),c=a.addChildRequest(s.serviceIdentifier,u,s);u.forEach((function(e){var n=null;if(s.isArray())n=c.addChildRequest(e.serviceIdentifier,e,s);else{if(e.cache)return;n=c}if(e.type===o.BindingTypeEnum.Instance&&null!==e.implementationType){var a=p.getDependencies(t,e.implementationType);if(!r.container.options.skipBaseClassChecks){var u=p.getBaseClassDependencyCount(t,e.implementationType);if(a.length<u){var h=i.ARGUMENTS_LENGTH_MISMATCH(p.getFunctionName(e.implementationType));throw new Error(h)}}a.forEach((function(e){g(t,!1,e.serviceIdentifier,r,n,e)}))}}))}function m(t,e){var n=[],r=y(t);return r.hasKey(e)?n=r.get(e):null!==t.parent&&(n=m(t.parent,e)),n}e.getBindingDictionary=y,e.plan=function(t,e,n,r,i,o,l,p){void 0===p&&(p=!1);var f=new c.Context(e),y=function(t,e,n,r,i,o){var s=t?a.MULTI_INJECT_TAG:a.INJECT_TAG,u=new h.Metadata(s,n),c=new d.Target(e,"",n,u);if(void 0!==i){var l=new h.Metadata(i,o);c.metadata.push(l)}return c}(n,r,i,0,o,l);try{return g(t,p,i,f,null,y),f}catch(t){throw s.isStackOverflowExeption(t)&&f.plan&&u.circularDependencyToException(f.plan.rootRequest),t}},e.createMockRequest=function(t,e,n,r){var i=new d.Target(o.TargetTypeEnum.Variable,"",e,new h.Metadata(n,r)),a=new c.Context(t);return new f.Request(e,a,null,[],i)}},8460:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QueryableString=void 0;var n=function(){function t(t){this.str=t}return t.prototype.startsWith=function(t){return 0===this.str.indexOf(t)},t.prototype.endsWith=function(t){var e,n=t.split("").reverse().join("");return e=this.str.split("").reverse().join(""),this.startsWith.call({str:e},n)},t.prototype.contains=function(t){return-1!==this.str.indexOf(t)},t.prototype.equals=function(t){return this.str===t},t.prototype.value=function(){return this.str},t}();e.QueryableString=n},6e3:function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.getFunctionName=e.getBaseClassDependencyCount=e.getDependencies=void 0;var i=n(5744),o=n(6674),a=n(8421),s=n(6867),u=n(5800);Object.defineProperty(e,"getFunctionName",{enumerable:!0,get:function(){return u.getFunctionName}});var c=n(8924);function h(t,e,n,i){var a=t.getConstructorMetadata(n),s=a.compilerGeneratedMetadata;if(void 0===s){var u=o.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(u)}var c=a.userGeneratedMetadata,h=Object.keys(c),f=0===n.length&&h.length>0,d=h.length>n.length,y=function(t,e,n,r,i){for(var o=[],a=0;a<i;a++){var s=l(a,t,e,n,r);null!==s&&o.push(s)}return o}(i,e,s,c,f||d?h.length:n.length),v=p(t,n);return r(r([],y),v)}function l(t,e,n,r,s){var u=s[t.toString()]||[],h=f(u),l=!0!==h.unmanaged,p=r[t];if((p=h.inject||h.multiInject||p)instanceof i.LazyServiceIdentifer&&(p=p.unwrap()),l){if(!e&&(p===Object||p===Function||void 0===p)){var d=o.MISSING_INJECT_ANNOTATION+" argument "+t+" in class "+n+".";throw new Error(d)}var y=new c.Target(a.TargetTypeEnum.ConstructorArgument,h.targetName,p);return y.metadata=u,y}return null}function p(t,e){for(var n=t.getPropertiesMetadata(e),i=[],o=0,s=Object.keys(n);o<s.length;o++){var u=s[o],h=n[u],l=f(n[u]),d=l.targetName||u,y=l.inject||l.multiInject,v=new c.Target(a.TargetTypeEnum.ClassProperty,d,y);v.metadata=h,i.push(v)}var g=Object.getPrototypeOf(e.prototype).constructor;if(g!==Object){var m=p(t,g);i=r(r([],i),m)}return i}function f(t){var e={};return t.forEach((function(t){e[t.key.toString()]=t.value})),{inject:e[s.INJECT_TAG],multiInject:e[s.MULTI_INJECT_TAG],targetName:e[s.NAME_TAG],unmanaged:e[s.UNMANAGED_TAG]}}e.getDependencies=function(t,e){return h(t,u.getFunctionName(e),e,!1)},e.getBaseClassDependencyCount=function t(e,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=h(e,u.getFunctionName(r),r,!0),o=i.map((function(t){return t.metadata.filter((function(t){return t.key===s.UNMANAGED_TAG}))})),a=[].concat.apply([],o).length,c=i.length-a;return c>0?c:t(e,r)}return 0}},6748:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Request=void 0;var r=n(7791),i=function(){function t(t,e,n,i,o){this.id=r.id(),this.serviceIdentifier=t,this.parentContext=e,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return t.prototype.addChildRequest=function(e,n,r){var i=new t(e,this.parentContext,this,n,r);return this.childRequests.push(i),i},t}();e.Request=i},8924:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Target=void 0;var r=n(6867),i=n(7791),o=n(7738),a=n(8460),s=function(){function t(t,e,n,s){this.id=i.id(),this.type=t,this.serviceIdentifier=n,this.name=new a.QueryableString(e||""),this.metadata=new Array;var u=null;"string"==typeof s?u=new o.Metadata(r.NAMED_TAG,s):s instanceof o.Metadata&&(u=s),null!==u&&this.metadata.push(u)}return t.prototype.hasTag=function(t){for(var e=0,n=this.metadata;e<n.length;e++)if(n[e].key===t)return!0;return!1},t.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},t.prototype.matchesArray=function(t){return this.matchesTag(r.MULTI_INJECT_TAG)(t)},t.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},t.prototype.isTagged=function(){return this.metadata.some((function(t){return r.NON_CUSTOM_TAG_KEYS.every((function(e){return t.key!==e}))}))},t.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},t.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(t){return t.key===r.NAMED_TAG}))[0]:null},t.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(t){return r.NON_CUSTOM_TAG_KEYS.every((function(e){return t.key!==e}))})):null},t.prototype.matchesNamedTag=function(t){return this.matchesTag(r.NAMED_TAG)(t)},t.prototype.matchesTag=function(t){var e=this;return function(n){for(var r=0,i=e.metadata;r<i.length;r++){var o=i[r];if(o.key===t&&o.value===n)return!0}return!1}},t}();e.Target=s},2279:function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.resolveInstance=void 0;var i=n(6674),o=n(8421),a=n(6867);e.resolveInstance=function(t,e,n){var s,u,c=null;e.length>0?(u=e.filter((function(t){return null!==t.target&&t.target.type===o.TargetTypeEnum.ConstructorArgument})).map(n),c=function(t,e,n){var r=e.filter((function(t){return null!==t.target&&t.target.type===o.TargetTypeEnum.ClassProperty})),i=r.map(n);return r.forEach((function(e,n){var r;r=e.target.name.value();var o=i[n];t[r]=o})),t}(c=new((s=t).bind.apply(s,r([void 0],u))),e,n)):c=new t;return function(t,e){if(Reflect.hasMetadata(a.POST_CONSTRUCT,t)){var n=Reflect.getMetadata(a.POST_CONSTRUCT,t);try{e[n.value]()}catch(e){throw new Error(i.POST_CONSTRUCT_ERROR(t.name,e.message))}}}(t,c),c}},1927:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resolve=void 0;var r=n(6674),i=n(8421),o=n(5265),a=n(5800),s=n(2279),u=function(t,e,n){try{return n()}catch(n){throw o.isStackOverflowExeption(n)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(t,e.toString())):n}},c=function(t){return function(e){e.parentContext.setCurrentRequest(e);var n=e.bindings,o=e.childRequests,h=e.target&&e.target.isArray(),l=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(h&&l)return o.map((function(e){return c(t)(e)}));var p=null;if(!e.target.isOptional()||0!==n.length){var f=n[0],d=f.scope===i.BindingScopeEnum.Singleton,y=f.scope===i.BindingScopeEnum.Request;if(d&&f.activated)return f.cache;if(y&&null!==t&&t.has(f.id))return t.get(f.id);if(f.type===i.BindingTypeEnum.ConstantValue)p=f.cache,f.activated=!0;else if(f.type===i.BindingTypeEnum.Function)p=f.cache,f.activated=!0;else if(f.type===i.BindingTypeEnum.Constructor)p=f.implementationType;else if(f.type===i.BindingTypeEnum.DynamicValue&&null!==f.dynamicValue)p=u("toDynamicValue",f.serviceIdentifier,(function(){return f.dynamicValue(e.parentContext)}));else if(f.type===i.BindingTypeEnum.Factory&&null!==f.factory)p=u("toFactory",f.serviceIdentifier,(function(){return f.factory(e.parentContext)}));else if(f.type===i.BindingTypeEnum.Provider&&null!==f.provider)p=u("toProvider",f.serviceIdentifier,(function(){return f.provider(e.parentContext)}));else{if(f.type!==i.BindingTypeEnum.Instance||null===f.implementationType){var v=a.getServiceIdentifierAsString(e.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+v)}p=s.resolveInstance(f.implementationType,o,c(t))}return"function"==typeof f.onActivation&&(p=f.onActivation(e.parentContext,p)),d&&(f.cache=p,f.activated=!0),y&&null!==t&&!t.has(f.id)&&t.set(f.id,p),p}}};e.resolve=function(t){return c(t.plan.rootRequest.requestScope)(t.plan.rootRequest)}},3366:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingInSyntax=void 0;var r=n(8421),i=n(1325),o=function(){function t(t){this._binding=t}return t.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},t.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},t}();e.BindingInSyntax=o},9812:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingInWhenOnSyntax=void 0;var r=n(3366),i=n(1811),o=n(8370),a=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new o.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(t)}return t.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},t.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},t.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingInWhenOnSyntax=a},1811:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingOnSyntax=void 0;var r=n(8370),i=function(){function t(t){this._binding=t}return t.prototype.onActivation=function(t){return this._binding.onActivation=t,new r.BindingWhenSyntax(this._binding)},t}();e.BindingOnSyntax=i},1860:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingToSyntax=void 0;var r=n(6674),i=n(8421),o=n(9812),a=n(1325),s=function(){function t(t){this._binding=t}return t.prototype.to=function(t){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=t,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var t=this._binding.serviceIdentifier;return this.to(t)},t.prototype.toConstantValue=function(t){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toDynamicValue=function(t){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new o.BindingInWhenOnSyntax(this._binding)},t.prototype.toConstructor=function(t){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=t,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=t,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toFunction=function(t){if("function"!=typeof t)throw new Error(r.INVALID_FUNCTION_BINDING);var e=this.toConstantValue(t);return this._binding.type=i.BindingTypeEnum.Function,this._binding.scope=i.BindingScopeEnum.Singleton,e},t.prototype.toAutoFactory=function(t){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(e){return function(){return e.container.get(t)}},this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toProvider=function(t){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=t,this._binding.scope=i.BindingScopeEnum.Singleton,new a.BindingWhenOnSyntax(this._binding)},t.prototype.toService=function(t){this.toDynamicValue((function(e){return e.container.get(t)}))},t}();e.BindingToSyntax=s},1325:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingWhenOnSyntax=void 0;var r=n(1811),i=n(8370),o=function(){function t(t){this._binding=t,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return t.prototype.when=function(t){return this._bindingWhenSyntax.when(t)},t.prototype.whenTargetNamed=function(t){return this._bindingWhenSyntax.whenTargetNamed(t)},t.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},t.prototype.whenTargetTagged=function(t,e){return this._bindingWhenSyntax.whenTargetTagged(t,e)},t.prototype.whenInjectedInto=function(t){return this._bindingWhenSyntax.whenInjectedInto(t)},t.prototype.whenParentNamed=function(t){return this._bindingWhenSyntax.whenParentNamed(t)},t.prototype.whenParentTagged=function(t,e){return this._bindingWhenSyntax.whenParentTagged(t,e)},t.prototype.whenAnyAncestorIs=function(t){return this._bindingWhenSyntax.whenAnyAncestorIs(t)},t.prototype.whenNoAncestorIs=function(t){return this._bindingWhenSyntax.whenNoAncestorIs(t)},t.prototype.whenAnyAncestorNamed=function(t){return this._bindingWhenSyntax.whenAnyAncestorNamed(t)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenAnyAncestorTagged(t,e)},t.prototype.whenNoAncestorNamed=function(t){return this._bindingWhenSyntax.whenNoAncestorNamed(t)},t.prototype.whenNoAncestorTagged=function(t,e){return this._bindingWhenSyntax.whenNoAncestorTagged(t,e)},t.prototype.whenAnyAncestorMatches=function(t){return this._bindingWhenSyntax.whenAnyAncestorMatches(t)},t.prototype.whenNoAncestorMatches=function(t){return this._bindingWhenSyntax.whenNoAncestorMatches(t)},t.prototype.onActivation=function(t){return this._bindingOnSyntax.onActivation(t)},t}();e.BindingWhenOnSyntax=o},8370:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingWhenSyntax=void 0;var r=n(1811),i=n(758),o=function(){function t(t){this._binding=t}return t.prototype.when=function(t){return this._binding.constraint=t,new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetNamed=function(t){return this._binding.constraint=i.namedConstraint(t),new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(t){return null!==t.target&&!t.target.isNamed()&&!t.target.isTagged()},new r.BindingOnSyntax(this._binding)},t.prototype.whenTargetTagged=function(t,e){return this._binding.constraint=i.taggedConstraint(t)(e),new r.BindingOnSyntax(this._binding)},t.prototype.whenInjectedInto=function(t){return this._binding.constraint=function(e){return i.typeConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentNamed=function(t){return this._binding.constraint=function(e){return i.namedConstraint(t)(e.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenParentTagged=function(t,e){return this._binding.constraint=function(n){return i.taggedConstraint(t)(e)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorIs=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorIs=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.typeConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorNamed=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorNamed=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,i.namedConstraint(t))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorTagged=function(t,e){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorTagged=function(t,e){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(t)(e))},new r.BindingOnSyntax(this._binding)},t.prototype.whenAnyAncestorMatches=function(t){return this._binding.constraint=function(e){return i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t.prototype.whenNoAncestorMatches=function(t){return this._binding.constraint=function(e){return!i.traverseAncerstors(e,t)},new r.BindingOnSyntax(this._binding)},t}();e.BindingWhenSyntax=o},758:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.typeConstraint=e.namedConstraint=e.taggedConstraint=e.traverseAncerstors=void 0;var r=n(6867),i=n(7738),o=function(t,e){var n=t.parentRequest;return null!==n&&(!!e(n)||o(n,e))};e.traverseAncerstors=o;var a=function(t){return function(e){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(t)(e)};return n.metaData=new i.Metadata(t,e),n}};e.taggedConstraint=a;var s=a(r.NAMED_TAG);e.namedConstraint=s,e.typeConstraint=function(t){return function(e){var n=null;if(null!==e){if(n=e.bindings[0],"string"==typeof t)return n.serviceIdentifier===t;var r=e.bindings[0].implementationType;return t===r}return!1}}},600:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.multiBindToService=void 0,e.multiBindToService=function(t){return function(e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return t.bind(n).toService(e)}))}}}},5265:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isStackOverflowExeption=void 0;var r=n(6674);e.isStackOverflowExeption=function(t){return t instanceof RangeError||t.message===r.STACK_OVERFLOW}},7791:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.id=void 0;var n=0;e.id=function(){return n++}},5800:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.circularDependencyToException=e.listMetadataForTarget=e.listRegisteredBindingsForServiceIdentifier=e.getServiceIdentifierAsString=e.getFunctionName=void 0;var r=n(6674);function i(t){return"function"==typeof t?t.name:"symbol"==typeof t?t.toString():t}function o(t,e){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===e||o(t.parentRequest,e))}function a(t){if(t.name)return t.name;var e=t.toString(),n=e.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+e}e.getServiceIdentifierAsString=i,e.listRegisteredBindingsForServiceIdentifier=function(t,e,n){var r="",i=n(t,e);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(t){var e="Object";null!==t.implementationType&&(e=a(t.implementationType)),r=r+"\n "+e,t.constraint.metaData&&(r=r+" - "+t.constraint.metaData)}))),r},e.circularDependencyToException=function t(e){e.childRequests.forEach((function(e){if(o(e,e.serviceIdentifier)){var n=function(t){return function t(e,n){void 0===n&&(n=[]);var r=i(e.serviceIdentifier);return n.push(r),null!==e.parentRequest?t(e.parentRequest,n):n}(t).reverse().join(" --\x3e ")}(e);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}t(e)}))},e.listMetadataForTarget=function(t,e){if(e.isTagged()||e.isNamed()){var n="",r=e.getNamedTag(),i=e.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(t){n+=t.toString()+"\n"}))," "+t+"\n "+t+" - "+n}return" "+t},e.getFunctionName=a},2582:function(t){t.exports=function(){"use strict";function t(t,r,i,o,a){!function t(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,u=r-i+1,c=Math.log(s),h=.5*Math.exp(2*c/3),l=.5*Math.sqrt(c*h*(s-h)/s)*(u-s/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-u*h/s+l)),Math.min(o,Math.floor(r+(s-u)*h/s+l)),a)}var p=n[r],f=i,d=o;for(e(n,i,r),a(n[o],p)>0&&e(n,i,o);f<d;){for(e(n,f,d),f++,d--;a(n[f],p)<0;)f++;for(;a(n[d],p)>0;)d--}0===a(n[i],p)?e(n,i,d):e(n,++d,o),d<=r&&(i=d+1),r<=d&&(o=d-1)}}(t,r,i||0,o||t.length-1,a||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=d(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];s(i,t.leaf?r(a):a)}return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function d(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,o),a.push(n,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!f(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;f(t,s)&&(e.leaf?n.push(a):p(t,s)?this._all(a,n):i.push(a))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(f(t,o)){if(e.leaf||p(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=d([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,a=this.data,s=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),r=u[u.length-1],n=c.pop(),o=!0),a.leaf){var h=i(t,a.children,e);if(-1!==h)return a.children.splice(h,1),u.push(a),this._condense(u),this}o||a.leaf||!p(a,s)?r?(n++,a=r.children[n],o=!1):a=null:(u.push(a),c.push(n),n=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,a=n-e+1,s=this._maxEntries;if(a<=s)return o(i=d(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=d([])).leaf=!1,i.height=r;var u=Math.ceil(a/s),c=u*Math.ceil(Math.sqrt(s));y(t,e,n,c,this.compareMinX);for(var h=e;h<=n;h+=c){var l=Math.min(h+c-1,n);y(t,h,l,u,this.compareMinY);for(var p=h;p<=l;p+=u){var f=Math.min(p+u-1,l);i.children.push(this._build(t,p,f,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var u=e.children[s],c=h(u),l=(p=t,f=u,(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-c);l<o?(o=l,i=c<i?c:i,a=u):l===o&&c<i&&(i=c,a=u)}e=a||e.children[0]}var p,f;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),s(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=d(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=d([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,s,u,c,l,p=1/0,f=1/0,d=e;d<=n-e;d++){var y=a(t,0,d,this.toBBox),v=a(t,d,n,this.toBBox),g=(i=y,o=v,void 0,void 0,void 0,void 0,s=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),c=Math.min(i.maxX,o.maxX),l=Math.min(i.maxY,o.maxY),Math.max(0,c-s)*Math.max(0,l-u)),m=h(y)+h(v);g<p?(p=g,r=d,f=m<f?m:f):g===p&&m<f&&(f=m,r=d)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=a(t,0,e,i),u=a(t,n-e,n,i),c=l(o)+l(u),h=e;h<n-e;h++){var p=t.children[h];s(o,t.leaf?i(p):p),c+=l(o)}for(var f=n-e-1;f>=e;f--){var d=t.children[f];s(u,t.leaf?i(d):d),c+=l(u)}return c},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)s(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()},7247:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onResult:e,onDone:n}){let r="";return r+=`var _results = new Array(${this.options.taps.length});\n`,r+="var _checkDone = function() {\n",r+="for(var i = 0; i < _results.length; i++) {\n",r+="var item = _results[i];\n",r+="if(item === undefined) return false;\n",r+="if(item.result !== undefined) {\n",r+=e("item.result"),r+="return true;\n",r+="}\n",r+="if(item.error) {\n",r+=t("item.error"),r+="return true;\n",r+="}\n",r+="}\n",r+="return false;\n",r+="}\n",r+=this.callTapsParallel({onError:(t,e,n,r)=>{let i="";return i+=`if(${t} < _results.length && ((_results.length = ${t+1}), (_results[${t}] = { error: ${e} }), _checkDone())) {\n`,i+=r(!0),i+="} else {\n",i+=n(),i+="}\n",i},onResult:(t,e,n,r)=>{let i="";return i+=`if(${t} < _results.length && (${e} !== undefined && (_results.length = ${t+1}), (_results[${t}] = { result: ${e} }), _checkDone())) {\n`,i+=r(!0),i+="} else {\n",i+=n(),i+="}\n",i},onTap:(t,e,n,r)=>{let i="";return t>0&&(i+=`if(${t} >= _results.length) {\n`,i+=n(),i+="} else {\n"),i+=e(),t>0&&(i+="}\n"),i},onDone:n}),r}},a=function(t){return o.setup(this,t),o.create(t)};function s(t=[],e){const n=new r(t,e);return n.constructor=s,n.compile=a,n._call=void 0,n.call=void 0,n}s.prototype=null,t.exports=s},6714:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onDone:e}){return this.callTapsParallel({onError:(e,n,r,i)=>t(n)+i(!0),onDone:e})}},a=function(t){return o.setup(this,t),o.create(t)};function s(t=[],e){const n=new r(t,e);return n.constructor=s,n.compile=a,n._call=void 0,n.call=void 0,n}s.prototype=null,t.exports=s},1293:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onResult:e,resultReturns:n,onDone:r}){return this.callTapsSeries({onError:(e,n,r,i)=>t(n)+i(!0),onResult:(t,n,r)=>`if(${n} !== undefined) {\n${e(n)}\n} else {\n${r()}}\n`,resultReturns:n,onDone:r})}},a=function(t){return o.setup(this,t),o.create(t)};function s(t=[],e){const n=new r(t,e);return n.constructor=s,n.compile=a,n._call=void 0,n.call=void 0,n}s.prototype=null,t.exports=s},1617:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onDone:e}){return this.callTapsSeries({onError:(e,n,r,i)=>t(n)+i(!0),onDone:e})}},a=function(t){return o.setup(this,t),o.create(t)};function s(t=[],e){const n=new r(t,e);return n.constructor=s,n.compile=a,n._call=void 0,n.call=void 0,n}s.prototype=null,t.exports=s},996:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onDone:e}){return this.callTapsLooping({onError:(e,n,r,i)=>t(n)+i(!0),onDone:e})}},a=function(t){return o.setup(this,t),o.create(t)};function s(t=[],e){const n=new r(t,e);return n.constructor=s,n.compile=a,n._call=void 0,n.call=void 0,n}s.prototype=null,t.exports=s},7178:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onResult:e,onDone:n}){return this.callTapsSeries({onError:(e,n,r,i)=>t(n)+i(!0),onResult:(t,e,n)=>{let r="";return r+=`if(${e} !== undefined) {\n`,r+=`${this._args[0]} = ${e};\n`,r+="}\n",r+=n(),r},onDone:()=>e(this._args[0])})}},a=function(t){return o.setup(this,t),o.create(t)};function s(t=[],e){if(t.length<1)throw new Error("Waterfall hooks must have at least one argument");const n=new r(t,e);return n.constructor=s,n.compile=a,n._call=void 0,n.call=void 0,n}s.prototype=null,t.exports=s},6534:(t,e,n)=>{"use strict";const r=n(517).deprecate((()=>{}),"Hook.context is deprecated and will be removed"),i=function(...t){return this.call=this._createCall("sync"),this.call(...t)},o=function(...t){return this.callAsync=this._createCall("async"),this.callAsync(...t)},a=function(...t){return this.promise=this._createCall("promise"),this.promise(...t)};class s{constructor(t=[],e){this._args=t,this.name=e,this.taps=[],this.interceptors=[],this._call=i,this.call=i,this._callAsync=o,this.callAsync=o,this._promise=a,this.promise=a,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}compile(t){throw new Error("Abstract: should be overridden")}_createCall(t){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:t})}_tap(t,e,n){if("string"==typeof e)e={name:e.trim()};else if("object"!=typeof e||null===e)throw new Error("Invalid tap options");if("string"!=typeof e.name||""===e.name)throw new Error("Missing name for tap");void 0!==e.context&&r(),e=Object.assign({type:t,fn:n},e),e=this._runRegisterInterceptors(e),this._insert(e)}tap(t,e){this._tap("sync",t,e)}tapAsync(t,e){this._tap("async",t,e)}tapPromise(t,e){this._tap("promise",t,e)}_runRegisterInterceptors(t){for(const e of this.interceptors)if(e.register){const n=e.register(t);void 0!==n&&(t=n)}return t}withOptions(t){const e=e=>Object.assign({},t,"string"==typeof e?{name:e}:e);return{name:this.name,tap:(t,n)=>this.tap(e(t),n),tapAsync:(t,n)=>this.tapAsync(e(t),n),tapPromise:(t,n)=>this.tapPromise(e(t),n),intercept:t=>this.intercept(t),isUsed:()=>this.isUsed(),withOptions:t=>this.withOptions(e(t))}}isUsed(){return this.taps.length>0||this.interceptors.length>0}intercept(t){if(this._resetCompilation(),this.interceptors.push(Object.assign({},t)),t.register)for(let e=0;e<this.taps.length;e++)this.taps[e]=t.register(this.taps[e])}_resetCompilation(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}_insert(t){let e;this._resetCompilation(),"string"==typeof t.before?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let n=0;"number"==typeof t.stage&&(n=t.stage);let r=this.taps.length;for(;r>0;){r--;const t=this.taps[r];this.taps[r+1]=t;const i=t.stage||0;if(e){if(e.has(t.name)){e.delete(t.name);continue}if(e.size>0)continue}if(!(i>n)){r++;break}}this.taps[r]=t}}Object.setPrototypeOf(s.prototype,null),t.exports=s},2275:t=>{"use strict";t.exports=class{constructor(t){this.config=t,this.options=void 0,this._args=void 0}create(t){let e;switch(this.init(t),this.options.type){case"sync":e=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:t=>`throw ${t};\n`,onResult:t=>`return ${t};\n`,resultReturns:!0,onDone:()=>"",rethrowIfPossible:!0}));break;case"async":e=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:t=>`_callback(${t});\n`,onResult:t=>`_callback(null, ${t});\n`,onDone:()=>"_callback();\n"}));break;case"promise":let t=!1;const n=this.contentWithInterceptors({onError:e=>(t=!0,`_error(${e});\n`),onResult:t=>`_resolve(${t});\n`,onDone:()=>"_resolve();\n"});let r="";r+='"use strict";\n',r+=this.header(),r+="return new Promise((function(_resolve, _reject) {\n",t&&(r+="var _sync = true;\n",r+="function _error(_err) {\n",r+="if(_sync)\n",r+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",r+="else\n",r+="_reject(_err);\n",r+="};\n"),r+=n,t&&(r+="_sync = false;\n"),r+="}));\n",e=new Function(this.args(),r)}return this.deinit(),e}setup(t,e){t._x=e.taps.map((t=>t.fn))}init(t){this.options=t,this._args=t.args.slice()}deinit(){this.options=void 0,this._args=void 0}contentWithInterceptors(t){if(this.options.interceptors.length>0){const e=t.onError,n=t.onResult,r=t.onDone;let i="";for(let t=0;t<this.options.interceptors.length;t++){const e=this.options.interceptors[t];e.call&&(i+=`${this.getInterceptor(t)}.call(${this.args({before:e.context?"_context":void 0})});\n`)}return i+=this.content(Object.assign(t,{onError:e&&(t=>{let n="";for(let e=0;e<this.options.interceptors.length;e++)this.options.interceptors[e].error&&(n+=`${this.getInterceptor(e)}.error(${t});\n`);return n+=e(t),n}),onResult:n&&(t=>{let e="";for(let n=0;n<this.options.interceptors.length;n++)this.options.interceptors[n].result&&(e+=`${this.getInterceptor(n)}.result(${t});\n`);return e+=n(t),e}),onDone:r&&(()=>{let t="";for(let e=0;e<this.options.interceptors.length;e++)this.options.interceptors[e].done&&(t+=`${this.getInterceptor(e)}.done();\n`);return t+=r(),t})})),i}return this.content(t)}header(){let t="";return this.needContext()?t+="var _context = {};\n":t+="var _context;\n",t+="var _x = this._x;\n",this.options.interceptors.length>0&&(t+="var _taps = this.taps;\n",t+="var _interceptors = this.interceptors;\n"),t}needContext(){for(const t of this.options.taps)if(t.context)return!0;return!1}callTap(t,{onError:e,onResult:n,onDone:r,rethrowIfPossible:i}){let o="",a=!1;for(let e=0;e<this.options.interceptors.length;e++){const n=this.options.interceptors[e];n.tap&&(a||(o+=`var _tap${t} = ${this.getTap(t)};\n`,a=!0),o+=`${this.getInterceptor(e)}.tap(${n.context?"_context, ":""}_tap${t});\n`)}o+=`var _fn${t} = ${this.getTapFn(t)};\n`;const s=this.options.taps[t];switch(s.type){case"sync":i||(o+=`var _hasError${t} = false;\n`,o+="try {\n"),o+=n?`var _result${t} = _fn${t}(${this.args({before:s.context?"_context":void 0})});\n`:`_fn${t}(${this.args({before:s.context?"_context":void 0})});\n`,i||(o+="} catch(_err) {\n",o+=`_hasError${t} = true;\n`,o+=e("_err"),o+="}\n",o+=`if(!_hasError${t}) {\n`),n&&(o+=n(`_result${t}`)),r&&(o+=r()),i||(o+="}\n");break;case"async":let a="";a+=n?`(function(_err${t}, _result${t}) {\n`:`(function(_err${t}) {\n`,a+=`if(_err${t}) {\n`,a+=e(`_err${t}`),a+="} else {\n",n&&(a+=n(`_result${t}`)),r&&(a+=r()),a+="}\n",a+="})",o+=`_fn${t}(${this.args({before:s.context?"_context":void 0,after:a})});\n`;break;case"promise":o+=`var _hasResult${t} = false;\n`,o+=`var _promise${t} = _fn${t}(${this.args({before:s.context?"_context":void 0})});\n`,o+=`if (!_promise${t} || !_promise${t}.then)\n`,o+=`  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise${t} + ')');\n`,o+=`_promise${t}.then((function(_result${t}) {\n`,o+=`_hasResult${t} = true;\n`,n&&(o+=n(`_result${t}`)),r&&(o+=r()),o+=`}), function(_err${t}) {\n`,o+=`if(_hasResult${t}) throw _err${t};\n`,o+=e(`_err${t}`),o+="});\n"}return o}callTapsSeries({onError:t,onResult:e,resultReturns:n,onDone:r,doneReturns:i,rethrowIfPossible:o}){if(0===this.options.taps.length)return r();const a=this.options.taps.findIndex((t=>"sync"!==t.type)),s=n||i;let u="",c=r,h=0;for(let n=this.options.taps.length-1;n>=0;n--){const i=n;c!==r&&("sync"!==this.options.taps[i].type||h++>20)&&(h=0,u+=`function _next${i}() {\n`,u+=c(),u+="}\n",c=()=>`${s?"return ":""}_next${i}();\n`);const l=c,p=t=>t?"":r(),f=this.callTap(i,{onError:e=>t(i,e,l,p),onResult:e&&(t=>e(i,t,l,p)),onDone:!e&&l,rethrowIfPossible:o&&(a<0||i<a)});c=()=>f}return u+=c(),u}callTapsLooping({onError:t,onDone:e,rethrowIfPossible:n}){if(0===this.options.taps.length)return e();const r=this.options.taps.every((t=>"sync"===t.type));let i="";r||(i+="var _looper = (function() {\n",i+="var _loopAsync = false;\n"),i+="var _loop;\n",i+="do {\n",i+="_loop = false;\n";for(let t=0;t<this.options.interceptors.length;t++){const e=this.options.interceptors[t];e.loop&&(i+=`${this.getInterceptor(t)}.loop(${this.args({before:e.context?"_context":void 0})});\n`)}return i+=this.callTapsSeries({onError:t,onResult:(t,e,n,i)=>{let o="";return o+=`if(${e} !== undefined) {\n`,o+="_loop = true;\n",r||(o+="if(_loopAsync) _looper();\n"),o+=i(!0),o+="} else {\n",o+=n(),o+="}\n",o},onDone:e&&(()=>{let t="";return t+="if(!_loop) {\n",t+=e(),t+="}\n",t}),rethrowIfPossible:n&&r}),i+="} while(_loop);\n",r||(i+="_loopAsync = true;\n",i+="});\n",i+="_looper();\n"),i}callTapsParallel({onError:t,onResult:e,onDone:n,rethrowIfPossible:r,onTap:i=((t,e)=>e())}){if(this.options.taps.length<=1)return this.callTapsSeries({onError:t,onResult:e,onDone:n,rethrowIfPossible:r});let o="";o+="do {\n",o+=`var _counter = ${this.options.taps.length};\n`,n&&(o+="var _done = (function() {\n",o+=n(),o+="});\n");for(let a=0;a<this.options.taps.length;a++){const s=()=>n?"if(--_counter === 0) _done();\n":"--_counter;",u=t=>t||!n?"_counter = 0;\n":"_counter = 0;\n_done();\n";o+="if(_counter <= 0) break;\n",o+=i(a,(()=>this.callTap(a,{onError:e=>{let n="";return n+="if(_counter > 0) {\n",n+=t(a,e,s,u),n+="}\n",n},onResult:e&&(t=>{let n="";return n+="if(_counter > 0) {\n",n+=e(a,t,s,u),n+="}\n",n}),onDone:!e&&(()=>s()),rethrowIfPossible:r})),s,u)}return o+="} while(false);\n",o}args({before:t,after:e}={}){let n=this._args;return t&&(n=[t].concat(n)),e&&(n=n.concat(e)),0===n.length?"":n.join(", ")}getTapFn(t){return`_x[${t}]`}getTap(t){return`_taps[${t}]`}getInterceptor(t){return`_interceptors[${t}]`}}},2459:(t,e,n)=>{"use strict";const r=n(517),i=(t,e)=>e;class o{constructor(t,e){this._map=new Map,this.name=e,this._factory=t,this._interceptors=[]}get(t){return this._map.get(t)}for(t){const e=this.get(t);if(void 0!==e)return e;let n=this._factory(t);const r=this._interceptors;for(let e=0;e<r.length;e++)n=r[e].factory(t,n);return this._map.set(t,n),n}intercept(t){this._interceptors.push(Object.assign({factory:i},t))}}o.prototype.tap=r.deprecate((function(t,e,n){return this.for(t).tap(e,n)}),"HookMap#tap(key,) is deprecated. Use HookMap#for(key).tap() instead."),o.prototype.tapAsync=r.deprecate((function(t,e,n){return this.for(t).tapAsync(e,n)}),"HookMap#tapAsync(key,) is deprecated. Use HookMap#for(key).tapAsync() instead."),o.prototype.tapPromise=r.deprecate((function(t,e,n){return this.for(t).tapPromise(e,n)}),"HookMap#tapPromise(key,) is deprecated. Use HookMap#for(key).tapPromise() instead."),t.exports=o},942:(t,e,n)=>{"use strict";n(6534);class r{constructor(t,e){this.hooks=t,this.name=e}tap(t,e){for(const n of this.hooks)n.tap(t,e)}tapAsync(t,e){for(const n of this.hooks)n.tapAsync(t,e)}tapPromise(t,e){for(const n of this.hooks)n.tapPromise(t,e)}isUsed(){for(const t of this.hooks)if(t.isUsed())return!0;return!1}intercept(t){for(const e of this.hooks)e.intercept(t)}withOptions(t){return new r(this.hooks.map((e=>e.withOptions(t))),this.name)}}t.exports=r},3922:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onResult:e,resultReturns:n,onDone:r,rethrowIfPossible:i}){return this.callTapsSeries({onError:(e,n)=>t(n),onResult:(t,n,r)=>`if(${n} !== undefined) {\n${e(n)};\n} else {\n${r()}}\n`,resultReturns:n,onDone:r,rethrowIfPossible:i})}},a=()=>{throw new Error("tapAsync is not supported on a SyncBailHook")},s=()=>{throw new Error("tapPromise is not supported on a SyncBailHook")},u=function(t){return o.setup(this,t),o.create(t)};function c(t=[],e){const n=new r(t,e);return n.constructor=c,n.tapAsync=a,n.tapPromise=s,n.compile=u,n}c.prototype=null,t.exports=c},537:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onDone:e,rethrowIfPossible:n}){return this.callTapsSeries({onError:(e,n)=>t(n),onDone:e,rethrowIfPossible:n})}},a=()=>{throw new Error("tapAsync is not supported on a SyncHook")},s=()=>{throw new Error("tapPromise is not supported on a SyncHook")},u=function(t){return o.setup(this,t),o.create(t)};function c(t=[],e){const n=new r(t,e);return n.constructor=c,n.tapAsync=a,n.tapPromise=s,n.compile=u,n}c.prototype=null,t.exports=c},3074:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onDone:e,rethrowIfPossible:n}){return this.callTapsLooping({onError:(e,n)=>t(n),onDone:e,rethrowIfPossible:n})}},a=()=>{throw new Error("tapAsync is not supported on a SyncLoopHook")},s=()=>{throw new Error("tapPromise is not supported on a SyncLoopHook")},u=function(t){return o.setup(this,t),o.create(t)};function c(t=[],e){const n=new r(t,e);return n.constructor=c,n.tapAsync=a,n.tapPromise=s,n.compile=u,n}c.prototype=null,t.exports=c},2076:(t,e,n)=>{"use strict";const r=n(6534),i=n(2275),o=new class extends i{content({onError:t,onResult:e,resultReturns:n,rethrowIfPossible:r}){return this.callTapsSeries({onError:(e,n)=>t(n),onResult:(t,e,n)=>{let r="";return r+=`if(${e} !== undefined) {\n`,r+=`${this._args[0]} = ${e};\n`,r+="}\n",r+=n(),r},onDone:()=>e(this._args[0]),doneReturns:n,rethrowIfPossible:r})}},a=()=>{throw new Error("tapAsync is not supported on a SyncWaterfallHook")},s=()=>{throw new Error("tapPromise is not supported on a SyncWaterfallHook")},u=function(t){return o.setup(this,t),o.create(t)};function c(t=[],e){if(t.length<1)throw new Error("Waterfall hooks must have at least one argument");const n=new r(t,e);return n.constructor=c,n.tapAsync=a,n.tapPromise=s,n.compile=u,n}c.prototype=null,t.exports=c},9991:(t,e,n)=>{"use strict";e.SyncHook=n(537),n(3922),e.SyncWaterfallHook=n(2076),n(3074),n(6714),n(7247),e.AsyncSeriesHook=n(1617),n(1293),n(996),e.AsyncSeriesWaterfallHook=n(7178),n(2459),n(942)},517:(t,e)=>{"use strict";e.deprecate=(t,e)=>{let n=!0;return function(){return n&&(console.warn("DeprecationWarning: "+e),n=!1),t.apply(this,arguments)}}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t={};n.r(t),n.d(t,{add:()=>Nt,angle:()=>ie,bezier:()=>Kt,ceil:()=>kt,clone:()=>_t,copy:()=>At,create:()=>xt,cross:()=>Yt,dist:()=>fe,distance:()=>Gt,div:()=>pe,divide:()=>It,dot:()=>qt,equals:()=>ue,exactEquals:()=>se,floor:()=>Rt,forEach:()=>ge,fromValues:()=>Mt,hermite:()=>$t,inverse:()=>zt,len:()=>ye,length:()=>Pt,lerp:()=>Xt,max:()=>Bt,min:()=>Dt,mul:()=>le,multiply:()=>Ot,negate:()=>Wt,normalize:()=>Ht,random:()=>Jt,rotateX:()=>ee,rotateY:()=>ne,rotateZ:()=>re,round:()=>Lt,scale:()=>jt,scaleAndAdd:()=>Ft,set:()=>St,sqrDist:()=>de,sqrLen:()=>ve,squaredDistance:()=>Ut,squaredLength:()=>Vt,str:()=>ae,sub:()=>he,subtract:()=>Ct,transformMat3:()=>Qt,transformMat4:()=>Zt,transformQuat:()=>te,zero:()=>oe});var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},e(t,n)};function r(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var i=function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)};function o(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function a(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function s(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function h(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function p(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}Object.create,Object.create;var f,d,y,v=n(6700);function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),t}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function P(t,e){return e.lifecycle===d.Lifecycle.singleton?function(t){return t.inSingletonScope()}(t):function(t){return t.inTransientScope()}(t)}function M(t,e){t.whenTargetNamed(N(e))}function A(t,e){return e.container.bind(C(t))}function S(t,e){var n=e.container.parent,r=n&&n.isBound(C(t));return e.container.isBound(C(t))&&!r?e.container.rebind(C(t)):e.container.bind(C(t))}function N(t){return y.isDefinedToken(t)?t.symbol:t}function C(t){return y.isDefinedToken(t)?t.symbol:t}!function(t){!function(e){var r="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(t);function o(t,e){return function(n,r){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:r}),e&&e(n,r)}}void 0===r.Reflect?r.Reflect=t:i=o(r.Reflect,i),function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,u={create:o?function(){return D(Object.create(null))}:a?function(){return D({__proto__:null})}:function(){return D({})},has:s?function(t,n){return e.call(t,n)}:function(t,e){return e in t},get:s?function(t,n){return e.call(t,n)?t[n]:void 0}:function(t,e){return t[e]}},c=Object.getPrototypeOf(Function),h="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[i]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,r)},e.prototype.values=function(){return new n(this._keys,this._values,o)},e.prototype.entries=function(){return new n(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[i]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function r(t,e){return t}function o(t,e){return e}function a(t,e){return[t,e]}}():Map,p=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new l}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[i]=function(){return this.keys()},t}():Set,f=new(h||"function"!=typeof WeakMap?function(){var t=u.create(),n=r();return function(){function t(){this._key=r()}return t.prototype.has=function(t){var e=i(t,!1);return void 0!==e&&u.has(e,this._key)},t.prototype.get=function(t){var e=i(t,!1);return void 0!==e?u.get(e,this._key):void 0},t.prototype.set=function(t,e){return i(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=i(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=r()},t}();function r(){var e;do{e="@@WeakMap@@"+a()}while(u.has(t,e));return t[e]=!0,e}function i(t,r){if(!e.call(t,n)){if(!r)return;Object.defineProperty(t,n,{value:u.create()})}return t[n]}function o(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function a(){var t,e=(t=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):o(new Uint8Array(t),t):o(new Array(t),t));e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",r=0;r<16;++r){var i=e[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}():WeakMap);function d(t,e,n){var r=f.get(t);if(x(r)){if(!n)return;r=new l,f.set(t,r)}var i=r.get(e);if(x(i)){if(!n)return;i=new l,r.set(e,i)}return i}function y(t,e,n){if(v(t,e,n))return!0;var r=R(e);return!_(r)&&y(t,r,n)}function v(t,e,n){var r=d(e,n,!1);return!x(r)&&!!r.has(t)}function g(t,e,n){if(v(t,e,n))return m(t,e,n);var r=R(e);return _(r)?void 0:g(t,r,n)}function m(t,e,n){var r=d(e,n,!1);if(!x(r))return r.get(t)}function b(t,e,n,r){d(n,r,!0).set(t,e)}function T(t,e){var n=E(t,e),r=R(t);if(null===r)return n;var i=T(r,e);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new p,a=[],s=0,u=n;s<u.length;s++){var c=u[s];o.has(c)||(o.add(c),a.push(c))}for(var h=0,l=i;h<l.length;h++)c=l[h],o.has(c)||(o.add(c),a.push(c));return a}function E(t,e){var n=[],r=d(t,e,!1);if(x(r))return n;for(var o=function(t){var e=O(t,i);if(!N(e))throw new TypeError;var n=e.call(t);if(!P(n))throw new TypeError;return n}(r.keys()),a=0;;){var s=I(o);if(!s)return n.length=a,n;var u=s.value;try{n[a]=u}catch(t){try{k(o)}finally{throw t}}a++}}function w(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function x(t){return void 0===t}function _(t){return null===t}function P(t){return"object"==typeof t?null!==t:"function"==typeof t}function M(t,e){switch(w(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",i=O(t,r);if(void 0!==i){var o=i.call(t,n);if(P(o))throw new TypeError;return o}return function(t,e){if("string"===e){var n=t.toString;if(N(n)&&!P(i=n.call(t)))return i;if(N(r=t.valueOf)&&!P(i=r.call(t)))return i}else{var r;if(N(r=t.valueOf)&&!P(i=r.call(t)))return i;var i,o=t.toString;if(N(o)&&!P(i=o.call(t)))return i}throw new TypeError}(t,"default"===n?"number":n)}function A(t){var e=M(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function S(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function N(t){return"function"==typeof t}function C(t){return"function"==typeof t}function O(t,e){var n=t[e];if(null!=n){if(!N(n))throw new TypeError;return n}}function I(t){var e=t.next();return!e.done&&e}function k(t){var e=t.return;e&&e.call(t)}function R(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===c)return e;if(e!==c)return e;var n=t.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return e;var i=r.constructor;return"function"!=typeof i||i===t?e:i}function D(t){return t.__=void 0,delete t.__,t}t("decorate",(function(t,e,n,r){if(x(n)){if(!S(t))throw new TypeError;if(!C(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var r=(0,t[n])(e);if(!x(r)&&!_(r)){if(!C(r))throw new TypeError;e=r}}return e}(t,e)}if(!S(t))throw new TypeError;if(!P(e))throw new TypeError;if(!P(r)&&!x(r)&&!_(r))throw new TypeError;return _(r)&&(r=void 0),function(t,e,n,r){for(var i=t.length-1;i>=0;--i){var o=(0,t[i])(e,n,r);if(!x(o)&&!_(o)){if(!P(o))throw new TypeError;r=o}}return r}(t,e,n=A(n),r)})),t("metadata",(function(t,e){return function(n,r){if(!P(n))throw new TypeError;if(!x(r)&&!function(t){switch(w(t)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;b(t,e,n,r)}})),t("defineMetadata",(function(t,e,n,r){if(!P(n))throw new TypeError;return x(r)||(r=A(r)),b(t,e,n,r)})),t("hasMetadata",(function(t,e,n){if(!P(e))throw new TypeError;return x(n)||(n=A(n)),y(t,e,n)})),t("hasOwnMetadata",(function(t,e,n){if(!P(e))throw new TypeError;return x(n)||(n=A(n)),v(t,e,n)})),t("getMetadata",(function(t,e,n){if(!P(e))throw new TypeError;return x(n)||(n=A(n)),g(t,e,n)})),t("getOwnMetadata",(function(t,e,n){if(!P(e))throw new TypeError;return x(n)||(n=A(n)),m(t,e,n)})),t("getMetadataKeys",(function(t,e){if(!P(t))throw new TypeError;return x(e)||(e=A(e)),T(t,e)})),t("getOwnMetadataKeys",(function(t,e){if(!P(t))throw new TypeError;return x(e)||(e=A(e)),E(t,e)})),t("deleteMetadata",(function(t,e,n){if(!P(e))throw new TypeError;x(n)||(n=A(n));var r=d(e,n,!1);if(x(r))return!1;if(!r.delete(t))return!1;if(r.size>0)return!0;var i=f.get(e);return i.delete(n),i.size>0||f.delete(e),!0}))}(i)}()}(f||(f={})),function(t){var e;t.defineToken=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{multiple:!0};return new t.DefinedToken(e,n)},t.DefinedToken=function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};T(this,t),this.prototype={},this.name=void 0,this.multiple=void 0,this.symbol=void 0;var r=n.multiple,i=void 0!==r&&r;this.name=e,this.symbol=Symbol(this.name),this.multiple=i},t.isModule=function(t){return!!t&&"object"===b(t)&&"id"in t&&"registry"in t},function(t){t.singleton="singleton",t.transient="transient"}(e=t.Lifecycle||(t.Lifecycle={})),t.ClassOptionSymbol=Symbol("SyringeClassOptionSymbol"),t.DefaultOption={lifecycle:e.transient}}(d||(d={})),function(t){t.maybeArrayToArray=function(t){return t instanceof Array?t:void 0!==t?[t]:[]},t.isClass=function(t){return!(!t||"function"!=typeof t||!("prototype"in t))},t.isDefinedToken=function(t){return!!(t&&"object"===b(t)&&"symbol"in t&&"multiple"in t)},t.isInjectOption=function(t){return!(!t||"object"!==b(t)||!("token"in t))},t.isNamedToken=function(t){return!!(t&&"object"===b(t)&&"token"in t&&"named"in t)},t.isMultipleEnabled=function(e){return t.isDefinedToken(e)&&e.multiple}}(y||(y={}));var O=new v.W2;function I(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,v.b2)();return function(n){Reflect.defineMetadata(d.ClassOptionSymbol,m(m({},t),{},{target:n}),n),e(n)}}function k(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return I(m(m({},t),{},{lifecycle:d.Lifecycle.singleton}))}function R(t){return(0,v.f3)(C(t))}var D=Symbol("SyringeOptionSymbol"),B=function(){function t(e,n,r){T(this,t),this.token=void 0,this.rawToken=void 0,this.named=void 0,this.generalToken=void 0,this.option=void 0,this.context=void 0,this.mutiple=void 0,this.context=e,this.token=n,this.option=r,this.rawToken=y.isNamedToken(n)?n.token:n,this.named=y.isNamedToken(n)?n.named:void 0,this.mutiple=!!this.named||y.isMultipleEnabled(this.rawToken),this.generalToken=this.rawToken}return w(t,[{key:"resolve",value:function(){var t,e=this,n=this.context;(t=n)&&"object"===b(t)&&"container"in t&&"inversify"in t&&(this.mutiple?this.resolveMutilple(n):(this.resolveMono(n),!this.named&&this.option.contrib.length>0&&this.option.contrib.forEach((function(t){y.isMultipleEnabled(t)?A(t,n).toService(e.generalToken):S(t,n).toService(e.generalToken)}))))}},{key:"resolveMono",value:function(t){var e=this;if("useValue"in this.option)return S(this.generalToken,t).toConstantValue(this.option.useValue);if(this.option.useDynamic.length>0){var n=this.option.useDynamic[this.option.useDynamic.length-1];return P(S(this.generalToken,t).toDynamicValue((function(){return n({container:e.context})})),this.option)}if(this.option.useFactory.length>0){var r=this.option.useFactory[this.option.useFactory.length-1];return S(this.generalToken,t).toFactory((function(){return r({container:e.context})}))}if(this.option.useClass.length>0){var i=this.option.useClass[this.option.useClass.length-1];return P(S(this.generalToken,t).to(i),this.option)}}},{key:"resolveMutilple",value:function(t){var e=this,n=this.option.useClass.map((function(n){return P(A(e.generalToken,t).to(n),e.option)})),r=this.option.useDynamic.map((function(n){return P(A(e.generalToken,t).toDynamicValue((function(){return n({container:e.context})})),e.option)})),i=this.option.useFactory.map((function(n){return A(e.generalToken,t).toFactory((function(){return n({container:e.context})}))})),o="useValue"in this.option?A(this.generalToken,t).toConstantValue(this.option.useValue):void 0;this.named&&(n.forEach((function(t){return e.named&&M(t,e.named)})),r.forEach((function(t){return e.named&&M(t,e.named)})),i.forEach((function(t){return e.named&&M(t,e.named)})),o&&M(o,this.named))}}],[{key:"resolveTarget",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{try{var i=Reflect.getMetadata(D,n);i&&t.resolveOption(e,i)}catch(t){}if(y.isClass(n))if(r.useClass){var o=y.maybeArrayToArray(r.useClass);o.unshift(n),r.useClass=o}else r.useClass=[n];var a;try{a=Reflect.getMetadata(d.ClassOptionSymbol,n)}catch(t){}if((a=m(m({},a||{}),r)).token){var s=y.maybeArrayToArray(a.token);s.unshift(n),a.token=s}else a.token=[n];t.resolveOption(e,a)}catch(t){}}},{key:"resolveOption",value:function(e,n){var r=function(t){var e=y.maybeArrayToArray(t.token),n=y.maybeArrayToArray(t.useClass),r=y.maybeArrayToArray(t.useDynamic),i=y.maybeArrayToArray(t.useFactory),o=y.maybeArrayToArray(t.contrib),a=t.lifecycle||d.Lifecycle.transient,s={token:e,useClass:n,lifecycle:o.length>0?d.Lifecycle.singleton:a,contrib:o,useDynamic:r,useFactory:i};return"useValue"in t&&(s.useValue=t.useValue),s}(m(m({},t.globalConfig),n));(0!==r.useClass.length||0!==r.useDynamic.length||0!==r.useFactory.length||"useValue"in r)&&r.token.forEach((function(n){new t(e,n,m({},r)).resolve()}))}}]),t}();B.globalConfig=d.DefaultOption;var L=new(function(){function t(e){T(this,t),this.loadedModules=[],this.container=void 0,this.inversify=!0,this.parent=void 0,this.container=e||new v.W2}return w(t,[{key:"load",value:function(t,e){!e&&this.loadedModules.includes(t.id)||(t.registry(this.register.bind(this),this.resolveContext()),this.loadedModules.push(t.id))}},{key:"remove",value:function(t){return this.container.unbind(C(t))}},{key:"get",value:function(t){return this.container.get(C(t))}},{key:"getNamed",value:function(t,e){return this.container.getNamed(C(t),N(e))}},{key:"getAll",value:function(t){return this.container.getAll(C(t))}},{key:"getAllNamed",value:function(t,e){return this.container.getAllNamed(C(t),N(e))}},{key:"isBound",value:function(t){return this.container.isBound(C(t))}},{key:"isBoundNamed",value:function(t,e){return this.container.isBoundNamed(C(t),N(e))}},{key:"createChild",value:function(){var e=new t(this.container.createChild());return e.parent=this,e}},{key:"register",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};y.isInjectOption(t)?B.resolveOption(this,t):B.resolveTarget(this,t,e)}},{key:"resolveContext",value:function(){return{container:this}}}],[{key:"config",value:function(t){B.globalConfig=t}}]),t}())(O),j=(L.register.bind(L),d.defineToken("ContributionProvider")),F=function(){function t(e,n,r){T(this,t),this.option={recursive:!1,cache:!0},this.services=void 0,this.serviceIdentifier=void 0,this.container=void 0,this.container=n,this.serviceIdentifier=e,r&&(this.option=m(m({},this.option),r))}return w(t,[{key:"setServices",value:function(t){for(var e=[],n=this.container;n;){if(n.isBound(this.serviceIdentifier)){var r=n.getAll(this.serviceIdentifier);e.push.apply(e,function(t){if(Array.isArray(t))return _(t)}(i=r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}n=t?n.parent:void 0}var i;return e}},{key:"getContributions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=m(m({},this.option),t),n=e.cache,r=e.recursive;return n&&void 0!==this.services||(this.services=this.setServices(!!r)),this.services}}]),t}();function G(t,e){return{token:{token:j,named:t},useDynamic:function(n){return new F(t,n.container,e)},lifecycle:d.Lifecycle.singleton}}function U(t,e,n){t({token:{token:j,named:e},useDynamic:function(t){return new F(e,t.container,n)},lifecycle:d.Lifecycle.singleton})}var V=function(){function t(e){T(this,t),this.id=void 0,this.baseRegistry=void 0,this.optionCollection=void 0,t.moduleId+=1,this.id=t.moduleId,this.baseRegistry=e}return w(t,[{key:"registry",get:function(){var t=this;return function(e,n){t.baseRegistry&&t.baseRegistry(e,n),t.optionCollection&&t.optionCollection.forEach((function(t){return e(t)}))}}},{key:"options",get:function(){return this.optionCollection||(this.optionCollection=[]),this.optionCollection}},{key:"register",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.options.push(e)})),this}},{key:"contribution",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach((function(e){return t.options.push(G(e))})),this}}]),t}();function W(t){return new V(t)}V.moduleId=0;var z,H=function(t){return function(e,n,r){var i;(i=t,(0,v.t6)(N(i)))(e,n,r),R(j)(e,n,r)}};!function(t){t.Provider=j,t.register=U}(z||(z={}));var q=n(6729),Y=function(){function t(){this.pool={}}return t.prototype.getByEntity=function(t){return this.pool[t]},t.prototype.add=function(t,e){this.pool[t]=e},t.prototype.remove=function(t){delete this.pool[t]},a([k()],t)}(),X={}.toString;const $=function(t,e){return X.call(t)==="[object "+e+"]"},K=function(t){return $(t,"Function")},J=function(t){return Array.isArray?Array.isArray(t):$(t,"Array")},Z=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e},Q=function(t,e){if(t)if(J(t))for(var n=0,r=t.length;n<r&&!1!==e(t[n],n);n++);else if(Z(t))for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break};Object.keys;const tt=function(t){if(J(t))return t.reduce((function(t,e){return Math.max(t,e)}),t[0])},et=function(t){if(J(t))return t.reduce((function(t,e){return Math.min(t,e)}),t[0])};var nt=Array.prototype;nt.splice,nt.indexOf,Array.prototype.splice;const rt=function(t){return $(t,"String")};Object.prototype.hasOwnProperty;const it=function(t,e,n){return t<e?e:t>n?n:t},ot=function(t){return $(t,"Number")};Number.isInteger&&Number.isInteger;Math.PI,parseInt;var at=Math.PI/180;const st=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return Q(t,(function(n,r){K(t)&&"prototype"===r||e.push(n)})),e},ut=function(t){return $(t,"Boolean")},ct=function(t){return null==t};Object.prototype;const ht=function(t){return void 0===t};Object.prototype.hasOwnProperty;const lt=function(t){return"object"==typeof t&&null!==t},pt=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)};var ft=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(rt(t)||rt(e))return!1;if(pt(t)||pt(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=ft(t[r],e[r]));r++);return n}if(lt(t)||lt(e)){var i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(n=!0,r=0;r<i.length&&(n=ft(t[i[r]],e[i[r]]));r++);return n}return!1};const dt=ft;var yt;Object.prototype.hasOwnProperty,function(t,e){if(!K(t))throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var s=t.apply(this,r);return a.set(o,s),s};n.cache=new Map}((function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,o=e.fontStyle,a=e.fontVariant;return yt||(yt=document.createElement("canvas").getContext("2d")),yt.font=[o,a,i,n+"px",r].join(" "),yt.measureText(rt(t)?t:"").width}),(function(t,e){return void 0===e&&(e={}),function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}([t],st(e)).join("")})),function(){function t(){this.map={}}t.prototype.has=function(t){return void 0!==this.map[t]},t.prototype.get=function(t,e){var n=this.map[t];return void 0===n?e:n},t.prototype.set=function(t,e){this.map[t]=e},t.prototype.clear=function(){this.map={}},t.prototype.delete=function(t){delete this.map[t]},t.prototype.size=function(){return Object.keys(this.map).length}}();var vt=1e-6,gt="undefined"!=typeof Float32Array?Float32Array:Array,mt=Math.random;function bt(){var t=new gt(9);return gt!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Tt(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],p=n[0],f=n[1],d=n[2],y=n[3],v=n[4],g=n[5],m=n[6],b=n[7],T=n[8];return t[0]=p*r+f*a+d*c,t[1]=p*i+f*s+d*h,t[2]=p*o+f*u+d*l,t[3]=y*r+v*a+g*c,t[4]=y*i+v*s+g*h,t[5]=y*o+v*u+g*l,t[6]=m*r+b*a+T*c,t[7]=m*i+b*s+T*h,t[8]=m*o+b*u+T*l,t}function Et(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function wt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function xt(){var t=new gt(3);return gt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function _t(t){var e=new gt(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Pt(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Mt(t,e,n){var r=new gt(3);return r[0]=t,r[1]=e,r[2]=n,r}function At(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function St(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Nt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ct(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ot(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function It(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function kt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Rt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Dt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Bt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Lt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function jt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Ft(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Gt(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,r,i)}function Ut(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function Vt(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Wt(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function zt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Ht(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function qt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Yt(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function Xt(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function $t(t,e,n,r,i,o){var a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),h=a*(3-2*o);return t[0]=e[0]*s+n[0]*u+r[0]*c+i[0]*h,t[1]=e[1]*s+n[1]*u+r[1]*c+i[1]*h,t[2]=e[2]*s+n[2]*u+r[2]*c+i[2]*h,t}function Kt(t,e,n,r,i,o){var a=1-o,s=a*a,u=o*o,c=s*a,h=3*o*s,l=3*u*a,p=u*o;return t[0]=e[0]*c+n[0]*h+r[0]*l+i[0]*p,t[1]=e[1]*c+n[1]*h+r[1]*l+i[1]*p,t[2]=e[2]*c+n[2]*h+r[2]*l+i[2]*p,t}function Jt(t,e){e=e||1;var n=2*mt()*Math.PI,r=2*mt()-1,i=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=r*e,t}function Zt(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function Qt(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function te(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],c=e[2],h=i*c-o*u,l=o*s-r*c,p=r*u-i*s,f=i*p-o*l,d=o*h-r*p,y=r*l-i*h,v=2*a;return h*=v,l*=v,p*=v,f*=2,d*=2,y*=2,t[0]=s+h+f,t[1]=u+l+d,t[2]=c+p+y,t}function ee(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function ne(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function re(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function ie(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+a*a+s*s),c=u&&qt(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}function oe(t){return t[0]=0,t[1]=0,t[2]=0,t}function ae(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function se(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function ue(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2];return Math.abs(n-o)<=vt*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-a)<=vt*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=vt*Math.max(1,Math.abs(i),Math.abs(s))}Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ce,he=Ct,le=Ot,pe=It,fe=Gt,de=Ut,ye=Pt,ve=Vt,ge=(ce=xt(),function(t,e,n,r,i,o){var a,s;for(e||(e=3),n||(n=0),s=r?Math.min(r*e+n,t.length):t.length,a=n;a<s;a+=e)ce[0]=t[a],ce[1]=t[a+1],ce[2]=t[a+2],i(ce,ce,o),t[a]=ce[0],t[a+1]=ce[1],t[a+2]=ce[2];return t});function me(){var t=new gt(4);return gt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function be(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function Te(){var t=new gt(4);return gt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ee(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function we(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+a*s+i*c-o*u,t[1]=i*h+a*u+o*s-r*c,t[2]=o*h+a*c+r*u-i*s,t[3]=a*h-r*s-i*u-o*c,t}function xe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function _e(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var o=Math.sin(e),a=Math.cos(e),s=Math.sin(n),u=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return t[0]=o*u*h-a*s*c,t[1]=a*s*h+o*u*c,t[2]=a*u*c-o*s*h,t[3]=a*u*h+o*s*c,t}me();var Pe=function(t,e,n,r){var i=new gt(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i},Me=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Ae=we;function Se(){var t=new gt(16);return gt!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Ne(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ce(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Oe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],l=e[9],p=e[10],f=e[11],d=e[12],y=e[13],v=e[14],g=e[15],m=n*s-r*a,b=n*u-i*a,T=n*c-o*a,E=r*u-i*s,w=r*c-o*s,x=i*c-o*u,_=h*y-l*d,P=h*v-p*d,M=h*g-f*d,A=l*v-p*y,S=l*g-f*y,N=p*g-f*v,C=m*N-b*S+T*A+E*M-w*P+x*_;return C?(C=1/C,t[0]=(s*N-u*S+c*A)*C,t[1]=(i*S-r*N-o*A)*C,t[2]=(y*x-v*w+g*E)*C,t[3]=(p*w-l*x-f*E)*C,t[4]=(u*M-a*N-c*P)*C,t[5]=(n*N-i*M+o*P)*C,t[6]=(v*T-d*x-g*b)*C,t[7]=(h*x-p*T+f*b)*C,t[8]=(a*S-s*M+c*_)*C,t[9]=(r*M-n*S-o*_)*C,t[10]=(d*w-y*T+g*m)*C,t[11]=(l*T-h*w-f*m)*C,t[12]=(s*P-a*A-u*_)*C,t[13]=(n*A-r*P+i*_)*C,t[14]=(y*b-d*E-v*m)*C,t[15]=(h*E-l*b+p*m)*C,t):null}function Ie(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],p=e[9],f=e[10],d=e[11],y=e[12],v=e[13],g=e[14],m=e[15],b=n[0],T=n[1],E=n[2],w=n[3];return t[0]=b*r+T*s+E*l+w*y,t[1]=b*i+T*u+E*p+w*v,t[2]=b*o+T*c+E*f+w*g,t[3]=b*a+T*h+E*d+w*m,b=n[4],T=n[5],E=n[6],w=n[7],t[4]=b*r+T*s+E*l+w*y,t[5]=b*i+T*u+E*p+w*v,t[6]=b*o+T*c+E*f+w*g,t[7]=b*a+T*h+E*d+w*m,b=n[8],T=n[9],E=n[10],w=n[11],t[8]=b*r+T*s+E*l+w*y,t[9]=b*i+T*u+E*p+w*v,t[10]=b*o+T*c+E*f+w*g,t[11]=b*a+T*h+E*d+w*m,b=n[12],T=n[13],E=n[14],w=n[15],t[12]=b*r+T*s+E*l+w*y,t[13]=b*i+T*u+E*p+w*v,t[14]=b*o+T*c+E*f+w*g,t[15]=b*a+T*h+E*d+w*m,t}function ke(t,e,n){var r,i,o,a,s,u,c,h,l,p,f,d,y=n[0],v=n[1],g=n[2];return e===t?(t[12]=e[0]*y+e[4]*v+e[8]*g+e[12],t[13]=e[1]*y+e[5]*v+e[9]*g+e[13],t[14]=e[2]*y+e[6]*v+e[10]*g+e[14],t[15]=e[3]*y+e[7]*v+e[11]*g+e[15]):(r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],c=e[6],h=e[7],l=e[8],p=e[9],f=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=c,t[7]=h,t[8]=l,t[9]=p,t[10]=f,t[11]=d,t[12]=r*y+s*v+l*g+e[12],t[13]=i*y+u*v+p*g+e[13],t[14]=o*y+c*v+f*g+e[14],t[15]=a*y+h*v+d*g+e[15]),t}function Re(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function De(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Be(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,c,h),t}function Le(t,e){var n=new gt(3);Be(n,e);var r=1/n[0],i=1/n[1],o=1/n[2],a=e[0]*r,s=e[1]*i,u=e[2]*o,c=e[4]*r,h=e[5]*i,l=e[6]*o,p=e[8]*r,f=e[9]*i,d=e[10]*o,y=a+h+d,v=0;return y>0?(v=2*Math.sqrt(y+1),t[3]=.25*v,t[0]=(l-f)/v,t[1]=(p-u)/v,t[2]=(s-c)/v):a>h&&a>d?(v=2*Math.sqrt(1+a-h-d),t[3]=(l-f)/v,t[0]=.25*v,t[1]=(s+c)/v,t[2]=(p+u)/v):h>d?(v=2*Math.sqrt(1+h-a-d),t[3]=(p-u)/v,t[0]=(s+c)/v,t[1]=.25*v,t[2]=(l+f)/v):(v=2*Math.sqrt(1+d-a-h),t[3]=(s-c)/v,t[0]=(p+u)/v,t[1]=(l+f)/v,t[2]=.25*v),t}function je(t,e,n,r,i){var o=e[0],a=e[1],s=e[2],u=e[3],c=o+o,h=a+a,l=s+s,p=o*c,f=o*h,d=o*l,y=a*h,v=a*l,g=s*l,m=u*c,b=u*h,T=u*l,E=r[0],w=r[1],x=r[2],_=i[0],P=i[1],M=i[2],A=(1-(y+g))*E,S=(f+T)*E,N=(d-b)*E,C=(f-T)*w,O=(1-(p+g))*w,I=(v+m)*w,k=(d+b)*x,R=(v-m)*x,D=(1-(p+y))*x;return t[0]=A,t[1]=S,t[2]=N,t[3]=0,t[4]=C,t[5]=O,t[6]=I,t[7]=0,t[8]=k,t[9]=R,t[10]=D,t[11]=0,t[12]=n[0]+_-(A*_+C*P+k*M),t[13]=n[1]+P-(S*_+O*P+R*M),t[14]=n[2]+M-(N*_+I*P+D*M),t[15]=1,t}function Fe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,c=n*a,h=r*a,l=r*s,p=i*a,f=i*s,d=i*u,y=o*a,v=o*s,g=o*u;return t[0]=1-l-d,t[1]=h+g,t[2]=p-v,t[3]=0,t[4]=h-g,t[5]=1-c-d,t[6]=f+y,t[7]=0,t[8]=p+v,t[9]=f-y,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}xt(),Mt(1,0,0),Mt(0,1,0),Te(),Te(),bt();var Ge,Ue=function(){function t(t,e){this.min=xt(),this.max=xt(),this.update(t,e)}return t.prototype.update=function(t,e){this.center=At(xt(),t||xt()),this.halfExtents=At(xt(),e||Mt(0,0,0)),this.min=he(this.min,this.center,this.halfExtents),this.max=Nt(this.max,this.center,this.halfExtents)},t.prototype.setMinMax=function(t,e){Nt(this.center,e,t),jt(this.center,this.center,.5),he(this.halfExtents,e,t),jt(this.halfExtents,this.halfExtents,.5),At(this.min,t),At(this.max,e)},t.prototype.getMin=function(){return this.min},t.prototype.getMax=function(){return this.max},t.prototype.add=function(t){var e=this.center,n=e[0],r=e[1],i=e[2],o=this.halfExtents,a=o[0],s=o[1],u=o[2],c=n-a,h=n+a,l=r-s,p=r+s,f=i-u,d=i+u,y=t.center,v=y[0],g=y[1],m=y[2],b=t.halfExtents,T=b[0],E=b[1],w=b[2],x=v-T,_=v+T,P=g-E,M=g+E,A=m-w,S=m+w;x<c&&(c=x),_>h&&(h=_),P<l&&(l=P),M>p&&(p=M),A<f&&(f=A),S>d&&(d=S),e[0]=.5*(c+h),e[1]=.5*(l+p),e[2]=.5*(f+d),o[0]=.5*(h-c),o[1]=.5*(p-l),o[2]=.5*(d-f),this.min[0]=c,this.min[1]=l,this.min[2]=f,this.max[0]=h,this.max[1]=p,this.max[2]=d},t.prototype.setFromTransformedAABB=function(t,e){var n=this.center,r=this.halfExtents,i=t.center,o=t.halfExtents,a=e[0],s=e[4],u=e[8],c=e[1],h=e[5],l=e[9],p=e[2],f=e[6],d=e[10],y=Math.abs(a),v=Math.abs(s),g=Math.abs(u),m=Math.abs(c),b=Math.abs(h),T=Math.abs(l),E=Math.abs(p),w=Math.abs(f),x=Math.abs(d);St(n,e[12]+a*i[0]+s*i[1]+u*i[2],e[13]+c*i[0]+h*i[1]+l*i[2],e[14]+p*i[0]+f*i[1]+d*i[2]),St(r,y*o[0]+v*o[1]+g*o[2],m*o[0]+b*o[1]+T*o[2],E*o[0]+w*o[1]+x*o[2]),this.min=he(this.min,n,r),this.max=Nt(this.max,n,r)},t.prototype.intersects=function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2]},t.prototype.intersection=function(e){if(!this.intersects(e))return null;var n=new t,r=Bt(xt(),this.getMin(),e.getMin()),i=Dt(xt(),this.getMax(),e.getMax());return n.setMinMax(r,i),n},t.prototype.containsPoint=function(t){var e=this.getMin(),n=this.getMax();return!(t[0]<e[0]||t[0]>n[0]||t[1]<e[1]||t[1]>n[1]||t[2]<e[2]||t[2]>n[2])},t.prototype.getNegativeFarPoint=function(t){return 273===t.pnVertexFlag?At(xt(),this.min):272===t.pnVertexFlag?Mt(this.min[0],this.min[1],this.max[2]):257===t.pnVertexFlag?Mt(this.min[0],this.max[1],this.min[2]):256===t.pnVertexFlag?Mt(this.min[0],this.max[1],this.max[2]):17===t.pnVertexFlag?Mt(this.max[0],this.min[1],this.min[2]):16===t.pnVertexFlag?Mt(this.max[0],this.min[1],this.max[2]):1===t.pnVertexFlag?Mt(this.max[0],this.max[1],this.min[2]):Mt(this.max[0],this.max[1],this.max[2])},t.prototype.getPositiveFarPoint=function(t){return 273===t.pnVertexFlag?At(xt(),this.max):272===t.pnVertexFlag?Mt(this.max[0],this.max[1],this.min[2]):257===t.pnVertexFlag?Mt(this.max[0],this.min[1],this.max[2]):256===t.pnVertexFlag?Mt(this.max[0],this.min[1],this.min[2]):17===t.pnVertexFlag?Mt(this.min[0],this.max[1],this.max[2]):16===t.pnVertexFlag?Mt(this.min[0],this.max[1],this.min[2]):1===t.pnVertexFlag?Mt(this.min[0],this.min[1],this.max[2]):Mt(this.min[0],this.min[1],this.min[2])},t}(),Ve=xt(),We=(function(){function t(t,e){this.center=t||xt(),this.radius=e||.5}t.prototype.containsPoint=function(t){return he(Ve,t,this.center),Pt(Ve)<this.radius*this.radius},t.prototype.intersects=function(t){he(Ve,t.center,this.center);var e=t.radius+this.radius;return Pt(Ve)<=e*e}}(),function(){function t(t,e){this.distance=t||0,this.normal=e||Mt(0,1,0),this.updatePNVertexFlag()}return t.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)},t.prototype.distanceToPoint=function(t){return qt(t,this.normal)-this.distance},t.prototype.normalize=function(){var t=1/ye(this.normal);jt(this.normal,this.normal,t),this.distance*=t},t.prototype.intersectsLine=function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),o=i>=0&&i<=1;return o&&n&&Xt(n,t,e,i),o},t}());!function(t){t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE"}(Ge||(Ge={}));var ze,He=function(){function t(t){if(this.planes=[],t)this.planes=t;else for(var e=0;e<6;e++)this.planes.push(new We)}return t.prototype.extractFromVPMatrix=function(t){var e=l(t,16),n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],p=e[9],f=e[10],d=e[11],y=e[12],v=e[13],g=e[14],m=e[15];St(this.planes[0].normal,o-n,c-a,d-h),this.planes[0].distance=m-y,St(this.planes[1].normal,o+n,c+a,d+h),this.planes[1].distance=m+y,St(this.planes[2].normal,o+r,c+s,d+p),this.planes[2].distance=m+v,St(this.planes[3].normal,o-r,c-s,d-p),this.planes[3].distance=m-v,St(this.planes[4].normal,o-i,c-u,d-f),this.planes[4].distance=m-g,St(this.planes[5].normal,o+i,c+u,d+f),this.planes[5].distance=m+g,this.planes.forEach((function(t){t.normalize(),t.updatePNVertexFlag()}))},t}(),qe=xt(),Ye=xt(),Xe=xt(),$e=xt(),Ke=xt(),Je=(function(){function t(t,e){this.origin=t||xt(),this.direction=e||Mt(0,0,-1)}t.prototype.intersectsAABB=function(t,e){return e?this.intersectAABBWithIntersection(t,e):this.intersectsAABBWithoutIntersection(t)},t.prototype.intersectsSphere=function(t,e){var n=he(qe,this.origin,t.center);Ht(Ye,At(Ye,this.direction));var r=qt(n,Ye),i=qt(n,n)-t.radius*t.radius;if(i>0&&r>0)return null;var o=r*r-i;if(o<0)return!1;var a=Math.abs(-r-Math.sqrt(o));return e&&(At(e,this.direction),Ft(e,this.origin,e,a)),!0},t.prototype.intersectsPlane=function(t,e){var n=(t.distance-qt(t.normal,this.origin))/qt(t.normal,this.direction),r=n>=0;return r&&e&&Ft(e,this.origin,this.direction,n),r},t.prototype.intersectsAABBWithoutIntersection=function(t){var e=qe,n=Ye,r=Xe,i=$e,o=Ke,a=this.direction;return he(e,this.origin,t.center),St(i,Math.abs(e[0]),Math.abs(e[1]),Math.abs(e[2])),le(r,e,a),!(i[0]>t.halfExtents[0]&&r[0]>=0||i[1]>t.halfExtents[1]&&r[1]>=0||i[2]>t.halfExtents[2]&&r[2]>=0||(St(o,Math.abs(a[0]),Math.abs(a[1]),Math.abs(a[2])),Yt(n,a,e),St(n,Math.abs(n[0]),Math.abs(n[1]),Math.abs(n[2])),n[0]>t.halfExtents[1]*o[2]+t.halfExtents[2]*o[1]||n[1]>t.halfExtents[0]*o[2]+t.halfExtents[2]*o[0]||n[2]>t.halfExtents[0]*o[1]+t.halfExtents[1]*o[0]))},t.prototype.intersectAABBWithIntersection=function(t,e){var n=At(xt(),t.getMin());he(n,n,this.origin);var r=At(xt(),t.getMax());he(r,r,this.origin);var i=this.direction;0===i[0]?(n[0]=n[0]<0?-Number.MAX_VALUE:Number.MAX_VALUE,r[0]=r[0]<0?-Number.MAX_VALUE:Number.MAX_VALUE):(n[0]/=i[0],r[0]/=i[0]),0===i[1]?(n[1]=n[1]<0?-Number.MAX_VALUE:Number.MAX_VALUE,r[1]=r[1]<0?-Number.MAX_VALUE:Number.MAX_VALUE):(n[1]/=i[1],r[1]/=i[1]),0===i[2]?(n[2]=n[2]<0?-Number.MAX_VALUE:Number.MAX_VALUE,r[2]=r[2]<0?-Number.MAX_VALUE:Number.MAX_VALUE):(n[2]/=i[2],r[2]/=i[2]);var o=St(Xe,Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.min(n[2],r[2])),a=St($e,Math.max(n[0],r[0]),Math.max(n[1],r[1]),Math.max(n[2],r[2])),s=Math.min(Math.min(a[0],a[1]),a[2]),u=Math.max(Math.max(o[0],o[1]),o[2]),c=s>=u&&u>=0;return c&&(At(e,this.direction),Ft(e,this.origin,e,u)),c}}(),function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t}()),Ze=function(){function t(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r,this.left=t,this.right=t+n,this.top=e,this.bottom=e+r}return t.prototype.toJSON=function(){},t}(),Qe=(function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Array.isArray(t[0])?t[0]:t;if("number"!=typeof n[0]){for(var r=[],i=0,o=n.length;i<o;i++)r.push(n[i].x,n[i].y);n=r}this.points=n,this.closeStroke=!0}t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var n=!1,r=this.points.length/2,i=0,o=r-1;i<r;o=i++){var a=this.points[2*i],s=this.points[2*i+1],u=this.points[2*o],c=this.points[2*o+1];s>e!=c>e&&t<(e-s)/(c-s)*(u-a)+a&&(n=!n)}return n}}(),"SceneGraphSelectorFactory"),tn="SceneGraphSelector",en=function(){function t(){}return t.prototype.selectOne=function(t,e){return t.startsWith("#")?e.find((function(e){return e.id===t.substring(1)})):null},t.prototype.selectAll=function(t,e){return t.startsWith(".")?e.findAll((function(e){return e.className===t.substring(1)})):t.startsWith("#")?e.findAll((function(e){return e.id===t.substring(1)})):t.startsWith("[name=")?e.findAll((function(e){return e.name===t.substring(7,t.length-2)})):e.findAll((function(e){return e.nodeName===t}))},t.prototype.is=function(){return!0},a([k()],t)}();function nn(t,e){var n=Number(t.style.zIndex),r=Number(e.style.zIndex);if(n===r){var i=t.parentNode;if(i){var o=i.childNodes||[];return o.indexOf(t)-o.indexOf(e)}}return n-r}function rn(t,e){void 0===e&&(e=!1);for(var n=t;n;){var r=n.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0),n=n.parentNode}t.emit(ze.BOUNDS_CHANGED,{affectChildren:e})}!function(t){t.DESTROY="destroy",t.ATTRIBUTE_CHANGED="attribute-changed",t.INSERTED="inserted",t.CHILD_INSERTED="child-inserted",t.REMOVED="removed",t.CHILD_REMOVED="child-removed",t.MOUNTED="mounted",t.UNMOUNTED="unmounted",t.BOUNDS_CHANGED="bounds-changed",t.RENDER_ORDER_CHANGED="render-order-changed"}(ze||(ze={}));var on,an,sn="SceneGraphService",un=function(){function t(){var t,e,n,r,i,o=this;this.sort=function(t,e){if(!t.parentNode)return-1;if(!e.parentNode)return 1;var n=t.transformable.graphDepth-e.transformable.graphDepth,r=t,i=e;if(n<0){if((i=e.getAncestor(-n))===r)return-1}else if(n>0&&i===(r=t.getAncestor(n)))return 1;for(;r&&i&&r.parentNode!==i.parentNode;)r=r.parentNode,i=i.parentNode;var o=r.parentNode;if(o){var a=o.sortable;if(a)return a.sorted||(a.sorted=o.childNodes.slice()),a.dirty&&(a.sorted=o.childNodes.slice().sort(nn),a.dirty=!1),a.sorted.indexOf(r)-a.sorted.indexOf(i)}return-1},this.rotate=(t=Te(),function(e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof n&&(n=Mt(n,r,i));var a=e.transformable;if(null===e.parentNode)o.rotateLocal(e,n);else{var s=Te();_e(s,n[0],n[1],n[2]);var u=o.getRotation(e),c=o.getRotation(e.parentNode);Me(t,c),xe(t,t),we(t,t,s),we(a.localRotation,s,u),function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a}(a.localRotation,a.localRotation),o.dirtifyLocal(e,a)}}),this.rotateLocal=(e=Te(),function(t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof n&&(n=Mt(n,r,i));var a=t.transformable;_e(e,n[0],n[1],n[2]),Ae(a.localRotation,a.localRotation,e),o.dirtifyLocal(t,a)}),this.setEulerAngles=(n=Te(),function(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0),"number"==typeof e&&(e=Mt(e,r,i));var a=t.transformable;if(null===t.parentNode)o.setLocalEulerAngles(t,e);else{_e(a.localRotation,e[0],e[1],e[2]);var s=o.getRotation(t.parentNode);Me(n,xe(Te(),s)),Ae(a.localRotation,a.localRotation,n),o.dirtifyLocal(t,a)}}),this.translateLocal=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Mt(e,n,r));var i=t.transformable;ue(e,xt())||(te(e,e,i.localRotation),Nt(i.localPosition,i.localPosition,e),o.dirtifyLocal(t,i))},this.setPosition=(r=Se(),function(t,e){var n=t.transformable;if(e=Mt(e[0],e[1],e[2]||n.position[2]),!ue(o.getPosition(t),e)){if(n.position=e,null===t.parentNode)At(n.localPosition,e);else{var i=t.parentNode.transformable;Ne(r,i.worldTransform),Oe(r,r),Zt(n.localPosition,e,r)}o.dirtifyLocal(t,n)}}),this.translate=(i=xt(),function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Mt(e,n,r)),ue(e,xt())||(Nt(i,o.getPosition(t),e),o.setPosition(t,i))})}return t.prototype.matches=function(t,e){return this.sceneGraphSelectorFactory().is(t,e)},t.prototype.querySelector=function(t,e){return this.sceneGraphSelectorFactory().selectOne(t,e)},t.prototype.querySelectorAll=function(t,e){return this.sceneGraphSelectorFactory().selectAll(t,e)},t.prototype.attach=function(t,e,n){t.parentNode&&this.detach(t),t.parentNode=e,ct(n)?t.parentNode.childNodes.push(t):t.parentNode.childNodes.splice(n,0,t);var r=e.sortable;r&&(r.dirty=!0),this.updateGraphDepth(t);var i=t.transformable;i&&this.dirtifyWorld(t,i),i.frozen&&this.unfreezeParentToRoot(t)},t.prototype.detach=function(t){if(t.parentNode){var e=t.transformable;if(e){var n=this.getWorldTransform(t,e);Be(e.localScale,n),De(e.localPosition,n),Le(e.localRotation,n),e.localDirtyFlag=!0}var r=t.parentNode.sortable;r&&(r.dirty=!0);var i=t.parentNode.childNodes.indexOf(t);i>-1&&t.parentNode.childNodes.splice(i,1),e&&this.dirtifyWorld(t,e),t.parentNode=null}},t.prototype.getOrigin=function(t){return t.transformable.origin},t.prototype.setOrigin=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Mt(e,n,r));var i=t.transformable;if(!ue(e,i.origin)){var o=i.origin;o[0]=e[0],o[1]=e[1],o[2]=e[2]||0,this.dirtifyLocal(t,i)}},t.prototype.setLocalEulerAngles=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0),"number"==typeof e&&(e=Mt(e,n,r));var i=t.transformable;_e(i.localRotation,e[0],e[1],e[2]),this.dirtifyLocal(t,i)},t.prototype.setLocalPosition=function(t,e){var n=t.transformable;e=Mt(e[0],e[1],e[2]||n.localPosition[2]),ue(n.localPosition,e)||(At(n.localPosition,e),this.dirtifyLocal(t,n))},t.prototype.scaleLocal=function(t,e){var n=t.transformable;Ot(n.localScale,n.localScale,Mt(e[0],e[1],e[2]||1)),this.dirtifyLocal(t,n)},t.prototype.setLocalScale=function(t,e){var n=t.transformable,r=Mt(e[0],e[1],e[2]||n.localScale[2]);ue(r,n.localScale)||(At(n.localScale,r),this.dirtifyLocal(t,n))},t.prototype.dirtifyLocal=function(t,e){e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(t,e))},t.prototype.dirtifyWorld=function(t,e){e.dirtyFlag||this.unfreezeParentToRoot(t),this.dirtifyWorldInternal(t,e),rn(t,!0)},t.prototype.getPosition=function(t){var e=t.transformable;return De(e.position,this.getWorldTransform(t,e))},t.prototype.getRotation=function(t){var e=t.transformable;return Le(e.rotation,this.getWorldTransform(t,e))},t.prototype.getScale=function(t){var e=t.transformable;return Be(e.scaling,this.getWorldTransform(t,e))},t.prototype.getWorldTransform=function(t,e){return void 0===e&&(e=t.transformable),e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&this.getWorldTransform(t.parentNode),this.sync(t,e),e.worldTransform):e.worldTransform},t.prototype.getLocalPosition=function(t){return t.transformable.localPosition},t.prototype.getLocalRotation=function(t){return t.transformable.localRotation},t.prototype.getLocalScale=function(t){return t.transformable.localScale},t.prototype.getLocalTransform=function(t){var e=t.transformable;return e.localDirtyFlag&&(je(e.localTransform,e.localRotation,e.localPosition,e.localScale,e.origin),e.localDirtyFlag=!1),e.localTransform},t.prototype.resetLocalTransform=function(t){this.setLocalScale(t,[1,1,1]),this.setLocalPosition(t,[0,0,0]),this.setLocalEulerAngles(t,[0,0,0])},t.prototype.getTransformedGeometryBounds=function(t,e){void 0===e&&(e=!1);var n=this.getGeometryBounds(t,e);if(n){var r=new Ue;return r.setFromTransformedAABB(n,this.getWorldTransform(t)),r}return null},t.prototype.getGeometryBounds=function(t,e){void 0===e&&(e=!1);var n=t.geometry,r=e?n.renderBounds:n.contentBounds||null;return r&&new Ue(r.center,r.halfExtents)||null},t.prototype.getBounds=function(t,e){var n=this;void 0===e&&(e=!1);var r=t.renderable;if(!r.boundsDirty&&!e&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&e&&r.renderBounds)return r.renderBounds;var i=this.getTransformedGeometryBounds(t,e);t.childNodes.forEach((function(t){var r=n.getBounds(t,e);r&&(i?i.add(r):(i=new Ue).update(r.center,r.halfExtents))}));var o=t.style.clipPath;if(o){var a=this.getTransformedGeometryBounds(o,!0),s=void 0;a&&(s=new Ue).setFromTransformedAABB(a,this.getWorldTransform(t)),i?s&&(i=s.intersection(i)):i=s}return i&&(e?r.renderBounds=i:r.bounds=i),e?r.renderBoundsDirty=!1:r.boundsDirty=!1,i||null},t.prototype.getLocalBounds=function(t){if(t.parentNode){var e=Se();t.parentNode.transformable&&(e=Oe(Se(),this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(n){var r=new Ue;return r.setFromTransformedAABB(n,e),r}}return this.getBounds(t)},t.prototype.getBoundingClientRect=function(t){var e,n,r,i=this.getGeometryBounds(t);i&&(r=new Ue).setFromTransformedAABB(i,this.getWorldTransform(t));var o=null===(n=null===(e=t.ownerDocument)||void 0===e?void 0:e.defaultView)||void 0===n?void 0:n.getContextService().getBoundingClientRect();if(r){var a=l(r.getMin(),2),s=a[0],u=a[1],c=l(r.getMax(),2),h=c[0],p=c[1];return new Ze(s+((null==o?void 0:o.left)||0),u+((null==o?void 0:o.top)||0),h-s,p-u)}return new Ze((null==o?void 0:o.left)||0,(null==o?void 0:o.top)||0,0,0)},t.prototype.dirtifyWorldInternal=function(t,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,t.childNodes.forEach((function(t){var e=t.transformable;e.dirtyFlag||n.dirtifyWorldInternal(t,e)}));var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0,r.dirty=!0),t.emit(ze.ATTRIBUTE_CHANGED,{attributeName:"modelMatrix",oldValue:null,newValue:null})}},t.prototype.syncHierarchy=function(t){var e=t.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(t,e);for(var n=t.childNodes,r=0;r<n.length;r++)this.syncHierarchy(n[r])}},t.prototype.sync=function(t,e){if(e.localDirtyFlag&&(je(e.localTransform,e.localRotation,e.localPosition,e.localScale,e.origin),e.localDirtyFlag=!1),e.dirtyFlag){var n=t.parentNode,r=n&&n.transformable;null!==n&&r?Ie(e.worldTransform,r.worldTransform,e.localTransform):Ne(e.worldTransform,e.localTransform),e.dirtyFlag=!1}},t.prototype.updateGraphDepth=function(t){var e=t.transformable;t.parentNode?e.graphDepth=t.parentNode.transformable.graphDepth+1:e.graphDepth=0;for(var n=t.childNodes,r=0;r<n.length;r++)this.updateGraphDepth(n[r])},t.prototype.unfreezeParentToRoot=function(t){for(var e=t.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}},a([R(Qe),s("design:type",Function)],t.prototype,"sceneGraphSelectorFactory",void 0),a([k()],t)}(),cn="GeometryUpdaterFactory",hn="GeometryAABBGenerator";(an=on||(on={})).Group="group",an.Circle="circle",an.Ellipse="ellipse",an.Image="image",an.Rect="rect",an.Line="line",an.Polyline="polyline",an.Polygon="polygon",an.Text="text",an.Path="path",an.HTML="html";var ln,pn="CanvasConfig",fn=function(){function t(){}return t.prototype.update=function(t){var e=t.r,n=void 0===e?0:e,r=t.x,i=void 0===r?0:r,o=t.y;return{width:2*n,height:2*n,x:i,y:void 0===o?0:o}},a([k({token:{token:hn,named:on.Circle}})],t)}(),dn=function(){function t(){}return t.prototype.update=function(t){var e=t.rx,n=void 0===e?0:e,r=t.ry,i=void 0===r?0:r,o=t.x,a=void 0===o?0:o,s=t.y;return{width:2*n,height:2*i,x:a,y:void 0===s?0:s}},a([k({token:{token:hn,named:on.Ellipse}})],t)}(),yn=function(){function t(){}return t.prototype.update=function(t){var e,n,r=t.img,i=t.x,o=void 0===i?0:i,a=t.y,s=void 0===a?0:a,u=t.width,c=void 0===u?0:u,h=t.height,l=void 0===h?0:h;return r&&!rt(r)&&(t.width||(e=r.width),t.height||(n=r.height)),{width:e||c,height:n||l,x:o,y:s}},a([k({token:[{token:hn,named:on.Rect},{token:hn,named:on.Image}]})],t)}(),vn=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],gn=function(){function t(){}return t.prototype.getOrCreateCanvas=function(){if(this.canvas)return this.canvas;try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d"),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d")}return this.canvas.width=10,this.canvas.height=10,this.canvas},t.prototype.getOrCreateContext=function(){return this.context||this.getOrCreateCanvas(),this.context},a([k()],t)}(),mn={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},bn=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,Tn=new RegExp(/[!%),.:;?\]}'""]/.source+"|"+/[!),.:;?\]}'""]/.source+"|"+/[)\]'"?!:;,.]/.source+"|"+/[!%),.:;?\]}'"]/.source),En=new RegExp(/[$('"]/.source+"|"+/[([{'"]/.source+"|"+/[(['"...]/.source+"|"+/[$([{'"#]/.source),wn=function(){function t(){var t=this;this.cache={},this.shouldBreakByKinsokuShorui=function(e,n){return!t.isBreakingSpace(n)&&!(!e||!En.exec(n)&&!Tn.exec(e))},this.trimByKinsokuShorui=function(t){var e=p([],l(t),!1),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e}}return t.prototype.measureFont=function(t){if(this.cache[t])return this.cache[t];var e={ascent:0,descent:0,fontSize:0},n=this.offscreenCanvas.getOrCreateCanvas(),r=this.offscreenCanvas.getOrCreateContext();r.font=t;var i=mn.MetricsString+mn.BaselineSymbol,o=Math.ceil(r.measureText(i).width),a=Math.ceil(r.measureText(mn.BaselineSymbol).width),s=mn.HeightMultiplier*a;a=a*mn.BaselineMultiplier|0,n.width=o,n.height=s,r.fillStyle="#f00",r.fillRect(0,0,o,s),r.font=t,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(i,0,a);var u=r.getImageData(0,0,o,s).data,c=u.length,h=4*o,l=0,p=0,f=!1;for(l=0;l<a;++l){for(var d=0;d<h;d+=4)if(255!==u[p+d]){f=!0;break}if(f)break;p+=h}for(e.ascent=a-l,p=c-h,f=!1,l=s;l>a;--l){for(d=0;d<h;d+=4)if(255!==u[p+d]){f=!0;break}if(f)break;p-=h}return e.descent=l-a,e.fontSize=e.ascent+e.descent,this.cache[t]=e,e},t.prototype.measureText=function(t,e){var n=e.fontSize,r=void 0===n?0:n,i=e.wordWrap,o=e.lineHeight,a=void 0===o?0:o,s=e.lineWidth,u=void 0===s?0:s,c=e.textBaseline,h=e.textAlign,l=e.letterSpacing,p=void 0===l?0:l,f=e.dropShadow,d=e.dropShadowDistance,y=void 0===d?0:d,v=e.leading,g=void 0===v?0:v,m=function(t){var e=t.fontSize,n=t.fontFamily,r=t.fontStyle,i=t.fontVariant,o=t.fontWeight,a=ot(e)?e+"px":e,s=n;Array.isArray(n)||(s=n.split(","));for(var u=s.length-1;u>=0;u--){var c=s[u].trim();!/([\"\'])[^\'\"]+\1/.test(c)&&vn.indexOf(c)<0&&(c='"'+c+'"'),s[u]=c}return r+" "+i+" "+o+" "+a+" "+s.join(",")}(e),b=this.measureFont(m);0===b.fontSize&&(b.fontSize=r,b.ascent=r);var T=this.offscreenCanvas.getOrCreateContext();T.font=m;for(var E=(i?this.wordWrap(t,e):t).split(/(?:\r\n|\r|\n)/),w=new Array(E.length),x=0,_=0;_<E.length;_++){var P=T.measureText(E[_]).width+(E[_].length-1)*p;w[_]=P,x=Math.max(x,P)}var M=x+u;f&&(M+=y);var A=a||b.fontSize+u,S=Math.max(A,b.fontSize+u)+(E.length-1)*(A+g);f&&(S+=y);var N=0;return"middle"===c?N=-S/2:"bottom"===c||"alphabetic"===c||"ideographic"===c?N=-S:"top"!==c&&"hanging"!==c||(N=0),{font:m,width:M,height:S,lines:E,lineWidths:w,lineHeight:A+=g,maxLineWidth:x,fontProperties:b,lineMetrics:w.map((function(t,e){var n=0;return"center"===h?n-=t/2:"right"!==h&&"end"!==h||(n-=t),new Ze(n-u/2,N+e*A,t+u,A)}))}},t.prototype.wordWrap=function(t,e){var n=this,r=e.wordWrapWidth,i=void 0===r?0:r,o=e.letterSpacing,a=void 0===o?0:o,s=this.offscreenCanvas.getOrCreateContext(),u=i+a,c=[],h=0,l=0,p={},f=function(t){return n.getFromCache(t,a,p,s)};return Array.from(t).forEach((function(e,r){var i=t[r-1],o=t[r+1],a=f(e);if(n.isNewline(e))return h++,l=0,void(c[h]="");if(l>0&&l+a>u){if(h++,l=0,c[h]="",n.isBreakingSpace(e))return;n.canBreakInLastChar(e)||(c=n.trimToBreakable(c),l=n.sumTextWidthByCache(c[h]||"",p)),n.shouldBreakByKinsokuShorui(e,o)&&(c=n.trimByKinsokuShorui(c),l+=f(i||""))}l+=a,c[h]=(c[h]||"")+e})),c.join("\n")},t.prototype.isBreakingSpace=function(t){return"string"==typeof t&&mn.BreakingSpaces.indexOf(t.charCodeAt(0))>=0},t.prototype.isNewline=function(t){return"string"==typeof t&&mn.Newlines.indexOf(t.charCodeAt(0))>=0},t.prototype.trimToBreakable=function(t){var e=p([],l(t),!1),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),o=r+1,a=r+(this.isBreakingSpace(i)?0:1);return e[e.length-1]+=n.slice(o,n.length),e[e.length-2]=n.slice(0,a),e},t.prototype.canBreakInLastChar=function(t){return!t||!bn.test(t)},t.prototype.sumTextWidthByCache=function(t,e){return t.split("").reduce((function(t,n){if(!e[n])throw Error("cannot count the word without cache");return t+e[n]}),0)},t.prototype.findBreakableIndex=function(t){for(var e=t.length-1;e>=0;e--)if(!bn.test(t[e]))return e;return-1},t.prototype.getFromCache=function(t,e,n,r){var i=n[t];if("number"!=typeof i){var o=t.length*e;i=r.measureText(t).width+o,n[t]=i}return i},a([R(gn),s("design:type",gn)],t.prototype,"offscreenCanvas",void 0),a([k()],t)}(),xn=function(){function t(){}return t.prototype.update=function(t){var e=t.text,n=void 0===e?"":e,r=t.textAlign,i=t.lineWidth,o=void 0===i?0:i,a=t.textBaseline,s=t.x,u=void 0===s?0:s,c=t.y,h=void 0===c?0:c,l=this.textService.measureText(n,t);t.metrics=l;var p=l.width,f=l.height,d=l.lineHeight,y=l.fontProperties,v=Mt(p/2,f/2,0),g=[0,1],m=0;"center"===r?(m=o/2,g=[.5,1]):"right"!==r&&"end"!==r||(m=o,g=[1,1]),t.anchor=g;var b=0;return"middle"===a?b=v[1]:"top"===a||"hanging"===a?b=2*v[1]:"alphabetic"===a?b=d-y.ascent:"bottom"!==a&&"ideographic"!==a||(b=0),{width:2*v[0],height:2*v[1],x:u,y:h,offsetX:m,offsetY:b}},a([R(wn),s("design:type",wn)],t.prototype,"textService",void 0),a([k({token:{token:hn,named:on.Text}})],t)}(),_n=function(){function t(){}return t.prototype.update=function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,o=Math.min(e,r),a=Math.max(e,r),s=Math.min(n,i);return{width:a-o,height:Math.max(n,i)-s,x:o,y:s}},a([k({token:{token:hn,named:on.Line}})],t)}(),Pn=function(){function t(){}return t.prototype.update=function(t){var e=t.points.points,n=Math.min.apply(Math,p([],l(e.map((function(t){return t[0]}))),!1)),r=Math.max.apply(Math,p([],l(e.map((function(t){return t[0]}))),!1)),i=Math.min.apply(Math,p([],l(e.map((function(t){return t[1]}))),!1));return{width:r-n,height:Math.max.apply(Math,p([],l(e.map((function(t){return t[1]}))),!1))-i,x:n,y:i}},a([k({token:[{token:hn,named:on.Polyline},{token:hn,named:on.Polygon}]})],t)}(),Mn=function(){function t(){}return t.prototype.update=function(t){var e=t.path.rect,n=e.x,r=e.y;return{width:e.width,height:e.height,x:n,y:r}},a([k({token:{token:hn,named:on.Path}})],t)}(),An=d.defineToken("ContextService",{multiple:!1});!function(t){t[t.CameraChanged=0]="CameraChanged",t[t.DisplayObjectChanged=1]="DisplayObjectChanged",t[t.DisplayObjectRemoved=2]="DisplayObjectRemoved",t[t.None=3]="None"}(ln||(ln={}));var Sn,Nn="RenderingContext",Cn=n(9991),On=function(){function t(e){this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Je,this.page=new Je,this.canvas=new Je,this.viewport=new Je,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"originalEvent",{get:function(){return this.nativeEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),t.prototype.composedPath=function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(t.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),t.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},t.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t.prototype.initEvent=function(){},t.prototype.initUIEvent=function(){},t}(),In=function(t){function e(e,n){var r=t.call(this,null)||this;return r.type=e,r.detail=n,Object.assign(r,n),r}return r(e,t),e}(On),kn=function(){function t(){this.emitter=new q.EventEmitter}return t.prototype.on=function(t,e,n){return this.addEventListener(t,e,n),this},t.prototype.addEventListener=function(t,e,n){var r=ut(n)&&n||Z(n)&&n.capture,i=Z(n)&&n.once,o=K(e)?void 0:e,a=!1,s="";if(t.indexOf(":")>-1){var u=l(t.split(":"),2),c=u[0];t=u[1],s=c,a=!0}if(t=r?t+"capture":t,e=K(e)?e:e.handleEvent,a){var h=e;e=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(null===(t=e[0].target)||void 0===t?void 0:t.name)===s&&h.apply(void 0,p([],l(e),!1))}}return i?this.emitter.once(t,e,o):this.emitter.on(t,e,o),this},t.prototype.off=function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this},t.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},t.prototype.removeEventListener=function(t,e,n){var r=ut(n)&&n||Z(n)&&n.capture,i=K(e)?void 0:e;return t=r?t+"capture":t,e=K(e)?e:e.handleEvent,this.emitter.off(t,e,i),this},t.prototype.emit=function(t,e){this.dispatchEvent(new In(t,e))},t.prototype.dispatchEvent=function(t){var e,n;if(!(t instanceof On))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var r=this.ownerDocument||this.document;return r&&(t.manager=(null===(e=r.defaultView)||void 0===e?void 0:e.getEventService())||null,t.defaultPrevented=!1,t.path=[],t.target=this,null===(n=t.manager)||void 0===n||n.dispatchEvent(t)),!t.defaultPrevented},t}(),Rn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.textContent=null,e.parentNode=null,e}return r(e,t),e.isNode=function(t){return!!t.childNodes},e.prototype.getRootNode=function(){for(var t=this;t.parentNode;)t=t.parentNode;return t},e.prototype.hasChildNodes=function(){return this.childNodes.length>0},e.prototype.isDefaultNamespace=function(t){throw new Error("Method not implemented.")},e.prototype.compareDocumentPosition=function(t){throw new Error("Method not implemented.")},e.prototype.lookupNamespaceURI=function(t){throw new Error("Method not implemented.")},e.prototype.lookupPrefix=function(t){throw new Error("Method not implemented.")},e.prototype.normalize=function(){throw new Error("Method not implemented.")},e.prototype.isEqualNode=function(t){return this===t},e.prototype.isSameNode=function(t){return this.isEqualNode(t)},Object.defineProperty(e.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),e.prototype.contain=function(t){return this.contains(t)},e.prototype.contains=function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e},e.prototype.getAncestor=function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e},e.prototype.forEach=function(t){t(this)||this.childNodes.forEach((function(e){e.forEach(t)}))},e}(kn),Dn=function(){function t(){}return t.tag="c-geometry",t}(),Bn=function(){function t(){this.boundsDirty=!0,this.renderBoundsDirty=!0,this.dirty=!1}return t.tag="c-renderable",t}(),Ln=function(){function t(){this.dirtyFlag=!1,this.localDirtyFlag=!1,this.frozen=!1,this.graphDepth=0,this.localPosition=Mt(0,0,0),this.localRotation=Pe(0,0,0,1),this.localScale=Mt(1,1,1),this.localTransform=Se(),this.position=Mt(0,0,0),this.rotation=Pe(0,0,0,1),this.scaling=Mt(1,1,1),this.worldTransform=Se(),this.origin=Mt(0,0,0)}return t.tag="c-transform",t}();!function(t){t[t.Standard=0]="Standard"}(Sn||(Sn={}));var jn=function(){function t(){this.strategy=Sn.Standard,this.visibilityPlaneMask=-1,this.visible=!0,this.enable=!0}return t.prototype.isCulled=function(){return this.enable&&!this.visible},t.tag="c-cullable",t}(),Fn=function(){function t(){this.dirty=!1,this.renderOrder=0}return t.tag="c-sortable",t}(),Gn=0,Un=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sceneGraphService=Va.get(sn),e.entity=Gn++,e.renderable=new Bn,e.cullable=new jn,e.transformable=new Ln,e.sortable=new Fn,e.geometry=new Dn,e.scrollLeft=0,e.scrollTop=0,e.destroyed=!1,e.style={},e.parsedStyle={},e.attributes={},e}return r(e,t),e.isElement=function(t){return!!t.getAttribute},Object.defineProperty(e.prototype,"classList",{get:function(){return this.className.split(" ")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(t){throw new Error("Method not implemented.")},e.prototype.appendChild=function(t,e){return this.sceneGraphService.attach(t,this,e),this.emit(ze.CHILD_INSERTED,{child:t}),t.emit(ze.INSERTED,{parent:this}),t},e.prototype.insertBefore=function(t,e){if(e){var n=this.childNodes.indexOf(e);this.appendChild(t,n-1)}else this.appendChild(t);return t},e.prototype.replaceChild=function(t,e,n){var r=this.childNodes.indexOf(e);return this.removeChild(e,n),this.appendChild(t,r),e},e.prototype.removeChild=function(t,e){return void 0===e&&(e=!0),t.emit(ze.REMOVED,{parent:this}),e&&(t.emit(ze.DESTROY,{}),t.destroyed=!0),this.emit(ze.CHILD_REMOVED,{child:t}),this.sceneGraphService.detach(t),e&&t.emitter.removeAllListeners(),t},e.prototype.removeChildren=function(t){var e=this;void 0===t&&(t=!0),this.childNodes.slice().forEach((function(n){e.removeChild(n,t)}))},e.prototype.matches=function(t){return this.sceneGraphService.matches(t,this)},e.prototype.getElementById=function(t){return this.sceneGraphService.querySelector("#"+t,this)},e.prototype.getElementsByName=function(t){return this.sceneGraphService.querySelectorAll('[name="'+t+'"]',this)},e.prototype.getElementsByClassName=function(t){return this.sceneGraphService.querySelectorAll("."+t,this)},e.prototype.getElementsByTagName=function(t){return this.sceneGraphService.querySelectorAll(t,this)},e.prototype.querySelector=function(t){return this.sceneGraphService.querySelector(t,this)},e.prototype.querySelectorAll=function(t){return this.sceneGraphService.querySelectorAll(t,this)},e.prototype.find=function(t){var e=this,n=null;return this.forEach((function(r){return!(r===e||!t(r)||(n=r,0))})),n},e.prototype.findAll=function(t){var e=this,n=[];return this.forEach((function(r){r!==e&&t(r)&&n.push(r)})),n},e.prototype.after=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(this.parentNode){var r=this.parentNode.childNodes.indexOf(this);e.forEach((function(e,n){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(e,r+n+1)}))}},e.prototype.before=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(this.parentNode){var r=this.parentNode.childNodes.indexOf(this),i=l(e),o=i[0],a=i.slice(1);this.parentNode.appendChild(o,r),(t=o).after.apply(t,p([],l(a),!1))}},e.prototype.replaceWith=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.after.apply(this,p([],l(t),!1)),this.remove()},e.prototype.append=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach((function(e){return t.appendChild(e)}))},e.prototype.prepend=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];e.forEach((function(e,n){return t.appendChild(e,n)}))},e.prototype.replaceChildren=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,p([],l(t),!1))},e.prototype.remove=function(t){return void 0===t&&(t=!0),this.parentNode?this.parentNode.removeChild(this,t):this},e.prototype.destroy=function(){this.emit(ze.DESTROY,{}),this.remove(!1),this.emitter.removeAllListeners(),this.destroyed=!0},e.prototype.getGeometryBounds=function(){return this.sceneGraphService.getGeometryBounds(this)},e.prototype.getRenderBounds=function(){return this.sceneGraphService.getBounds(this,!0)},e.prototype.getBounds=function(){return this.sceneGraphService.getBounds(this)},e.prototype.getLocalBounds=function(){return this.sceneGraphService.getLocalBounds(this)},e.prototype.getBoundingClientRect=function(){return this.sceneGraphService.getBoundingClientRect(this)},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getAttribute=function(t){var e=this.attributes[t];return ct(e)?void 0:e},e.prototype.removeAttribute=function(t){delete this.attributes[t]},e.prototype.setAttribute=function(t,e,n){void 0===n&&(n=!1),this.attributes[t]=e},e}(Rn),Vn=function(t){function e(e,n,r,i){var o=t.call(this,e)||this;return o.currentTime=r,o.timelineTime=i,o.target=n,o.type="finish",o.bubbles=!1,o.currentTarget=n,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=r,o.timelineTime=i,o}return r(e,t),e}(On),Wn=0,zn=function(){function t(t,e){this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=e,this.id=""+Wn++,this._inEffect=!!this.effect.update(0),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(t.prototype,"pending",{get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise((function(e,n){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){n(new Error)}})),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise((function(e,n){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){n(new Error)}})),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){var e;t=Number(t),isNaN(t)||(this.timeline.restart(),this._paused||null===this._startTime||(this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate),this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},set:function(t){if(null!==t){if(this.updatePromises(),t=Number(t),isNaN(t))return;if(this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this.totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalDuration",{get:function(){var t;return Number(null===(t=this.effect)||void 0===t?void 0:t.getComputedTiming().activeDuration)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_needsTick",{get:function(){return this.pending||"running"===this.playState||!this._finishedFlag},enumerable:!1,configurable:!0}),t.prototype.updatePromises=function(){var t=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==t&&("idle"===e?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===t?this.resolveReadyPromise():"pending"===e&&(this.readyPromise=void 0)),this.finishedPromise&&e!==t&&("idle"===e?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===e?this.resolveFinishedPromise():"finished"===t&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise},t.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()},t.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()},t.prototype.finish=function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this.totalDuration:0,this._startTime=this.totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},t.prototype.cancel=function(){this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises())},t.prototype.reverse=function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()},t.prototype.updatePlaybackRate=function(t){this.playbackRate=t},t.prototype.targetAnimations=function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()},t.prototype.markTarget=function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)},t.prototype.unmarkTarget=function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)},t.prototype.tick=function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))},t.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else{if(!(this.totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this.totalDuration}},t.prototype.persist=function(){throw new Error("Method not implemented.")},t.prototype.addEventListener=function(t,e,n){throw new Error("Method not implemented.")},t.prototype.removeEventListener=function(t,e,n){throw new Error("Method not implemented.")},t.prototype.dispatchEvent=function(t){throw new Error("Method not implemented.")},t.prototype.commitStyles=function(){throw new Error("Method not implemented.")},t.prototype.ensureAlive=function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!!(null===(t=this.effect)||void 0===t?void 0:t.update(-1)):this._inEffect=!!(null===(e=this.effect)||void 0===e?void 0:e.update(this.currentTime)),this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))},t.prototype.tickCurrentTime=function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this.totalDuration:0),this.ensureAlive())},t.prototype.fireEvents=function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new Vn(null,this,this.currentTime,t);setTimeout((function(){e.onfinish&&e.onfinish(n)}))}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var r=new Vn(null,this,this.currentTime,t);this.onframe(r)}this._finishedFlag=!1}},t}();function Hn(t){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hn(t)}function qn(t){return("object"===("undefined"==typeof window?"undefined":Hn(window))&&window.requestAnimationFrame?window.requestAnimationFrame:function(t){return setTimeout(t,16)})(t)}function Yn(t){return("object"===("undefined"==typeof window?"undefined":Hn(window))&&window.cancelAnimationFrame?window.cancelAnimationFrame:clearTimeout)(t)}function Xn(t,e){return Number(t.id)-Number(e.id)}var $n=function(){function t(){var t=this;this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(e){t.currentTime=e,t.discardAnimations(),0===t.animations.length?t.timelineTicking=!1:t.requestAnimationFrame(t.webAnimationsNextTick)},this.processRafCallbacks=function(e){var n=t.rafCallbacks;t.rafCallbacks=[],e<Number(t.currentTime)&&(e=Number(t.currentTime)),t.animations.sort(Xn),t.animations=t.tick(e,!0,t.animations)[0],n.forEach((function(t){t[1](e)})),t.applyPendingEffects()}}return t.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},t.prototype.isTicking=function(){return this.inTick},t.prototype.play=function(t){var e=new zn(t,this);return this.animations.push(e),this.restartWebAnimationsNextTick(),e.updatePromises(),e.play(),e.updatePromises(),e},t.prototype.applyDirtiedAnimation=function(t){var e=this;if(!this.inTick){t.markTarget();var n=t.targetAnimations();n.sort(Xn),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach((function(t){var n=e.animations.indexOf(t);-1!==n&&e.animations.splice(n,1)})),this.applyPendingEffects()}},t.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame((function(){})),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},t.prototype.destroy=function(){Yn(this.frameId)},t.prototype.applyPendingEffects=function(){this.pendingEffects.forEach((function(t){null==t||t.applyInterpolations()})),this.pendingEffects=[]},t.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter((function(t){return t.updatePromises()}))},t.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter((function(t){return"finished"!==t.playState&&"idle"!==t.playState}))},t.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},t.prototype.rAF=function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=qn(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e},t.prototype.requestAnimationFrame=function(t){var e=this;return this.rAF((function(n){e.updateAnimationsPromises(),t(n),e.updateAnimationsPromises()}))},t.prototype.tick=function(t,e,n){var r,i,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var a=[],s=[],u=[],c=[];return n.forEach((function(n){n.tick(t,e),n._inEffect?(s.push(n.effect),n.markTarget()):(a.push(n.effect),n.unmarkTarget()),n._needsTick&&(o.ticking=!0);var r=n._inEffect||n._needsTick;n._inTimeline=r,r?u.push(n):c.push(n)})),(r=this.pendingEffects).push.apply(r,p([],l(a),!1)),(i=this.pendingEffects).push.apply(i,p([],l(s),!1)),this.ticking&&this.requestAnimationFrame((function(){})),this.inTick=!1,[u,c]},t}(),Kn=.1,Jn="function"==typeof Float32Array,Zn=function(t,e){return 1-3*e+3*t},Qn=function(t,e){return 3*e-6*t},tr=function(t){return 3*t},er=function(t,e,n){return((Zn(e,n)*t+Qn(e,n))*t+tr(e))*t},nr=function(t,e,n){return 3*Zn(e,n)*t*t+2*Qn(e,n)*t+tr(e)},rr=function(t,e,n,r){if(!(0<=t&&t<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===r)return function(t){return t};for(var i=Jn?new Float32Array(11):new Array(11),o=0;o<11;++o)i[o]=er(o*Kn,t,n);return function(o){return 0===o||1===o?o:er(function(e){for(var r=0,o=1;10!==o&&i[o]<=e;++o)r+=Kn;--o;var a=r+(e-i[o])/(i[o+1]-i[o])*Kn,s=nr(a,t,n);return s>=.001?function(t,e,n,r){for(var i=0;i<4;++i){var o=nr(e,n,r);if(0===o)return e;e-=(er(e,n,r)-t)/o}return e}(e,a,t,n):0===s?a:function(t,e,n,r,i){var o,a,s=0;do{(o=er(a=e+(n-e)/2,r,i)-t)>0?n=a:e=a}while(Math.abs(o)>1e-7&&++s<10);return a}(e,r,r+Kn,t,n)}(o),e,r)}},ir=function(t,e,n){return Math.min(Math.max(t,e),n)},or=function(t){return Math.pow(t,2)},ar=function(t){return Math.pow(t,3)},sr=function(t){return Math.pow(t,4)},ur=function(t){return Math.pow(t,5)},cr=function(t){return Math.pow(t,6)},hr=function(t){return 1-Math.cos(t*Math.PI/2)},lr=function(t){return 1-Math.sqrt(1-t*t)},pr=function(t){return t*t*(3*t-2)},fr=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)},dr=function(t,e){void 0===e&&(e=[]);var n=l(e,2),r=n[0],i=void 0===r?1:r,o=n[1],a=void 0===o?.5:o,s=ir(Number(i),1,10),u=ir(Number(a),.1,2);return 0===t||1===t?t:-s*Math.pow(2,10*(t-1))*Math.sin((t-1-u/(2*Math.PI)*Math.asin(1/s))*(2*Math.PI)/u)},yr=function(t,e,n){void 0===e&&(e=[]);var r=l(e,4),i=r[0],o=void 0===i?1:i,a=r[1],s=void 0===a?100:a,u=r[2],c=void 0===u?10:u,h=r[3],p=void 0===h?0:h;o=ir(o,.1,1e3),s=ir(s,.1,1e3),c=ir(c,.1,1e3),p=ir(p,.1,1e3);var f=Math.sqrt(s/o),d=c/(2*Math.sqrt(s*o)),y=d<1?f*Math.sqrt(1-d*d):0,v=d<1?(d*f-p)/y:-p+f,g=n?n*t/1e3:t;return g=d<1?Math.exp(-g*d*f)*(1*Math.cos(y*g)+v*Math.sin(y*g)):(1+v*g)*Math.exp(-g*f),0===t||1===t?t:1-g},vr=(new Map,function(t,e){void 0===e&&(e=[]);var n=l(e,2),r=n[0],i=void 0===r?10:r;return("start"==n[1]?Math.ceil:Math.floor)(ir(t,0,1)*i)/i}),gr=function(t,e){void 0===e&&(e=[]);var n=l(e,4),r=n[0],i=n[1],o=n[2],a=n[3];return rr(r,i,o,a)(t)},mr=rr(.42,0,1,1),br=function(t){return function(e,n,r){return void 0===n&&(n=[]),1-t(1-e,n,r)}},Tr=function(t){return function(e,n,r){return void 0===n&&(n=[]),e<.5?t(2*e,n,r)/2:1-t(-2*e+2,n,r)/2}},Er=function(t){return function(e,n,r){return void 0===n&&(n=[]),e<.5?(1-t(1-2*e,n,r))/2:(t(2*e-1,n,r)+1)/2}},wr={steps:vr,"step-start":function(t){return vr(t,[1,"start"])},"step-end":function(t){return vr(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":gr,ease:function(t){return gr(t,[.25,.1,.25,1])},in:mr,out:br(mr),"in-out":Tr(mr),"out-in":Er(mr),"in-quad":or,"out-quad":br(or),"in-out-quad":Tr(or),"out-in-quad":Er(or),"in-cubic":ar,"out-cubic":br(ar),"in-out-cubic":Tr(ar),"out-in-cubic":Er(ar),"in-quart":sr,"out-quart":br(sr),"in-out-quart":Tr(sr),"out-in-quart":Er(sr),"in-quint":ur,"out-quint":br(ur),"in-out-quint":Tr(ur),"out-in-quint":Er(ur),"in-expo":cr,"out-expo":br(cr),"in-out-expo":Tr(cr),"out-in-expo":Er(cr),"in-sine":hr,"out-sine":br(hr),"in-out-sine":Tr(hr),"out-in-sine":Er(hr),"in-circ":lr,"out-circ":br(lr),"in-out-circ":Tr(lr),"out-in-circ":Er(lr),"in-back":pr,"out-back":br(pr),"in-out-back":Tr(pr),"out-in-back":Er(pr),"in-bounce":fr,"out-bounce":br(fr),"in-out-bounce":Tr(fr),"out-in-bounce":Er(fr),"in-elastic":dr,"out-elastic":br(dr),"in-out-elastic":Tr(dr),"out-in-elastic":Er(dr),spring:yr,"spring-in":yr,"spring-out":br(yr),"spring-in-out":Tr(yr),"spring-out-in":Er(yr)},xr=function(t){return t};function _r(t,e){return function(n){if(n>=1)return 1;var r=1/t;return(n+=e*r)-n%r}}var Pr="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",Mr=new RegExp("cubic-bezier\\("+Pr+","+Pr+","+Pr+","+Pr+"\\)"),Ar=/steps\(\s*(\d+)\s*\)/,Sr=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function Nr(t){var e=Mr.exec(t);if(e)return rr.apply(void 0,p([],l(e.slice(1).map(Number)),!1));var n=Ar.exec(t);if(n)return _r(Number(n[1]),0);var r=Sr.exec(t);return r?_r(Number(r[1]),{start:1,middle:.5,end:0}[r[2]]):wr[function(t){return(e=t,"-"===(e=e.replace(/([A-Z])/g,(function(t){return"-"+t.toLowerCase()}))).charAt(0)?e.substr(1):e).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim();var e}(t)]||wr.linear}var Cr=(Object.keys({in:"ease-in",out:"ease-out","in-out":"ease-in-out","in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","in-out-expo":"cubic-bezier(1, 0, 0, 1)","in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"}),function(){function t(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=xr,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(t.prototype,"easing",{get:function(){return this._easing},set:function(t){this.easingFunction=Nr(t),this._easing=t},enumerable:!1,configurable:!0}),t}());function Or(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var i=r.length,o=0;o<i;o++){if(!e[o]){var a={};"offset"in t&&(a.offset=Number(t.offset)),"easing"in t&&(a.easing=t.easing),"composite"in t&&(a.composite=t.composite),e[o]=a}void 0!==r[o]&&null!==r[o]&&(e[o][n]=r[o])}}return e.sort((function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)})),e}(t));for(var n=t.map((function(t){var n={};for(var r in(null==e?void 0:e.composite)&&(n.composite="auto"),t){var i=t[r];if("offset"===r){if(null!==i){if(i=Number(i),!isFinite(i))throw new Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i}}else if("composite"===r&&-1===["replace","add","accumulate","auto"].indexOf(i))throw new Error(i+" compositing is not supported");n[r]=i}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==e?void 0:e.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n})),r=!0,i=-1/0,o=0;o<n.length;o++){var a=n[o].offset;if(null!=a){if(a<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=a}else r=!1}return n=n.filter((function(t){return Number(t.offset)>=0&&Number(t.offset)<=1})),r||function(){var t,e,r=n.length;n[r-1].computedOffset=Number(null!==(t=n[r-1].offset)&&void 0!==t?t:1),r>1&&(n[0].computedOffset=Number(null!==(e=n[0].offset)&&void 0!==e?e:0));for(var i=0,o=Number(n[0].computedOffset),a=1;a<r;a++){var s=Number(n[a].computedOffset);if(null!=s&&null!=o){for(var u=1;u<a-i;u++)n[i+u].computedOffset=o+(s-o)*u/(a-i);i=a,o=s}}}(),n}function Ir(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}function kr(t,e,n,r){var i=e,o=n,a=Wa[t],s=Ha[t];a&&(i=a(e,r),o=a(n,r));var u=s&&s(i,o,r);if(u){var c=Dr.apply(void 0,p([],l(u),!1));return function(t){return 0===t?e:1===t?n:c(t)}}return Dr(!1,!0,(function(t){return t?n:e}))}function Rr(t,e,n){if("number"==typeof t&&"number"==typeof e)return t*(1-n)+e*n;if("boolean"==typeof t&&"boolean"==typeof e||"string"==typeof t&&"string"==typeof e)return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length){for(var r=[],i=0;i<t.length;i++)r.push(Rr(t[i],e[i],n));return r}throw new Error("Mismatched interpolation arguments "+t+":"+e)}var Dr=function(t,e,n){return function(r){return n(Rr(t,e,r))}},Br="backwards|forwards|both|none".split("|"),Lr="reverse|alternate|alternate-reverse".split("|");var jr,Fr=function(){function t(t,e,n){var r,i=this;this.composite="replace",this.iterationComposite="replace",this.target=t,this.timing=function(t,e){return function(t,e){var n=new Cr;return e&&(n.fill="both",n.duration="auto"),"number"!=typeof t||isNaN(t)?void 0!==t&&Object.keys(t).forEach((function(e){if(void 0!==t[e]&&null!==t[e]&&"auto"!==t[e]){if(("number"==typeof n[e]||"duration"===e)&&("number"!=typeof t[e]||isNaN(t[e])))return;if("fill"===e&&-1===Br.indexOf(t[e]))return;if("direction"===e&&-1===Lr.indexOf(t[e]))return;n[e]=t[e]}})):n.duration=t,n}(t=function(t){return"number"==typeof t&&(t=isNaN(t)?{duration:"auto"}:{duration:t}),t}(null!=t?t:{duration:"auto"}),e)}(n,!1),this.timing.effect=this,this.timing.activeDuration=(r=this.timing,Math.abs(function(t){var e;return 0===t.duration||0===t.iterations?0:("auto"===t.duration?0:Number(t.duration))*(null!==(e=t.iterations)&&void 0!==e?e:1)}(r)/(r.playbackRate||1))),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Or(e,this.timing),this.interpolations=function(t,e,n){var r=function(t,e){for(var n={},r=0;r<t.length;r++)for(var i in t[r])if(Ir(i)){var o={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:Nr(t[r].easing)||e.easingFunction,value:t[r][i]};n[i]=n[i]||[],n[i].push(o)}return n}(t,e),i=function(t,e){var n=[];for(var r in t)for(var i=t[r],o=0;o<i.length-1;o++){var a=o,s=o+1,u=i[a].computedOffset,c=i[s].computedOffset,h=u,l=c;0===o&&(h=-1/0,0===c&&(s=a)),o===i.length-2&&(l=1/0,1===u&&(a=s)),n.push({applyFrom:h,applyTo:l,startOffset:i[a].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[a].easingFunction,property:r,interpolation:kr(r,i[a].value,i[s].value,e)})}return n.sort((function(t,e){return t.startOffset-e.startOffset})),n}(r,n);return function(t,e){if(null!==e)i.filter((function(t){return e>=t.applyFrom&&e<t.applyTo})).forEach((function(n){var r=e-n.startOffset,i=n.endOffset-n.startOffset,o=0===i?0:n.easingFunction(r/i);t.style[n.property]=n.interpolation(o)}));else for(var n in r)Ir(n)&&(t.style[n]=null)}}(this.normalizedKeyframes,this.timing,this.target),this.computedTiming=new Proxy(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?i.animation&&i.animation.currentTime||null:"currentIteration"===e?i.animation&&"running"===i.animation.playState?t.currentIteration||0:null:"progress"===e?i.animation&&"running"===i.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}})}return t.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},t.prototype.update=function(t){return null!==t&&(this.timeFraction=function(t,e,n){var r=function(t,e,n){if(null===e)return 0;var r=n.delay+t+n.endDelay;return e<Math.min(n.delay,r)?1:e>=Math.min(n.delay+t,r)?2:3}(t,e,n),i=function(t,e,n,r,i){switch(r){case 1:return"backwards"===e||"both"===e?0:null;case 3:return n-i;case 2:return"forwards"===e||"both"===e?t:null;case 0:return null}}(t,n.fill,e,r,n.delay);if(null===i)return null;var o="auto"===n.duration?0:n.duration,a=function(t,e,n,r,i){var o=i;return 0===t?1!==e&&(o+=n):o+=r/t,o}(o,r,n.iterations,i,n.iterationStart),s=function(t,e,n,r,i,o){var a=t===1/0?e%1:t%1;return 0!==a||2!==n||0===r||0===i&&0!==o||(a=1),a}(a,n.iterationStart,r,n.iterations,i,o),u=function(t,e,n,r){return 2===t&&e===1/0?1/0:1===n?Math.floor(r)-1:Math.floor(r)}(r,n.iterations,s,a),c=function(t,e,n){var r=t;if("normal"!==t&&"reverse"!==t){var i=e;"alternate-reverse"===t&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse")}return"normal"===r?n:1-n}(n.direction,u,s);return n.currentIteration=u,n.progress=c,n.easingFunction(c)}(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)},t.prototype.getKeyframes=function(){return this.normalizedKeyframes},t.prototype.setKeyframes=function(t){this.normalizedKeyframes=Or(t)},t.prototype.getComputedTiming=function(){return this.computedTiming},t.prototype.getTiming=function(){return this.timing},t.prototype.updateTiming=function(t){var e=this;Object.keys(t||{}).forEach((function(n){e.timing=t[n]}))},t}();function Gr(t){return void 0===t?0:t>360||t<-360?t%360:t}function Ur(t,e,n){return ot(t)?Mt(t,e,n):3===t.length?_t(t):Mt(t[0],t[1],t[2]||0)}function Vr(t){return t*(180/Math.PI)}function Wr(t,e){return 16===e.length?function(t,e){var n,r,i=.5*Math.PI,o=l(Be(xt(),e),3),a=o[0],s=o[1],u=o[2],c=Math.asin(-e[2]/a);return c<i?c>-i?(n=Math.atan2(e[6]/s,e[10]/u),r=Math.atan2(e[1]/a,e[0]/a)):(r=0,n=-Math.atan2(e[4]/s,e[5]/s)):(r=0,n=Math.atan2(e[4]/s,e[5]/s)),t[0]=n,t[1]=c,t[2]=r,t}(t,e):function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=r*r,s=i*i,u=o*o,c=n*n+a+s+u,h=n*o-r*i;return h>.499995*c?(t[0]=Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):h<-.499995*c?(t[0]=-Math.PI/2,t[1]=2*Math.atan2(r,n),t[2]=0):(t[0]=Math.asin(2*(n*i-o*r)),t[1]=Math.atan2(2*(n*o+r*i),1-2*(s+u)),t[2]=Math.atan2(2*(n*r+i*o),1-2*(a+s))),t}(t,e)}function zr(t,e,n,r,i){var o,a,s,u,c,h,l,p=Math.cos(t),f=Math.sin(t);return o=r*p,a=i*f,0,s=-r*f,u=i*p,0,c=e,h=n,1,(l=new gt(9))[0]=o,l[1]=a,l[2]=0,l[3]=s,l[4]=u,l[5]=0,l[6]=c,l[7]=h,l[8]=1,l}function Hr(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function qr(t,e){return Math.abs(t-e)<.001}function Yr(t,e){var n=et(t),r=et(e);return{x:n,y:r,width:tt(t)-n,height:tt(e)-r}}function Xr(t){return(t+2*Math.PI)%(2*Math.PI)}function $r(t,e){var n=new gt(2);return n[0]=t,n[1]=e,n}function Kr(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}jr=new gt(2),gt!=Float32Array&&(jr[0]=0,jr[1]=0);const Jr=function(t,e,n,r){return Hr(t,e,n,r)},Zr=function(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}},Qr=function(t,e,n,r,i,o){var a=[n-t,r-e];if(function(t,e){return t[0]===e[0]&&t[1]===e[1]}(a,[0,0]))return Math.sqrt((i-t)*(i-t)+(o-e)*(o-e));var s=[-a[1],a[0]];!function(t,e){var n=e[0],r=e[1],i=n*n+r*r;i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i}(s,s);var u=[i-t,o-e];return Math.abs(function(t,e){return t[0]*e[0]+t[1]*e[1]}(u,s))};function ti(t,e,n,r,i,o){var a=-1,s=1/0,u=[n,r],c=20;o&&o>200&&(c=o/10);for(var h=1/c,l=h/10,p=0;p<=c;p++){var f=p*h,d=[i.apply(null,t.concat([f])),i.apply(null,e.concat([f]))];(m=Hr(u[0],u[1],d[0],d[1]))<s&&(a=f,s=m)}if(0===a)return{x:t[0],y:e[0]};if(1===a){var y=t.length;return{x:t[y-1],y:e[y-1]}}for(s=1/0,p=0;p<32&&!(l<1e-4);p++){var v=a-l,g=a+l,m=(d=[i.apply(null,t.concat([v])),i.apply(null,e.concat([v]))],Hr(u[0],u[1],d[0],d[1]));if(v>=0&&m<s)a=v,s=m;else{var b=[i.apply(null,t.concat([g])),i.apply(null,e.concat([g]))],T=Hr(u[0],u[1],b[0],b[1]);g<=1&&T<s?(a=g,s=T):l*=.5}}return{x:i.apply(null,t.concat([a])),y:i.apply(null,e.concat([a]))}}function ei(t,e,n,r){var i=1-r;return i*i*t+2*r*i*e+r*r*n}function ni(t,e,n){var r=t+n-2*e;if(qr(r,0))return[.5];var i=(t-e)/r;return i<=1&&i>=0?[i]:[]}function ri(t,e,n,r){return 2*(1-r)*(e-t)+2*r*(n-e)}function ii(t,e,n,r,i,o,a){var s=ei(t,n,i,a),u=ei(e,r,o,a),c=Zr(t,e,n,r,a),h=Zr(n,r,i,o,a);return[[t,e,c.x,c.y,s,u],[s,u,h.x,h.y,i,o]]}function oi(t,e,n,r,i,o,a){if(0===a)return(Hr(t,e,n,r)+Hr(n,r,i,o)+Hr(t,e,i,o))/2;var s=ii(t,e,n,r,i,o,.5),u=s[0],c=s[1];return u.push(a-1),c.push(a-1),oi.apply(null,u)+oi.apply(null,c)}const ai={box:function(t,e,n,r,i,o){var a=ni(t,n,i)[0],s=ni(e,r,o)[0],u=[t,i],c=[e,o];return void 0!==a&&u.push(ei(t,n,i,a)),void 0!==s&&c.push(ei(e,r,o,s)),Yr(u,c)},length:function(t,e,n,r,i,o){return oi(t,e,n,r,i,o,3)},nearestPoint:function(t,e,n,r,i,o,a,s){return ti([t,n,i],[e,r,o],a,s,ei)},pointDistance:function(t,e,n,r,i,o,a,s){var u=this.nearestPoint(t,e,n,r,i,o,a,s);return Hr(u.x,u.y,a,s)},interpolationAt:ei,pointAt:function(t,e,n,r,i,o,a){return{x:ei(t,n,i,a),y:ei(e,r,o,a)}},divide:function(t,e,n,r,i,o,a){return ii(t,e,n,r,i,o,a)},tangentAngle:function(t,e,n,r,i,o,a){var s=ri(t,n,i,a),u=ri(e,r,o,a);return Xr(Math.atan2(u,s))}};function si(t,e,n,r,i){var o=1-i;return o*o*o*t+3*e*i*o*o+3*n*i*i*o+r*i*i*i}function ui(t,e,n,r,i){var o=1-i;return 3*(o*o*(e-t)+2*o*i*(n-e)+i*i*(r-n))}function ci(t,e,n,r){var i,o,a,s=-3*t+9*e-9*n+3*r,u=6*t-12*e+6*n,c=3*e-3*t,h=[];if(qr(s,0))qr(u,0)||(i=-c/u)>=0&&i<=1&&h.push(i);else{var l=u*u-4*s*c;qr(l,0)?h.push(-u/(2*s)):l>0&&(o=(-u-(a=Math.sqrt(l)))/(2*s),(i=(-u+a)/(2*s))>=0&&i<=1&&h.push(i),o>=0&&o<=1&&h.push(o))}return h}function hi(t,e,n,r,i,o,a,s,u){var c=si(t,n,i,a,u),h=si(e,r,o,s,u),l=Zr(t,e,n,r,u),p=Zr(n,r,i,o,u),f=Zr(i,o,a,s,u),d=Zr(l.x,l.y,p.x,p.y,u),y=Zr(p.x,p.y,f.x,f.y,u);return[[t,e,l.x,l.y,d.x,d.y,c,h],[c,h,y.x,y.y,f.x,f.y,a,s]]}function li(t,e,n,r,i,o,a,s,u){if(0===u)return function(t,e){for(var n=0,r=t.length,i=0;i<r;i++)n+=Hr(t[i],e[i],t[(i+1)%r],e[(i+1)%r]);return n/2}([t,n,i,a],[e,r,o,s]);var c=hi(t,e,n,r,i,o,a,s,.5),h=p(p([],l(c[0]),!1),[u-1],!1),f=p(p([],l(c[1]),!1),[u-1],!1);return li.apply(null,h)+li.apply(null,f)}const pi={extrema:ci,box:function(t,e,n,r,i,o,a,s){for(var u=[t,a],c=[e,s],h=ci(t,n,i,a),l=ci(e,r,o,s),p=0;p<h.length;p++)u.push(si(t,n,i,a,h[p]));for(p=0;p<l.length;p++)c.push(si(e,r,o,s,l[p]));return Yr(u,c)},length:function(t,e,n,r,i,o,a,s){return li(t,e,n,r,i,o,a,s,3)},nearestPoint:function(t,e,n,r,i,o,a,s,u,c,h){return ti([t,n,i,a],[e,r,o,s],u,c,si,h)},pointDistance:function(t,e,n,r,i,o,a,s,u,c,h){var l=this.nearestPoint(t,e,n,r,i,o,a,s,u,c,h);return Hr(l.x,l.y,u,c)},interpolationAt:si,pointAt:function(t,e,n,r,i,o,a,s,u){return{x:si(t,n,i,a,u),y:si(e,r,o,s,u)}},divide:function(t,e,n,r,i,o,a,s,u){return hi(t,e,n,r,i,o,a,s,u)},tangentAngle:function(t,e,n,r,i,o,a,s,u){var c=ui(t,n,i,a,u),h=ui(e,r,o,s,u);return Xr(Math.atan2(h,c))}};const fi=function(t){return function(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];e+=Hr(r[0],r[1],i[0],i[1])}return e}(t)};function di(t,e,n){var r=t[0],i=t[1];return[r+(e[0]-r)*n,i+(e[1]-i)*n]}function yi(t){return t.map((function(t,e,n){var r=e&&n[e-1].slice(-2).concat(t.slice(1)),i=e?pi.length.apply(pi,p([],l(r),!1)):0;return{s:t,ss:e?i?function(t,e){void 0===e&&(e=.5);var n=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),o=t.slice(6,8),a=di(n,r,e),s=di(r,i,e),u=di(i,o,e),c=di(a,s,e),h=di(s,u,e),l=di(c,h,e);return[["C"].concat(a,c,l),["C"].concat(h,u,o)]}(r):[t,t]:[t],l:i}}))}function vi(t,e,n){var r=yi(t),i=yi(e),o=r.length,a=i.length,s=r.filter((function(t){return t.l})).length,u=i.filter((function(t){return t.l})).length,c=r.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/s||0,h=i.filter((function(t){return t.l})).reduce((function(t,e){return t+e.l}),0)/u||0,l=n||Math.max(o,a),p=[c,h],f=[l-o,l-a],d=0,y=[r,i].map((function(t,e){return t.l===l?t.map((function(t){return t.s})):t.map((function(t,n){return d=n&&f[e]&&t.l>=p[e],f[e]-=d?1:0,d?t.ss:[t.s]})).flat()}));return y[0].length===y[1].length?y:vi(y[0],y[1],l)}function gi(t){return function(t){var e=0,n=0,r=0,i=0,o=0;return t.map((function(t){var a;switch(t[0]){case"M":case"Z":return r="M"===t[0]?t[1]:r,i="M"===t[0]?t[2]:i,e=r,n=i,0;default:return o=mi.apply(0,[e,n].concat(t.slice(1))),a=l(t.slice(-2),2),e=a[0],n=a[1],o}})).reduce((function(t,e){return t+e}),0)}(t)>=0}function mi(t,e,n,r,i,o,a,s){return 3*((s-e)*(n+i)-(a-t)*(r+o)+r*(t-i)-n*(e-o)+s*(i+t/3)-a*(o+e/3))/20}function bi(t){return t.map((function(t){return Array.isArray(t)?bi(t):Number.isNaN(+t)?t:+t}))}var Ti,Ei={anchor:[0,0,0],origin:[0,0,0],opacity:1,fillOpacity:1,strokeOpacity:1},wi=function(t){function e(e){var n,r,o,a=t.call(this)||this;return a.activeAnimations=[],a.config=e,a.config.interactive=null!==(n=a.config.capture)&&void 0!==n?n:a.config.interactive,a.id=a.config.id||"",a.name=a.config.name||"",a.className=a.config.className||"",a.interactive=null===(r=a.config.interactive)||void 0===r||r,a.nodeName=a.config.type||on.Group,a.config.style=i(i(i(i({},Ei),{zIndex:null!==(o=a.config.zIndex)&&void 0!==o?o:0,visibility:!1===a.config.visible?"hidden":"visible"}),a.config.style),a.config.attrs),a.style=new Proxy(a.attributes,{get:function(t,e){return a.getAttribute(e)},set:function(t,e,n){return a.setAttribute(e,n),!0}}),a.initAttributes(a.config.style),Va.get(Y).add(a.entity,a),a}return r(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),Va.get(Y).remove(this.entity),this.getAnimations().forEach((function(t){t.cancel()}))},e.prototype.cloneNode=function(t){var e=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i({},this.style)});return t&&this.children.forEach((function(n){var r=n.cloneNode(t);e.appendChild(r)})),e},e.prototype.initAttributes=function(t){var e=this;void 0===t&&(t={});var n=this.renderable;for(var r in t){var i=t[r];this.attributes[r]=i,this.parseStyleProperty(r,i)}var o={x:1e3,y:1e3};Object.keys(t).sort((function(t,e){return(o[t]||0)-(o[e]||0)})).forEach((function(t){e.updateStyleProperty(t,void 0,e.parsedStyle[t])})),n.dirty=!0},e.prototype.setAttribute=function(e,n,r){void 0===r&&(r=!1),!r&&dt(n,this.attributes[e])&&"transformOrigin"!==e&&"visibility"!==e||("visibility"===e?this.forEach((function(t){t.changeAttribute(e,n)})):this.changeAttribute(e,n),t.prototype.setAttribute.call(this,e,n))},e.prototype.parseStyleProperty=function(t,e){var n=Wa[t];this.parsedStyle[t]=n?n(e,this):e},e.prototype.updateStyleProperty=function(t,e,n){var r=this,i=za[t];i&&i.forEach((function(t){t(e,n,r,r.sceneGraphService)}))},e.prototype.changeAttribute=function(t,e){var n=this,r=this.renderable,i=this.attributes[t],o=this.parsedStyle[t];this.attributes[t]=e,this.parseStyleProperty(t,e),this.updateStyleProperty(t,o,this.parsedStyle[t]),this.attributes.clipPathTargets&&this.attributes.clipPathTargets.length&&this.attributes.clipPathTargets.forEach((function(t){rn(t),t.emit(ze.ATTRIBUTE_CHANGED,{attributeName:"clipPath",oldValue:n,newValue:n})})),r.dirty=!0,this.emit(ze.ATTRIBUTE_CHANGED,{attributeName:t,oldValue:i,newValue:e})},e.prototype.setOrigin=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.setOrigin(this,Ur(t,e,n)),this.attributes.origin=this.getOrigin(),this},e.prototype.getOrigin=function(){return this.sceneGraphService.getOrigin(this)},e.prototype.setPosition=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.setPosition(this,Ur(t,e,n)),this.syncLocalPosition(),this},e.prototype.setLocalPosition=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.setLocalPosition(this,Ur(t,e,n)),this.syncLocalPosition(),this},e.prototype.translate=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.translate(this,Ur(t,e,n)),this.syncLocalPosition(),this},e.prototype.translateLocal=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.sceneGraphService.translateLocal(this,Ur(t,e,n)),this.syncLocalPosition(),this},e.prototype.getPosition=function(){return this.sceneGraphService.getPosition(this)},e.prototype.getLocalPosition=function(){return this.sceneGraphService.getLocalPosition(this)},e.prototype.scale=function(t,e,n){return this.scaleLocal(t,e,n)},e.prototype.scaleLocal=function(t,e,n){return"number"==typeof t&&(t=Ur(t,e=e||t,n=n||t)),this.sceneGraphService.scaleLocal(this,t),this},e.prototype.setLocalScale=function(t,e,n){return"number"==typeof t&&(t=Ur(t,e=e||t,n=n||t)),this.sceneGraphService.setLocalScale(this,t),this},e.prototype.getLocalScale=function(){return this.sceneGraphService.getLocalScale(this)},e.prototype.getScale=function(){return this.sceneGraphService.getScale(this)},e.prototype.getEulerAngles=function(){var t=l(Wr(xt(),this.sceneGraphService.getWorldTransform(this)),3);return t[0],t[1],Vr(t[2])},e.prototype.getLocalEulerAngles=function(){var t=l(Wr(xt(),this.sceneGraphService.getLocalRotation(this)),3);return t[0],t[1],Vr(t[2])},e.prototype.setEulerAngles=function(t){return this.sceneGraphService.setEulerAngles(this,0,0,t),this},e.prototype.setLocalEulerAngles=function(t){return this.sceneGraphService.setLocalEulerAngles(this,0,0,t),this},e.prototype.rotateLocal=function(t,e,n){return ct(e)&&ct(n)?this.sceneGraphService.rotateLocal(this,0,0,t):this.sceneGraphService.rotateLocal(this,t,e,n),this},e.prototype.rotate=function(t,e,n){return ct(e)&&ct(n)?this.sceneGraphService.rotate(this,0,0,t):this.sceneGraphService.rotate(this,t,e,n),this},e.prototype.getRotation=function(){return this.sceneGraphService.getRotation(this)},e.prototype.getLocalRotation=function(){return this.sceneGraphService.getLocalRotation(this)},e.prototype.getLocalTransform=function(){return this.sceneGraphService.getLocalTransform(this)},e.prototype.getWorldTransform=function(){return this.sceneGraphService.getWorldTransform(this)},e.prototype.resetLocalTransform=function(){this.sceneGraphService.resetLocalTransform(this)},e.prototype.syncLocalPosition=function(){var t=this.getLocalPosition();this.attributes.x=t[0],this.attributes.y=t[1]},e.prototype.getAnimations=function(){return this.activeAnimations},e.prototype.animate=function(t,e){var n,r,i=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return this.attributes.clipPathTargets&&this.attributes.clipPathTargets.length&&(i=null===(r=this.attributes.clipPathTargets[0].ownerDocument)||void 0===r?void 0:r.timeline),this.parsedStyle.transform=void 0,i?i.play(new Fr(this,t,e)):null},e.prototype.show=function(){this.style.visibility="visible"},e.prototype.hide=function(){this.style.visibility="hidden"},e.prototype.isVisible=function(){var t=this.cullable;return"visible"===this.style.visibility&&(!t||t&&!t.isCulled())},e.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,p([],l(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))),!1))+1),this},e.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,p([],l(this.parentNode.children.map((function(t){return Number(t.style.zIndex)}))),!1))-1),this},e.prototype.getCount=function(){return this.childElementCount},e.prototype.getParent=function(){return this.parentElement},e.prototype.getChildren=function(){return this.children},e.prototype.getFirst=function(){return this.firstElementChild},e.prototype.getLast=function(){return this.lastElementChild},e.prototype.getChildByIndex=function(t){return this.children[t]||null},e.prototype.add=function(t,e){return this.appendChild(t,e)},e.prototype.setClip=function(t){this.style.clipPath=t},e.prototype.getClip=function(){return this.style.clipPath||null},e.prototype.set=function(t,e){this.config[t]=e},e.prototype.get=function(t){return this.config[t]},e.prototype.getConfig=function(){return this.config},e.prototype.attr=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=l(e,2),i=r[0],o=r[1];return i?Z(i)?(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),this):2===e.length?(this.setAttribute(i,o),this):this.attributes[i]:this.attributes},e.prototype.moveTo=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.setPosition(t,e,n),this},e.prototype.move=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this.setPosition(t,e,n),this},e.prototype.setZIndex=function(t){return this.style.zIndex=t,this},e.prototype.getMatrix=function(){var t=this.getWorldTransform(),e=l(De(xt(),t),2),n=e[0],r=e[1],i=l(Be(xt(),t),2),o=i[0],a=i[1],s=Le(Te(),t),u=l(Wr(xt(),s),3),c=u[0],h=(u[1],u[2]);return zr(c||h,n,r,o,a)},e.prototype.setMatrix=function(t){var e=t[0],n=t[3],r=t[1],i=t[4],o=Math.sqrt(e*e+n*n),a=Math.sqrt(r*r+i*i);e*i-n*r<0&&(e<i?o=-o:a=-a),o&&(e*=1/o,n*=1/o),a&&(r*=1/a,i*=1/a);var s=Math.atan2(n,e);this.setEulerAngles(s).setPosition(t[6],t[7]).setLocalScale(o,a)},e}(Un),xi=function(t){function e(e){var n=e||{},r=n.style,a=o(n,["style"]);return t.call(this,i({type:on.Group,style:i({},r)},a))||this}return r(e,t),e}(wi),_i=function(t){function e(){var e=t.call(this)||this;return e.defaultView=null,e.ownerDocument=null,e.nodeName="document",e.timeline=new $n,e.documentElement=new xi({id:"g-root"}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return r(e,t),Object.defineProperty(e.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),e.prototype.createElement=function(t,e){return new(this.defaultView.customElements.get(t))(e)},e.prototype.cloneNode=function(t){throw new Error("Method not implemented.")},e.prototype.destroy=function(){try{this.documentElement.destroy()}catch(t){}this.timeline.destroy()},e.prototype.appendChild=function(t,e){throw new Error("Use document.documentElement instead.")},e.prototype.insertBefore=function(t,e){throw new Error("Use document.documentElement instead.")},e.prototype.removeChild=function(t,e){throw new Error("Use document.documentElement instead.")},e.prototype.replaceChild=function(t,e,n){throw new Error("Use document.documentElement instead.")},e.prototype.append=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("Use document.documentElement instead.")},e.prototype.prepend=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("Use document.documentElement instead.")},e.prototype.getElementById=function(t){return this.documentElement.getElementById(t)},e.prototype.getElementsByName=function(t){return this.documentElement.getElementsByName(t)},e.prototype.getElementsByTagName=function(t){return this.documentElement.getElementsByTagName(t)},e.prototype.getElementsByClassName=function(t){return this.documentElement.getElementsByClassName(t)},e.prototype.querySelector=function(t){return this.documentElement.querySelector(t)},e.prototype.querySelectorAll=function(t){return this.documentElement.querySelectorAll(t)},e.prototype.find=function(t){return this.documentElement.find(t)},e.prototype.findAll=function(t){return this.documentElement.findAll(t)},e}(Rn),Pi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.client=new Je,e.movement=new Je,e.offset=new Je,e.global=new Je,e.screen=new Je,e}return r(e,t),Object.defineProperty(e.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),e.prototype.getModifierState=function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)},e.prototype.initMouseEvent=function(){throw new Error("Method not implemented.")},e}(On),Mi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.height=0,e.isPrimary=!1,e}return r(e,t),e.prototype.getCoalescedEvents=function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]},e.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},e}(Pi),Ai=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.DOM_DELTA_LINE=0,e.DOM_DELTA_PAGE=1,e.DOM_DELTA_PIXEL=2,e}return r(e,t),e}(Pi),Si=(r((function(t){var e=Ti.call(this,t)||this;return e.handleMounted=function(t){t.target===t.currentTarget&&e.connectedCallback&&e.connectedCallback()},e.handleUnmounted=function(t){t.target===t.currentTarget&&e.disconnectedCallback&&e.disconnectedCallback()},e.handleAttributeChanged=function(t){if(t.target===e){var n=t.detail,r=n.attributeName,i=n.oldValue,o=n.newValue;e.attributeChangedCallback&&e.attributeChangedCallback(r,i,o)}},e.attributeChangedCallback&&e.addEventListener(ze.ATTRIBUTE_CHANGED,e.handleAttributeChanged),e.connectedCallback&&e.addEventListener(ze.MOUNTED,e.handleMounted),e.disconnectedCallback&&e.addEventListener(ze.UNMOUNTED,e.handleUnmounted),e}),Ti=wi),function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Circle,style:i({r:0,anchor:[.5,.5]},n)},r))||this}return r(e,t),e}(wi)),Ni=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Ellipse,style:i({rx:0,ry:0,anchor:[.5,.5]},n)},r))||this}return r(e,t),e}(wi),Ci=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Image,style:i({img:""},n)},r))||this}return r(e,t),e}(wi),Oi=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Line,style:i({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0,lineJoin:"miter",lineCap:"butt",lineWidth:1},n)},r))||this}return r(e,t),e.prototype.getPoint=function(t){var e=this.parsedStyle,n=e.x1,r=e.y1,i=e.x2,o=e.y2,a=Zr(n,r,i,o,t);return new Je(a.x,a.y)},e.prototype.getTotalLength=function(){var t=this.parsedStyle,e=t.x1,n=t.y1,r=t.x2,i=t.y2;return Jr(e,n,r,i)},e}(wi),Ii=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Path,style:i({path:"",lineJoin:"miter",lineCap:"butt",lineWidth:1},n)},r))||this}return r(e,t),e.prototype.getTotalLength=function(){return this.parsedStyle.path.totalLength},e.prototype.getPoint=function(t){var e=0,n=0,r=this.parsedStyle.path.curve;if(!this.parsedStyle.path.curveSegments.length)return r?new Je(r[0][1],r[0][2]):null;this.parsedStyle.path.curveSegments.forEach((function(r,i){t>=r[0]&&t<=r[1]&&(e=(t-r[0])/(r[1]-r[0]),n=i)}));var i=r[n];if(ct(i)||ct(n))return null;var o=i.length,a=r[n+1],s=pi.pointAt(i[o-2],i[o-1],a[1],a[2],a[3],a[4],a[5],a[6],e),u=s.x,c=s.y;return new Je(u,c)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.path.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?(e.push([n[0]-i[0],n[1]-i[1]]),e.push([n[0],n[1]])):(e.push([r[0],r[1]]),e.push([n[0],n[1]]))}return e},e.prototype.getEndTangent=function(){var t=this.parsedStyle.path.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,o=t[e-1].endTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n},e}(wi),ki=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Polygon,style:i({points:[]},n)},r))||this}return r(e,t),e}(wi),Ri=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Polyline,style:i({points:[],lineJoin:"miter",lineCap:"butt",lineWidth:1},n)},r))||this}return r(e,t),e.prototype.getTotalLength=function(){return this.parsedStyle.points.totalLength},e.prototype.getPoint=function(t){var e=this.parsedStyle.points,n=e.points,r=e.segments,i=0,o=0;r.forEach((function(e,n){t>=e[0]&&t<=e[1]&&(i=(t-e[0])/(e[1]-e[0]),o=n)}));var a=Zr(n[o][0],n[o][1],n[o+1][0],n[o+1][1],i),s=a.x,u=a.y;return new Je(s,u)},e.prototype.getStartTangent=function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e},e.prototype.getEndTangent=function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n},e}(wi),Di=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Rect,style:i({width:0,height:0},n)},r))||this}return r(e,t),e}(wi),Bi=function(t){function e(e){var n=e.style,r=o(e,["style"]);return t.call(this,i({type:on.Text,style:i({text:"",fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"alphabetic",dropShadow:!1,dropShadowDistance:5,fill:"#000",letterSpacing:0,lineHeight:0,lineJoin:"miter",lineCap:"butt",lineWidth:0,miterLimit:10,padding:0,stroke:"#000",whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},n)},r))||this}return r(e,t),e.prototype.getLineBoundingRects=function(){var t;return(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]},e}(wi),Li=function(t){function e(e){var n=e.style,r=o(e,["style"]),a=t.call(this,i({type:on.HTML,style:i({innerHTML:"",className:"",style:""},n)},r))||this;return a.cullable.enable=!1,a}return r(e,t),e.prototype.getDomElement=function(){return this.parsedStyle.$el},e.prototype.getBoundingClientRect=function(){return this.parsedStyle.$el.getBoundingClientRect()},e.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},e.prototype.getBounds=function(){var t,e,n=this.getBoundingClientRect(),r=null===(e=null===(t=this.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(r){var i=n.left-r.left,o=n.top-r.top,a=new Ue;return a.setMinMax(Mt(i,o,0),Mt(i+n.width,o+n.height,0)),a}return null},e.prototype.getLocalBounds=function(){if(this.parentNode){var t=Oe(Se(),this.parentNode.getWorldTransform()),e=this.getBounds();if(e){var n=new Ue;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()},e}(wi),ji=function(){function t(){this.registry={},this.define(on.Circle,Si),this.define(on.Ellipse,Ni),this.define(on.Rect,Di),this.define(on.Image,Ci),this.define(on.Line,Oi),this.define(on.Group,xi),this.define(on.Path,Ii),this.define(on.Polygon,ki),this.define(on.Polyline,Ri),this.define(on.Text,Bi),this.define(on.HTML,Li)}return t.prototype.define=function(t,e){this.registry[t]=e},t.prototype.get=function(t){return this.registry[t]},t}(),Fi=d.defineToken("RenderingPluginContribution"),Gi=function(){function t(){this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Cn.AsyncSeriesHook,prepare:new Cn.SyncWaterfallHook(["object"]),beginFrame:new Cn.SyncHook([]),beforeRender:new Cn.SyncHook(["objectToRender"]),render:new Cn.SyncHook(["objectToRender"]),afterRender:new Cn.SyncHook(["objectToRender"]),endFrame:new Cn.SyncHook([]),destroy:new Cn.SyncHook([]),pick:new Cn.AsyncSeriesWaterfallHook(["result"]),pointerDown:new Cn.SyncHook(["event"]),pointerUp:new Cn.SyncHook(["event"]),pointerMove:new Cn.SyncHook(["event"]),pointerOut:new Cn.SyncHook(["event"]),pointerOver:new Cn.SyncHook(["event"]),pointerWheel:new Cn.SyncHook(["event"])}}return t.prototype.init=function(){return u(this,void 0,void 0,(function(){var t=this;return c(this,(function(e){switch(e.label){case 0:return this.renderingPluginProvider.getContributions({cache:!1}).forEach((function(e){e.apply(t)})),[4,this.hooks.init.promise()];case 1:return e.sent(),this.inited=!0,[2]}}))}))},t.prototype.getStats=function(){return this.stats},t.prototype.render=function(){this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.sceneGraphService.syncHierarchy(this.renderingContext.root),this.renderingContext.renderReasons.size&&this.inited&&(this.renderDisplayObject(this.renderingContext.root),this.renderingContext.dirty?(this.hooks.endFrame.call(),this.renderingContext.dirty=!1):this.renderingContext.renderReasons.has(ln.DisplayObjectRemoved)&&(this.hooks.beginFrame.call(),this.hooks.endFrame.call()),this.renderingContext.renderReasons.clear())},t.prototype.renderDisplayObject=function(t){var e=this,n=this.hooks.prepare.call(t);t.sortable.renderOrder=this.zIndexCounter++,this.stats.total++,n&&(this.stats.rendered++,this.renderingContext.dirty||(this.renderingContext.dirty=!0,this.hooks.beginFrame.call()),this.hooks.beforeRender.call(n),this.hooks.render.call(n),this.hooks.afterRender.call(n),t.renderable.dirty=!1);var r=t.sortable,i=!1;r.dirty&&(r.sorted=t.childNodes.slice().sort(nn),i=!0,r.dirty=!1),(r.sorted||t.childNodes).forEach((function(t){e.renderDisplayObject(t)})),i&&t.forEach((function(t){t.emit(ze.RENDER_ORDER_CHANGED,{renderOrder:t.sortable.renderOrder})}))},t.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call()},t.prototype.dirtify=function(){this.renderingContext.renderReasons.add(ln.DisplayObjectChanged)},a([H(Fi),s("design:type",Object)],t.prototype,"renderingPluginProvider",void 0),a([R(Nn),s("design:type",Object)],t.prototype,"renderingContext",void 0),a([R(sn),s("design:type",Object)],t.prototype,"sceneGraphService",void 0),a([k()],t)}(),Ui=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cursor="default",e.mappingTable={},e.mappingState={trackingData:{}},e.eventPool=new Map,e.onPointerDown=function(t){return u(e,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return t instanceof Mi?[4,this.createPointerEvent(t)]:[2];case 1:return e=r.sent(),this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType?this.dispatchEvent(e,"touchstart"):"mouse"!==e.pointerType&&"pen"!==e.pointerType||(n=2===e.button,this.dispatchEvent(e,n?"rightdown":"mousedown")),this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e),[2]}}))}))},e.onPointerUp=function(t){return u(e,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,h;return c(this,(function(c){switch(c.label){case 0:return t instanceof Mi?(e=performance.now(),[4,this.createPointerEvent(t)]):[2];case 1:if(n=c.sent(),this.dispatchEvent(n,"pointerup"),"touch"===n.pointerType?this.dispatchEvent(n,"touchend"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||(s=2===n.button,this.dispatchEvent(n,s?"rightup":"mouseup")),r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.pressTargetsByButton[t.button]),o=i,i&&!n.composedPath().includes(i)){for(a=i;a&&!n.composedPath().includes(a);)n.currentTarget=a,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||(s=2===n.button,this.notifyTarget(n,s?"rightupoutside":"mouseupoutside")),Rn.isNode(a)&&(a=a.parentNode);delete r.pressTargetsByButton[t.button],o=a}return o&&((u=this.clonePointerEvent(n,"click")).target=o,u.path=[],r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:u.target,timeStamp:e}),(h=r.clicksByButton[t.button]).target===u.target&&e-h.timeStamp<200?++h.clickCount:h.clickCount=1,h.target=u.target,h.timeStamp=e,u.detail=h.clickCount,"mouse"===u.pointerType?this.dispatchEvent(u,"click"):"touch"===u.pointerType?this.dispatchEvent(u,"tap"):this.dispatchEvent(u,"pointertap"),this.freeEvent(u)),this.freeEvent(n),[2]}}))}))},e.onPointerMove=function(t){return u(e,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,h,l,p;return c(this,(function(c){switch(c.label){case 0:return t instanceof Mi?[4,this.createPointerEvent(t)]:[2];case 1:return e=c.sent(),n="mouse"===e.pointerType||"pen"===e.pointerType,r=this.trackingData(t.pointerId),i=this.findMountedTarget(r.overTargets),r.overTargets&&i!==e.target?(o="mousemove"===t.type?"mouseout":"pointerout",[4,this.createPointerEvent(t,o,i||void 0)]):[3,5];case 2:return a=c.sent(),this.dispatchEvent(a,"pointerout"),n&&this.dispatchEvent(a,"mouseout"),e.composedPath().includes(i)?[3,4]:[4,this.createPointerEvent(t,"pointerleave",i||void 0)];case 3:for((s=c.sent()).eventPhase=s.AT_TARGET;s.target&&!e.composedPath().includes(s.target);)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseleave"),Rn.isNode(s.target)&&(s.target=s.target.parentNode);this.freeEvent(s),c.label=4;case 4:this.freeEvent(a),c.label=5;case 5:if(i!==e.target){for(u="mousemove"===t.type?"mouseover":"pointerover",h=this.clonePointerEvent(e,u),this.dispatchEvent(h,"pointerover"),n&&this.dispatchEvent(h,"mouseover"),l=i&&Rn.isNode(i)&&i.parentNode;l&&l!==(Rn.isNode(this.rootTarget)&&this.rootTarget.parentNode)&&l!==e.target;)l=l.parentNode;if(!l||l===(Rn.isNode(this.rootTarget)&&this.rootTarget.parentNode)){for((p=this.clonePointerEvent(e,"pointerenter")).eventPhase=p.AT_TARGET;p.target&&p.target!==i&&p.target!==(Rn.isNode(this.rootTarget)&&this.rootTarget.parentNode);)p.currentTarget=p.target,this.notifyTarget(p),n&&this.notifyTarget(p,"mouseenter"),Rn.isNode(p.target)&&(p.target=p.target.parentNode);this.freeEvent(p)}this.freeEvent(h)}return this.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&this.dispatchEvent(e,"touchmove"),n&&(this.dispatchEvent(e,"mousemove"),this.cursor=this.getCursor(e.target)),r.overTargets=e.composedPath(),this.freeEvent(e),[2]}}))}))},e.onPointerOut=function(t){return u(e,void 0,void 0,(function(){var e,n,r,i,o;return c(this,(function(a){switch(a.label){case 0:return t instanceof Mi?(e=this.trackingData(t.pointerId)).overTargets?(n="mouse"===t.pointerType||"pen"===t.pointerType,r=this.findMountedTarget(e.overTargets),[4,this.createPointerEvent(t,"pointerout",r||void 0)]):[3,3]:[2];case 1:return i=a.sent(),this.dispatchEvent(i),n&&this.dispatchEvent(i,"mouseout"),[4,this.createPointerEvent(t,"pointerleave",r||void 0)];case 2:for((o=a.sent()).eventPhase=o.AT_TARGET;o.target&&o.target!==(Rn.isNode(this.rootTarget)&&this.rootTarget.parentNode);)o.currentTarget=o.target,this.notifyTarget(o),n&&this.notifyTarget(o,"mouseleave"),Rn.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,this.freeEvent(i),this.freeEvent(o),a.label=3;case 3:return this.cursor=null,[2]}}))}))},e.onPointerOver=function(t){return u(e,void 0,void 0,(function(){var e,n,r,i;return c(this,(function(o){switch(o.label){case 0:return t instanceof Mi?(e=this.trackingData(t.pointerId),[4,this.createPointerEvent(t)]):[2];case 1:for(n=o.sent(),r="mouse"===n.pointerType||"pen"===n.pointerType,this.dispatchEvent(n,"pointerover"),r&&this.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(this.cursor=this.getCursor(n.target)),(i=this.clonePointerEvent(n,"pointerenter")).eventPhase=i.AT_TARGET;i.target&&i.target!==(Rn.isNode(this.rootTarget)&&this.rootTarget.parentNode);)i.currentTarget=i.target,this.notifyTarget(i),r&&this.notifyTarget(i,"mouseenter"),Rn.isNode(i.target)&&(i.target=i.target.parentNode);return e.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(i),[2]}}))}))},e.onPointerUpOutside=function(t){return u(e,void 0,void 0,(function(){var e,n,r,i;return c(this,(function(o){switch(o.label){case 0:return t instanceof Mi?(e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),[4,this.createPointerEvent(t)]):[2];case 1:if(r=o.sent(),n){for(i=n;i;)r.currentTarget=i,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType?this.notifyTarget(r,"touchendoutside"):"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.notifyTarget(r,2===r.button?"rightupoutside":"mouseupoutside"),Rn.isNode(i)&&(i=i.parentNode);delete e.pressTargetsByButton[t.button]}return this.freeEvent(r),[2]}}))}))},e.onWheel=function(t){return u(e,void 0,void 0,(function(){var e;return c(this,(function(n){switch(n.label){case 0:return t instanceof Ai?[4,this.createWheelEvent(t)]:[2];case 1:return e=n.sent(),this.dispatchEvent(e),this.freeEvent(e),[2]}}))}))},e}return r(e,t),e.prototype.init=function(){this.rootTarget=this.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)},e.prototype.client2Viewport=function(t){var e=this.contextService.getBoundingClientRect();return new Je(t.x-((null==e?void 0:e.left)||0),t.y-((null==e?void 0:e.top)||0))},e.prototype.viewport2Client=function(t){var e=this.contextService.getBoundingClientRect();return new Je(t.x+((null==e?void 0:e.left)||0),t.y+((null==e?void 0:e.top)||0))},e.prototype.viewport2Canvas=function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.canvasConfig,o=i.width,a=i.height,s=r.getPerspectiveInverse(),u=r.getWorldTransform(),c=Ie(Se(),u,s),h=Mt(e/o*2-1,2*(1-n/a)-1,0);return Zt(h,h,c),new Je(h[0],h[1])},e.prototype.canvas2Viewport=function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=Ie(Se(),n,r),o=Mt(t.x,t.y,0);Zt(o,o,i);var a=this.canvasConfig,s=a.width,u=a.height;return new Je((o[0]+1)/2*s,(1-(o[1]+1)/2)*u)},e.prototype.setPickHandler=function(t){this.pickHandler=t},e.prototype.addEventMapping=function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((function(t,e){return t.priority-e.priority}))},e.prototype.mapEvent=function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for "+t.type)}},e.prototype.dispatchEvent=function(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.emit(e||t.type,t)},e.prototype.propagate=function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped)for(t.eventPhase=t.BUBBLING_PHASE,r=1;r<n.length;r++)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}},e.prototype.propagationPath=function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)Rn.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e},e.prototype.hitTest=function(t){return u(this,void 0,void 0,(function(){var e,n,r,i,o;return c(this,(function(a){switch(a.label){case 0:return e=t.viewportX,n=t.viewportY,r=this.canvasConfig,i=r.width,o=r.height,e<0||n<0||e>i||n>o?[2,null]:[4,this.pickHandler(t)];case 1:return[2,a.sent()||this.rootTarget||null]}}))}))},e.prototype.createPointerEvent=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o;return c(this,(function(a){switch(a.label){case 0:return r=this.allocateEvent(Mi),this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r._originalEvent=t,i=r,null==n?[3,1]:(o=n,[3,3]);case 1:return[4,this.hitTest({clientX:r.clientX,clientY:r.clientY,viewportX:r.viewportX,viewportY:r.viewportY,x:r.global.x,y:r.global.y})];case 2:o=a.sent(),a.label=3;case 3:return i.target=o,"string"==typeof e&&(r.type=e),[2,r]}}))}))},e.prototype.createWheelEvent=function(t){return u(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:return e=this.allocateEvent(Ai),this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e._originalEvent=t,n=e,[4,this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.global.x,y:e.global.y})];case 1:return n.target=r.sent(),[2,e]}}))}))},e.prototype.trackingData=function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]},e.prototype.clonePointerEvent=function(t,e){var n=this.allocateEvent(Mi);return n.nativeEvent=t.nativeEvent,n._originalEvent=t._originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n},e.prototype.copyPointerData=function(t,e){t instanceof Mi&&e instanceof Mi&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)},e.prototype.copyMouseData=function(t,e){t instanceof Pi&&e instanceof Pi&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset))},e.prototype.copyWheelData=function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ},e.prototype.copyData=function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)},e.prototype.allocateEvent=function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e},e.prototype.freeEvent=function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)},e.prototype.notifyTarget=function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?e+"capture":e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)},e.prototype.notifyListeners=function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r)if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,t)},e.prototype.findMountedTarget=function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(!(r===this.rootTarget||Rn.isNode(r)&&r.parentNode===e))break;e=t[n]}return e},e.prototype.getCursor=function(t){for(var e=t;e;){var n=Un.isElement(e)&&e.getAttribute("cursor");if(n)return n;e=Rn.isNode(e)&&e.parentNode}},a([R(Nn),s("design:type",Object)],e.prototype,"renderingContext",void 0),a([R(An),s("design:type",Object)],e.prototype,"contextService",void 0),a([R(pn),s("design:type",Object)],e.prototype,"canvasConfig",void 0),a([(0,v.zY)(),s("design:type",Function),s("design:paramtypes",[]),s("design:returntype",void 0)],e.prototype,"init",null),a([k()],e)}(q.EventEmitter);function Vi(e,n,r){var i=r.getGeometryBounds();if(i){var o=r.geometry;if(o&&o.contentBounds){var a=Ot(xt(),Mt.apply(t,p([],l(i.halfExtents.map((function(t){return 2*t}))),!1)),Ct(xt(),Ur(n||xt()),Ur(e||xt())));o.contentBounds.update(Ct(o.contentBounds.center,o.contentBounds.center,a),o.contentBounds.halfExtents),o.renderBounds.update(Ct(o.renderBounds.center,o.renderBounds.center,a),o.renderBounds.halfExtents),rn(r)}}}function Wi(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function zi(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Hi(){}var qi,Yi=.7,Xi=1/Yi,$i="\\s*([+-]?\\d+)\\s*",Ki="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ji="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zi=/^#([0-9a-f]{3,8})$/,Qi=new RegExp("^rgb\\("+[$i,$i,$i]+"\\)$"),to=new RegExp("^rgb\\("+[Ji,Ji,Ji]+"\\)$"),eo=new RegExp("^rgba\\("+[$i,$i,$i,Ki]+"\\)$"),no=new RegExp("^rgba\\("+[Ji,Ji,Ji,Ki]+"\\)$"),ro=new RegExp("^hsl\\("+[Ki,Ji,Ji]+"\\)$"),io=new RegExp("^hsla\\("+[Ki,Ji,Ji,Ki]+"\\)$"),oo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ao(){return this.rgb().formatHex()}function so(){return this.rgb().formatRgb()}function uo(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Zi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?co(e):3===n?new po(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ho(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ho(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Qi.exec(t))?new po(e[1],e[2],e[3],1):(e=to.exec(t))?new po(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=eo.exec(t))?ho(e[1],e[2],e[3],e[4]):(e=no.exec(t))?ho(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ro.exec(t))?go(e[1],e[2]/100,e[3]/100,1):(e=io.exec(t))?go(e[1],e[2]/100,e[3]/100,e[4]):oo.hasOwnProperty(t)?co(oo[t]):"transparent"===t?new po(NaN,NaN,NaN,0):null}function co(t){return new po(t>>16&255,t>>8&255,255&t,1)}function ho(t,e,n,r){return r<=0&&(t=e=n=NaN),new po(t,e,n,r)}function lo(t){return t instanceof Hi||(t=uo(t)),t?new po((t=t.rgb()).r,t.g,t.b,t.opacity):new po}function po(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function fo(){return"#"+vo(this.r)+vo(this.g)+vo(this.b)}function yo(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function vo(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function go(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new bo(t,e,n,r)}function mo(t){if(t instanceof bo)return new bo(t.h,t.s,t.l,t.opacity);if(t instanceof Hi||(t=uo(t)),!t)return new bo;if(t instanceof bo)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new bo(a,s,u,t.opacity)}function bo(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function To(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Wi(Hi,uo,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:ao,formatHex:ao,formatHsl:function(){return mo(this).formatHsl()},formatRgb:so,toString:so}),Wi(po,(function(t,e,n,r){return 1===arguments.length?lo(t):new po(t,e,n,null==r?1:r)}),zi(Hi,{brighter:function(t){return t=null==t?Xi:Math.pow(Xi,t),new po(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?Yi:Math.pow(Yi,t),new po(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fo,formatHex:fo,formatRgb:yo,toString:yo})),Wi(bo,(function(t,e,n,r){return 1===arguments.length?mo(t):new bo(t,e,n,null==r?1:r)}),zi(Hi,{brighter:function(t){return t=null==t?Xi:Math.pow(Xi,t),new bo(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?Yi:Math.pow(Yi,t),new bo(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new po(To(t>=240?t-240:t+120,i,r),To(t,i,r),To(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}})),function(t){t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t[t.Pattern=3]="Pattern"}(qi||(qi={}));var Eo=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,wo=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,xo=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,_o=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function Po(t){if(void 0===t&&(t=""),"transparent"===t)return{type:qi.Constant,value:[0,0,0,0],formatted:"rgba(0,0,0,0)"};var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=function(t){var e,n=Eo.exec(t);if(n){var r=parseFloat(n[1])%360*(Math.PI/180),i=(null===(e=n[2].match(_o))||void 0===e?void 0:e.map((function(t){return t.split(":")})))||[],o=l([1,1],2),a=o[0],s=o[1],u=l([0,0],2),c=u[0],h=u[1],p=void 0,f=void 0;r>=0&&r<.5*Math.PI?(p={x:c,y:h},f={x:a,y:s}):.5*Math.PI<=r&&r<Math.PI?(p={x:a,y:h},f={x:c,y:s}):Math.PI<=r&&r<1.5*Math.PI?(p={x:a,y:s},f={x:c,y:h}):(p={x:c,y:s},f={x:a,y:h});var d=Math.tan(r),y=d*d,v=(f.x-p.x+d*(f.y-p.y))/(y+1)+p.x,g=d*(f.x-p.x+d*(f.y-p.y))/(y+1)+p.y;return{x0:p.x,y0:p.y,x1:v,y1:g,steps:i,hash:t}}return null}(t);if(n)return{type:qi.LinearGradient,value:n,formatted:""}}else if("r"===e){var r=function(t){var e,n=wo.exec(t);if(n){var r=parseFloat(n[1]),i=parseFloat(n[2]),o=parseFloat(n[3]),a=(null===(e=n[4].match(_o))||void 0===e?void 0:e.map((function(t){return t.split(":")})))||[];if(0===o){var s=n[4].match(_o);return s[s.length-1].split(":")[1]}return{x0:r,y0:i,r0:0,x1:.5,y1:.5,r1:o,steps:a,hash:t}}return null}(t);if(r){if(!rt(r))return{type:qi.RadialGradient,value:r,formatted:""};t=r}}else if("p"===e){var i=function(t){var e=xo.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{src:r,repetition:n,hash:t}}return null}(t);if(i)return{type:qi.Pattern,value:i,formatted:""}}var o=uo(t),a=[0,0,0,0];return null!==o&&(a[0]=o.r/255,a[1]=o.g/255,a[2]=o.b/255,a[3]=o.opacity),{type:qi.Constant,value:a,formatted:o&&"rgba("+o.r+","+o.g+","+o.b+","+o.opacity+")"||"rgba(0,0,0,0)"}}function Mo(t,e){if(t.type===qi.Constant&&e.type===qi.Constant)return[t.value,e.value,function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(it(255*e[n],0,255));return e[3]=it(e[3],0,1),"rgba("+e.join(",")+")"}]}function Ao(t,e,n){var r=Va.get(cn)(n.nodeName);if(r){var i=n.geometry;i.contentBounds||(i.contentBounds=new Ue),i.renderBounds||(i.renderBounds=new Ue);var o=r.update(n.parsedStyle,n),a=o.width,s=o.height,u=o.depth,c=void 0===u?0:u,h=o.x,l=void 0===h?0:h,p=o.y,f=void 0===p?0:p,d=o.offsetX,y=void 0===d?0:d,v=o.offsetY,g=void 0===v?0:v,m=o.offsetZ,b=void 0===m?0:m;n.parsedStyle.width=a,n.parsedStyle.height=s,n.parsedStyle.depth=c,n.nodeName===on.Line||n.nodeName===on.Polyline||n.nodeName===on.Polygon||n.nodeName===on.Path?(n.parsedStyle.offsetX=l-(n.parsedStyle.defX||0),n.parsedStyle.offsetY=f-(n.parsedStyle.defY||0),n.parsedStyle.defX=l,n.parsedStyle.defY=f,n.translateLocal(n.parsedStyle.offsetX,n.parsedStyle.offsetY),n.parsedStyle.x=n.style.x,n.parsedStyle.y=n.style.y):(n.parsedStyle.x=l,n.parsedStyle.y=f);var T=Mt(a/2,s/2,c/2),E=n.parsedStyle,w=E.lineWidth,x=void 0===w?0:w,_=E.anchor,P=void 0===_?[0,0]:_,M=E.shadowColor,A=E.filter,S=void 0===A?[]:A;n.nodeName===on.Text&&delete n.parsedStyle.anchor;var N=Mt((1-2*P[0])*T[0]+y,(1-2*P[1])*T[1]+g,(1-2*(P[2]||0))*T[2]+b);if(i.contentBounds.update(N,T),x&&Nt(T,T,Mt(x/2,x/2,0)),i.renderBounds.update(N,T),M&&M.type===qi.Constant){var C=i.renderBounds,O=C.min,I=C.max,k=n.parsedStyle,R=k.shadowBlur,D=void 0===R?0:R,B=k.shadowOffsetX,L=void 0===B?0:B,j=k.shadowOffsetY,F=void 0===j?0:j,G=O[0]-D+L,U=I[0]+D+L,V=O[1]-D+F,W=I[1]+D+F;O[0]=Math.min(O[0],G),I[0]=Math.max(I[0],U),O[1]=Math.min(O[1],V),I[1]=Math.max(I[1],W),i.renderBounds.setMinMax(O,I)}S.forEach((function(t){var e=t.name,n=t.params;if("blur"===e){var r=n[0].value;i.renderBounds.update(i.renderBounds.center,Nt(i.renderBounds.halfExtents,i.renderBounds.halfExtents,Mt(r,r,0)))}else if("drop-shadow"===e){var o=n[0].value,a=n[1].value,s=n[2].value,u=i.renderBounds,c=u.min,h=u.max,l=c[0]-s+o,p=h[0]+s+o,f=c[1]-s+a,d=h[1]+s+a;c[0]=Math.min(c[0],l),h[0]=Math.max(h[0],p),c[1]=Math.min(c[1],f),h[1]=Math.max(h[1],d),i.renderBounds.setMinMax(c,h)}})),rn(n)}}function So(t,e,n){var r=n.parsedStyle,i=r.x,o=void 0===i?0:i,a=r.y,s=void 0===a?0:a,u=r.z,c=void 0===u?0:u;n.setLocalPosition(o,s,c)}function No(t){return t.toFixed(3).replace(/0+$/,"").replace(/\.$/,"")}function Co(t){return"number"==typeof t?t:/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?Number(t):0}function Oo(t,e){return[t,e,No]}function Io(t,e){return function(n,r){return[n,r,function(n){return No(it(n,t,e))}]}}function ko(t,e){if(t.length==e.length)return[t,e,function(t){return t}]}function Ro(t,e,n){if(t&&t!==e&&t.style.offsetPathTargets){var r=t.style.offsetPathTargets.indexOf(n);t.style.offsetPathTargets.splice(r,1)}e&&(e.style.offsetPathTargets||(e.style.offsetPathTargets=[]),e.style.offsetPathTargets.push(n))}function Do(t,e,n){if(n.attributes.offsetPath){var r=n.attributes.offsetPath.nodeName;if(r===on.Line||r===on.Path||r===on.Polyline){var i=n.attributes.offsetPath.getPoint(e);i&&n.setLocalPosition(i.x,i.y)}}}function Bo(t,e,n){if(t&&t!==e&&t.style.clipPathTargets){var r=t.style.clipPathTargets.indexOf(n);t.style.clipPathTargets.splice(r,1)}e&&(e.style.clipPathTargets||(e.style.clipPathTargets=[]),e.style.clipPathTargets.push(n)),rn(n)}function Lo(t,e,n){if(n.parentNode){var r=n.parentNode,i=r.renderable,o=r.sortable;i&&(i.dirty=!0),o&&(o.dirty=!0)}}function jo(t){return"px"===t||"%"===t}function Fo(t){return"deg"===t||"rad"===t||"turn"===t}function Go(t,e){if("0"===(e=e.trim().toLowerCase())){if("px".search(t)>=0)return{unit:"px",value:0};if("%".search(t)>=0)return{unit:"%",value:0}}if(n=Number(e),ot(n)&&isFinite(n))return{unit:"",value:Number(e)};var n,r=[];e=e.replace(t,(function(t){return r.push(t),"U"+t}));var i="U("+t.source+")";return r.map((function(t){return{unit:t,value:Number(e.replace(new RegExp("U"+t,"g"),"").replace(new RegExp(i,"g"),"*0"))}}))[0]}function Uo(t,e,n,r,i){void 0===r&&(r=null),void 0===i&&(i=0);var o=t.unit,a=t.value||0,s=e.value||0;return(jo(t.unit)||jo(e.unit))&&(a=Ho(t,i,r),s=Ho(e,i,r),o="px"),(Fo(t.unit)||Fo(e.unit))&&(a=qo(t),s=qo(e),o="deg"),[a,s,function(t){return n&&(t=Math.max(t,0)),No(t)+o}]}var Vo=Go.bind(null,new RegExp("px","g")),Wo=Go.bind(null,new RegExp("px|%","g")),zo=Go.bind(null,/deg|rad|grad|turn/g);function Ho(t,e,n){if("px"===t.unit)return Number(t.value);if("%"===t.unit&&n){var r=n.getBounds(),i=0;return r&&(i=2*r.halfExtents[e]),Number(t.value)/100*i}return 0}function qo(t){var e=0;return"deg"===t.unit?e=Number(t.value):"rad"===t.unit?e=Vr(Number(t.value)):"turn"===t.unit&&(e=360*Number(t.value)),e}function Yo(t,e,n){n.setOrigin(e[0],e[1],e[2])}function Xo(t,e,n){var r,i,o=e.split(" ");if(1===o.length&&("top"===o[0]||"bottom"===o[0]?(o[1]=o[0],o[0]="center"):o[1]="center"),2===o.length){var a=Wo($o(o[0])),s=Wo($o(o[1]));a&&(r=Ho(a,0,n)),s&&(i=Ho(s,1,n))}ct(r)||ct(i)||n.setOrigin([r,i])}function $o(t){return"center"===t?"50%":"left"===t||"top"===t?"0":"right"===t||"bottom"===t?"100%":t}var Ko=null,Jo={unit:"px",value:0},Zo={unit:"deg",value:0};function Qo(t){return function(e){var n=0;return t.map((function(t){return t===Ko?e[n++]:t}))}}function ta(t){return t}var ea={rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],scale:["Nn",Qo([Ko,Ko,1]),ta],scalex:["N",Qo([Ko,1,1]),Qo([Ko,1])],scaley:["N",Qo([1,Ko,1]),Qo([1,Ko])],scalez:["N",Qo([1,1,Ko])],scale3d:["NNN",ta],translate:["Tt",Qo([Ko,Ko,Jo]),ta],translatex:["T",Qo([Ko,Jo,Jo]),Qo([Ko,Jo])],translatey:["T",Qo([Jo,Ko,Jo]),Qo([Jo,Ko])],translatez:["L",Qo([Jo,Jo,Ko])],translate3d:["TTL",ta]};function na(t){if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*(\w+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];i=e.index+e[0].length;var o=e[1],a=ea[o];if(!a)return[];var s=e[2].split(","),u=a[0];if(u.length<s.length)return[];for(var c=[],h=0;h<u.length;h++){var l,p=s[h],f=u[h];if(void 0===(l=p?{A:function(t){return"0"===t.trim()?Zo:zo(t)},N:Co,T:Wo,L:Vo}[f.toUpperCase()](p):{a:Zo,n:c[0],t:Jo}[f]))return[];c.push(l)}if(r.push({t:o,d:c}),n.lastIndex===t.length)return r}return[]}function ra(t){return t.replace(/[xy]/,"")}function ia(t){return t.replace(/(x|y|z|3d)?$/,"3d")}function oa(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=function(n){var r=t[n],i=r.t,o=r.d,a="scale"===i.substr(0,5)?1:0;e.push({t:i,d:o.map((function(t){return"number"==typeof t?a:{unit:t.unit,value:a}}))})},o=0;o<t.length;o++)i(o)}var a,s,u=[],c=[],h=[];if(t.length!==e.length);else for(o=0;o<t.length;o++){var l=t[o].t,p=e[o].t,f=t[o].d,d=e[o].d,y=ea[l],v=ea[p],g=void 0;if(s=p,("perspective"!==(a=l)||"perspective"!==s)&&("matrix"!==a&&"matrix3d"!==a||"matrix"!==s&&"matrix3d"!==s)){if(l===p)g=l;else if(y[2]&&v[2]&&ra(l)===ra(p))g=ra(l),f=y[2](f),d=v[2](d);else{if(!y[1]||!v[1]||ia(l)!==ia(p))break;g=ia(l),f=y[1](f),d=v[1](d)}for(var m=[],b=[],T=[],E=0;E<f.length;E++){var w=("number"==typeof f[E]?Oo:Uo)(f[E],d[E],!1,n,E);m[E]=w[0],b[E]=w[1],T.push(w[2])}u.push(m),c.push(b),h.push([g,T])}}if(r){var x=u;u=c,c=x}return[u,c,function(t){return t.map((function(t,e){var n=t.map((function(t,n){return h[e][1][n](t)})).join(",");return"matrix"===h[e][0]&&16===n.split(",").length&&(h[e][0]="matrix3d"),h[e][0]+"("+n+")"})).join(" ")}]}function aa(t,e,n){var r=function(t,e){void 0===e&&(e=new Map);var n=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var o=t[r];e.has(o)||(n.push(o),e.set(o,!0))}return n}(p(p([],l((t||[]).map((function(t){return t.t}))),!1),l((e||[]).map((function(t){return t.t}))),!1));r.forEach((function(r){var i=(e||[]).find((function(t){return t.t===r})),o=(t||[]).find((function(t){return t.t===r}));if("scale"===r){var a=i&&i.d||[1,1],s=o&&o.d||[1,1];n.scaleLocal(a[0]/s[0],a[1]/s[1],1)}else if("scalex"===r)a=i&&i.d||[1],s=o&&o.d||[1],n.scaleLocal(a[0]/s[0],1,1);else if("scaley"===r)a=i&&i.d||[1],s=o&&o.d||[1],n.scaleLocal(1,a[0]/s[0],1);else if("scalez"===r)a=i&&i.d||[1],s=o&&o.d||[1],n.scaleLocal(1,1,a[0]/s[0]);else if("scale3d"===r)a=i&&i.d||[1,1,1],s=o&&o.d||[1,1,1],n.scaleLocal(a[0]/s[0],a[1]/s[1],a[2]/s[2]);else if("translate"===r){var u=i&&i.d||[Jo,Jo],c=o&&o.d||[Jo,Jo];n.translateLocal(u[0].value-c[0].value,u[1].value-c[1].value,0)}else if("translatex"===r)u=i&&i.d||[Jo],c=o&&o.d||[Jo],n.translateLocal(u[0].value-c[0].value,0,0);else if("translatey"===r)u=i&&i.d||[Jo],c=o&&o.d||[Jo],n.translateLocal(0,u[0].value-c[0].value,0);else if("translatez"===r)u=i&&i.d||[Jo],c=o&&o.d||[Jo],n.translateLocal(0,0,u[0].value-c[0].value);else if("translate3d"===r)u=i&&i.d||[Jo,Jo,Jo],c=o&&o.d||[Jo,Jo,Jo],n.translateLocal(u[0].value-c[0].value,u[1].value-c[1].value,u[2].value-c[2].value);else if("rotate"===r){var h=i&&i.d||[Zo],l=o&&o.d||[Zo];n.rotateLocal(0,0,h[0].value-l[0].value)}else"rotatex"===r?(h=i&&i.d||[Zo],l=o&&o.d||[Zo],n.rotateLocal(h[0].value-l[0].value,0,0)):"rotatey"===r?(h=i&&i.d||[Zo],l=o&&o.d||[Zo],n.rotateLocal(0,h[0].value-l[0].value,0)):"rotatez"===r&&(h=i&&i.d||[Zo],l=o&&o.d||[Zo],n.rotateLocal(0,0,h[0].value-l[0].value))}))}var sa=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,ua=/[^\s\,]+/gi;var ca="\t\n\v\f\r \u2028\u2029",ha=new RegExp("([a-z])["+ca+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+ca+"]*,?["+ca+"]*)+)","ig"),la=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+ca+"]*,?["+ca+"]*","ig"),pa=/[a-z]/;function fa(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}function da(t){var e=function(t){if(!t)return null;if(J(t))return t;var e={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},n=[];return String(t).replace(ha,(function(t,r,i){var o=[],a=r.toLowerCase();if(i.replace(la,(function(t,e){e&&o.push(+e)})),"m"===a&&o.length>2&&(n.push([r].concat(o.splice(0,2))),a="l",r="m"===r?"l":"L"),"o"===a&&1===o.length&&n.push([r,o[0]]),"r"===a)n.push([r].concat(o));else for(;o.length>=e[a]&&(n.push([r].concat(o.splice(0,e[a]))),e[a]););return""})),n}(t);if(!e||!e.length)return[["M",0,0]];for(var n=!1,r=0;r<e.length;r++){var i=e[r][0];if(pa.test(i)||["V","H","T","S"].indexOf(i)>=0){n=!0;break}}if(!n)return e;var o=[],a=0,s=0,u=0,c=0,h=0,l=e[0];"M"!==l[0]&&"m"!==l[0]||(u=a=+l[1],c=s=+l[2],h++,o[0]=["M",a,s]),r=h;for(var p=e.length;r<p;r++){var f=e[r],d=o[r-1],y=[],v=(i=f[0]).toUpperCase();if(i!==v)switch(y[0]=v,v){case"A":y[1]=f[1],y[2]=f[2],y[3]=f[3],y[4]=f[4],y[5]=f[5],y[6]=+f[6]+a,y[7]=+f[7]+s;break;case"V":y[1]=+f[1]+s;break;case"H":y[1]=+f[1]+a;break;case"M":u=+f[1]+a,c=+f[2]+s,y[1]=u,y[2]=c;break;default:for(var g=1,m=f.length;g<m;g++)y[g]=+f[g]+(g%2?a:s)}else y=e[r];switch(v){case"Z":a=+u,s=+c;break;case"H":y=["L",a=y[1],s];break;case"V":y=["L",a,s=y[1]];break;case"T":a=y[1],s=y[2];var b=fa([d[1],d[2]],[d[3],d[4]]);y=["Q",b[0],b[1],a,s];break;case"S":a=y[y.length-2],s=y[y.length-1];var T=d.length,E=fa([d[T-4],d[T-3]],[d[T-2],d[T-1]]);y=["C",E[0],E[1],y[1],y[2],a,s];break;case"M":u=y[y.length-2],c=y[y.length-1];break;default:a=y[y.length-2],s=y[y.length-1]}o.push(y)}return o}var ya=2*Math.PI,va=function(t,e,n,r,i,o,a){var s=t.x,u=t.y;return{x:r*(s*=e)-i*(u*=n)+o,y:i*s+r*u+a}},ga=function(t,e){var n=1.5707963267948966===e?.551915024494:-1.5707963267948966===e?-.551915024494:4/3*Math.tan(e/4),r=Math.cos(t),i=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:r-i*n,y:i+r*n},{x:o+a*n,y:a-o*n},{x:o,y:a}]},ma=function(t,e,n,r){var i=t*n+e*r;return i>1&&(i=1),i<-1&&(i=-1),(t*r-e*n<0?-1:1)*Math.acos(i)};function ba(t,e,n,r,i,o,a,s,u){return function(t){var e=t.px,n=t.py,r=t.cx,i=t.cy,o=t.rx,a=t.ry,s=t.xAxisRotation,u=void 0===s?0:s,c=t.largeArcFlag,h=void 0===c?0:c,l=t.sweepFlag,p=void 0===l?0:l,f=[];if(0===o||0===a)return[{x1:0,y1:0,x2:0,y2:0,x:r,y:i}];var d=Math.sin(u*ya/360),y=Math.cos(u*ya/360),v=y*(e-r)/2+d*(n-i)/2,g=-d*(e-r)/2+y*(n-i)/2;if(0===v&&0===g)return[{x1:0,y1:0,x2:0,y2:0,x:r,y:i}];o=Math.abs(o),a=Math.abs(a);var m=Math.pow(v,2)/Math.pow(o,2)+Math.pow(g,2)/Math.pow(a,2);m>1&&(o*=Math.sqrt(m),a*=Math.sqrt(m));var b=function(t,e,n,r,i,o,a,s,u,c,h,l){var p=Math.pow(i,2),f=Math.pow(o,2),d=Math.pow(h,2),y=Math.pow(l,2),v=p*f-p*y-f*d;v<0&&(v=0),v/=p*y+f*d;var g=(v=Math.sqrt(v)*(a===s?-1:1))*i/o*l,m=v*-o/i*h,b=c*g-u*m+(t+n)/2,T=u*g+c*m+(e+r)/2,E=(h-g)/i,w=(l-m)/o,x=(-h-g)/i,_=(-l-m)/o,P=ma(1,0,E,w),M=ma(E,w,x,_);return 0===s&&M>0&&(M-=ya),1===s&&M<0&&(M+=ya),[b,T,P,M]}(e,n,r,i,o,a,h,p,d,y,v,g),T=b[0],E=b[1],w=b[2],x=b[3],_=Math.abs(x)/(ya/4);Math.abs(1-_)<1e-7&&(_=1);var P=Math.max(Math.ceil(_),1);x/=P;for(var M=0;M<P;M++)f.push(ga(w,x)),w+=x;return f.map((function(t){var e=va(t[0],o,a,y,d,T,E),n=e.x,r=e.y,i=va(t[1],o,a,y,d,T,E),s=i.x,u=i.y,c=va(t[2],o,a,y,d,T,E);return{x1:n,y1:r,x2:s,y2:u,x:c.x,y:c.y}}))}({px:t,py:e,cx:s,cy:u,rx:n,ry:r,xAxisRotation:i,largeArcFlag:o,sweepFlag:a}).reduce((function(t,e){var n=e.x1,r=e.y1,i=e.x2,o=e.y2,a=e.x,s=e.y;return t.push(n,r,i,o,a,s),t}),[])}function Ta(t,e,n,r,i,o){var a=1/3,s=2/3;return[a*t+s*n,a*e+s*r,a*i+s*n,a*o+s*r,i,o]}function Ea(t,e,n,r){return[t,e,n,r,n,r]}function wa(t,e){"TQ".indexOf(t[0])<0&&(e.qx=null,e.qy=null);var n=t.slice(1),r=n[0],i=n[1];switch(t[0]){case"M":return e.x=r,e.y=i,t;case"A":return["C"].concat(ba.apply(0,[e.x1,e.y1].concat(t.slice(1))));case"Q":return e.qx=r,e.qy=i,["C"].concat(Ta.apply(0,[e.x1,e.y1].concat(t.slice(1))));case"L":return["C"].concat(Ea(e.x1,e.y1,t[1],t[2]));case"H":return["C"].concat(Ea(e.x1,e.y1,t[1],e.y1));case"V":return["C"].concat(Ea(e.x1,e.y1,e.x1,t[1]));case"Z":return["C"].concat(Ea(e.x1,e.y1,e.x,e.y))}return t}function xa(t,e,n){if(t[n].length>7){t[n].shift();for(var r=t[n],i=n;r.length;)e[n]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1)}}function _a(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Pa(t,e){return _a(t)*_a(e)?(t[0]*e[0]+t[1]*e[1])/(_a(t)*_a(e)):1}function Ma(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Pa(t,e))}function Aa(t,e){return t[0]===e[0]&&t[1]===e[1]}function Sa(t,e){var n,r,i,o=e[1],a=e[2],s=(i=e[3],n=at*i,r=2*Math.PI,(n%r+r)%r),u=e[4],c=e[5],h=t[0],l=t[1],p=e[6],f=e[7],d=Math.cos(s)*(h-p)/2+Math.sin(s)*(l-f)/2,y=-1*Math.sin(s)*(h-p)/2+Math.cos(s)*(l-f)/2,v=d*d/(o*o)+y*y/(a*a);v>1&&(o*=Math.sqrt(v),a*=Math.sqrt(v));var g=o*o*(y*y)+a*a*(d*d),m=g?Math.sqrt((o*o*(a*a)-g)/g):1;u===c&&(m*=-1),isNaN(m)&&(m=0);var b=a?m*o*y/a:0,T=o?m*-a*d/o:0,E=(h+p)/2+Math.cos(s)*b-Math.sin(s)*T,w=(l+f)/2+Math.sin(s)*b+Math.cos(s)*T,x=[(d-b)/o,(y-T)/a],_=[(-1*d-b)/o,(-1*y-T)/a],P=Ma([1,0],x),M=Ma(x,_);return Pa(x,_)<=-1&&(M=Math.PI),Pa(x,_)>=1&&(M=0),0===c&&M>0&&(M-=2*Math.PI),1===c&&M<0&&(M+=2*Math.PI),{cx:E,cy:w,rx:Aa(t,[p,f])?0:o,ry:Aa(t,[p,f])?0:a,startAngle:P,endAngle:P+M,xRotation:s,arcFlag:u,sweepFlag:c}}function Na(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}var Ca=function(){function t(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r,this.left=t,this.right=t+n,this.top=e,this.bottom=e+r,this.width=n,this.height=r,this.x=t,this.y=e}return t.prototype.toJSON=function(){},t}();function Oa(t){var e=da(t),n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break}}return e}(e),r=e.slice(),i=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var o=t[i],a=o[0];"M"===a?(r.length&&(n.push(r),r=[]),r.push([o[1],o[2]])):"Z"===a?r.length&&(e.push(r),r=[]):r.push([o[1],o[2]])}return r.length>0&&n.push(r),{polygons:e,polylines:n}}(r),o=i.polygons,a=i.polylines,s=l(function(t,e){void 0===e&&(e=!1);for(var n,r,i=da(t),o={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},a=[],s="",u=i.length,c=[],h=0;h<u;h+=1)i[h]&&(s=i[h][0]),a[h]=s,i[h]=wa(i[h],o),xa(i,a,h),u=i.length,"Z"===s&&c.push(h),r=(n=i[h]).length,o.x1=+n[r-2],o.y1=+n[r-1],o.x2=+n[r-4]||o.x1,o.y2=+n[r-3]||o.y1;return e?[i,c]:i}(r,!0),2),u=s[0],c=s[1],h=function(t){for(var e=[],n=null,r=null,i=null,o=0,a=(t=function(t){var e=t||[];return J(e)?e:rt(e)?(e=e.match(sa),Q(e,(function(t,n){if((t=t.match(ua))[0].length>1){var r=t[0].charAt(0);t.splice(1,0,t[0].substr(1)),t[0]=r}Q(t,(function(e,n){isNaN(e)||(t[n]=+e)})),e[n]=t})),e):void 0}(t)).length,s=0;s<a;s++){var u=t[s];r=t[s+1];var c=u[0],h={command:c,prePoint:n,params:u,startTangent:null,endTangent:null};switch(c){case"M":i=[u[1],u[2]],o=s;break;case"A":var l=Sa(n,u);h.arcParams=l}if("Z"===c)n=i,r=t[o+1];else{var p=u.length;n=[u[p-2],u[p-1]]}r&&"Z"===r[0]&&(r=t[o],e[o]&&(e[o].prePoint=n)),h.currentPoint=n,e[o]&&Aa(n,e[o].currentPoint)&&(e[o].prePoint=h.prePoint);var f=r?[r[r.length-2],r[r.length-1]]:null;h.nextPoint=f;var d=h.prePoint;if(["L","H","V"].includes(c))h.startTangent=[d[0]-n[0],d[1]-n[1]],h.endTangent=[n[0]-d[0],n[1]-d[1]];else if("Q"===c){var y=[u[1],u[2]];h.startTangent=[d[0]-y[0],d[1]-y[1]],h.endTangent=[n[0]-y[0],n[1]-y[1]]}else if("T"===c)y=Na((m=e[s-1]).currentPoint,d),"Q"===m.command?(h.command="Q",h.startTangent=[d[0]-y[0],d[1]-y[1]],h.endTangent=[n[0]-y[0],n[1]-y[1]]):(h.command="TL",h.startTangent=[d[0]-n[0],d[1]-n[1]],h.endTangent=[n[0]-d[0],n[1]-d[1]]);else if("C"===c){var v=[u[1],u[2]],g=[u[3],u[4]];h.startTangent=[d[0]-v[0],d[1]-v[1]],h.endTangent=[n[0]-g[0],n[1]-g[1]],0===h.startTangent[0]&&0===h.startTangent[1]&&(h.startTangent=[v[0]-g[0],v[1]-g[1]]),0===h.endTangent[0]&&0===h.endTangent[1]&&(h.endTangent=[g[0]-v[0],g[1]-v[1]])}else if("S"===c){var m;v=Na((m=e[s-1]).currentPoint,d),g=[u[1],u[2]],"C"===m.command?(h.command="C",h.startTangent=[d[0]-v[0],d[1]-v[1]],h.endTangent=[n[0]-g[0],n[1]-g[1]]):(h.command="SQ",h.startTangent=[d[0]-g[0],d[1]-g[1]],h.endTangent=[n[0]-g[0],n[1]-g[1]])}else if("A"===c){var b=.001,T=h.arcParams||{},E=T.cx,w=void 0===E?0:E,x=T.cy,_=void 0===x?0:x,P=T.rx,M=void 0===P?0:P,A=T.ry,S=void 0===A?0:A,N=T.sweepFlag,C=void 0===N?0:N,O=T.startAngle,I=void 0===O?0:O,k=T.endAngle,R=void 0===k?0:k;0===C&&(b*=-1);var D=M*Math.cos(I-b)+w,B=S*Math.sin(I-b)+_;h.startTangent=[D-i[0],B-i[1]];var L=M*Math.cos(I+R+b)+w,j=S*Math.sin(I+R-b)+_;h.endTangent=[d[0]-L,d[1]-j]}e.push(h)}return e}(r),p=function(t){var e,n,r,i,o=0,a=0,s=[];return t?(t.forEach((function(e,n){r=t[n+1],i=e.length,r&&(o+=pi.length(e[i-2],e[i-1],r[1],r[2],r[3],r[4],r[5],r[6])||0)})),0===o?{curveSegments:[],totalLength:o}:(t.forEach((function(u,c){r=t[c+1],i=u.length,r&&((e=[])[0]=a/o,n=pi.length(u[i-2],u[i-1],r[1],r[2],r[3],r[4],r[5],r[6]),a+=n||0,e[1]=a/o,s.push(e))})),{curveSegments:s,totalLength:o})):{curveSegments:[],totalLength:o}}(u);return{absolutePath:e,hasArc:n,segments:h,polygons:o,polylines:a,curve:u,totalLength:p.totalLength,curveSegments:p.curveSegments,zCommandIndexes:c,rect:Ia(u)}}function Ia(t){var e=0,n=0,r=[],i=[];t.forEach((function(t){var o=l(t.slice(-2),2),a=o[0],s=o[1];if("M"===t[0])e=a,n=s,r.push(a),i.push(s);else if("C"===t[0]){var u=pi.box.apply(pi,p([],l([e,n].concat(t.slice(1))),!1));r=r.concat(u.x,u.x+u.width),i=i.concat(u.y,u.y+u.height),e=a,n=s}}));var o=Math.min.apply(0,r),a=Math.min.apply(0,i),s=Math.max.apply(0,r),u=Math.max.apply(0,i);return new Ca(o,a,s-o,u-a)}function ka(t,e){var n=t.curve,r=e.curve,i=[n,r];n.length!==r.length&&(i=vi(n,r));var o,a,s,u,c,h,l,p,f=gi(i[0])!==gi(i[1])?(a=(o=i[0]).slice(1).map((function(t,e,n){return e?n[e-1].slice(-2).concat(t.slice(1)):o[0].slice(1).concat(t.slice(1))})).map((function(t){return t.map((function(e,n){return t[t.length-n-2*(1-n%2)]}))})).reverse(),[["M"].concat(a[0].slice(0,2))].concat(a.map((function(t){return["C"].concat(t.slice(2))})))):bi(i[0]);return[f,(s=i[1],u=f,c=s.length-1,h=[],l=0,p=function(t){var e=t.length,n=e-1;return t.map((function(r,i){return t.map((function(r,o){var a,s=i+o;return 0===o||t[s]&&"M"===t[s][0]?(a=t[s],["M"].concat(a.slice(-2))):(s>=e&&(s-=n),t[s])}))}))}(s),p.forEach((function(t,e){s.slice(1).forEach((function(t,n){l+=function(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}(s[(e+n)%c].slice(-2),u[n%c].slice(-2))})),h[e]=l,l=0})),p[h.indexOf(Math.min.apply(null,h))]),function(t){return t}]}function Ra(t){var e,n,r=[],i=0,o=fi(t);return t.forEach((function(a,s){t[s+1]&&((e=[0,0])[0]=i/o,n=Jr(a[0],a[1],t[s+1][0],t[s+1][1]),i+=n,e[1]=i/o,r.push(e))})),{points:t,totalLength:o,segments:r}}var Da=Go.bind(null,/deg|rad|grad|turn|px|%/g),Ba=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function La(t){if(void 0===t&&(t=""),"none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];if(i=e.index+e[0].length,Ba.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map((function(t){return Da(t)||Po(t)}))}),n.lastIndex===t.length)return r}return[]}function ja(t){return t&&1===t.length?[t[0],t[0]]:[t[0],t[1]]}var Fa,Ga,Ua,Va=L,Wa={},za={},Ha={},qa=W((function(t){function e(t,e,n,r){e&&(Wa[t]=e),n&&(Ha[t]=n),r&&(za[t]||(za[t]=[]),za[t].push(r))}function n(t,n,r,i){for(var o=0;o<t.length;o++)e(t[o],n,r,i)}(0,v.GW)(I(),q.EventEmitter),t(Y),t({token:tn,useClass:en}),t({token:Qe,useFactory:function(t){return function(){return t.container.get(tn)}}}),t({token:sn,useClass:un}),t(gn),t(wn),t(fn),t(dn),t(yn),t(xn),t(_n),t(Pn),t(Mn),t({token:cn,useFactory:function(t){var e={};return function(n){return e[n]||t.container.isBoundNamed(hn,n)&&(e[n]=t.container.getNamed(hn,n)),e[n]}}}),n(["opacity","fillOpacity","strokeOpacity","offsetDistance"],Co,Io(0,1),void 0),n(["r","rx","ry","lineWidth","width","height","shadowBlur"],Co,Io(0,1/0),void 0),n(["lineDash"],ja,ko,void 0),n(["x1","x2","y1","y2","lineDashOffset","shadowOffsetX","shadowOffsetY"],Co,Oo,void 0),n(["x1","x2","y1","y2","r","rx","ry","width","height","path","points","text","shadowBlur","shadowOffsetX","shadowOffsetY","lineWidth","filter","font","fontSize","fontFamily","fontStyle","fontWeight","fontVariant","lineHeight","letterSpacing","padding","wordWrap","wordWrapWidth","leading","textBaseline","textAlign","whiteSpace"],void 0,void 0,Ao),n(["fill","stroke","shadowColor"],Po,Mo,void 0),e("clipPath",void 0,void 0,Bo),e("zIndex",void 0,void 0,Lo),e("offsetPath",void 0,void 0,Ro),e("offsetDistance",void 0,void 0,Do),e("origin",void 0,void 0,Yo),e("transformOrigin",void 0,void 0,Xo),e("transform",na,oa,aa),e("path",Oa,ka,void 0),e("points",Ra,void 0,void 0),n(["x","y","z","points","path","x1","x2","y1","y2","z1","z2"],void 0,void 0,So),e("filter",La,void 0,void 0),e("anchor",void 0,void 0,Vi)})),Ya=function(){function t(t){this.plugins=[],this.config=i({enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableTAA:!1},t)}return t.prototype.registerPlugin=function(t){this.plugins.push(t)},t.prototype.getPlugins=function(){return this.plugins},t.prototype.getConfig=function(){return this.config},t.prototype.setConfig=function(t){Object.assign(this.config,t)},t}(),Xa={},$a=0,Ka=function(){function t(t,e){var n,r;this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.name=t,this.matrix=(n=e.matrix,(r=new gt(16))[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r),this.right=_t(e.right),this.up=_t(e.up),this.forward=_t(e.forward),this.position=_t(e.position),this.focalPoint=_t(e.focalPoint),this.distanceVector=_t(e.distanceVector),this.azimuth=e.azimuth,this.elevation=e.elevation,this.roll=e.roll,this.relAzimuth=e.relAzimuth,this.relElevation=e.relElevation,this.relRoll=e.relRoll,this.dollyingStep=e.dollyingStep,this.distance=e.distance}return t.prototype.getPosition=function(){return this.position},t.prototype.getFocalPoint=function(){return this.focalPoint},t.prototype.getRoll=function(){return this.roll},t.prototype.retrieve=function(t){t.matrix=Ne(t.matrix,this.matrix),t.right=At(t.right,this.right),t.up=At(t.up,this.up),t.forward=At(t.forward,this.forward),t.position=At(t.position,this.position),t.focalPoint=At(t.focalPoint,this.focalPoint),t.distanceVector=At(t.distanceVector,this.distanceVector),t.azimuth=this.azimuth,t.elevation=this.elevation,t.roll=this.roll,t.relAzimuth=this.relAzimuth,t.relElevation=this.relElevation,t.relRoll=this.relRoll,t.dollyingStep=this.dollyingStep,t.distance=this.distance},t}(),Ja="DefaultCamera";!function(t){t.ORBITING="ORBITING",t.EXPLORING="EXPLORING",t.TRACKING="TRACKING"}(Fa||(Fa={})),function(t){t.DEFAULT="DEFAULT",t.ROTATIONAL="ROTATIONAL",t.TRANSLATIONAL="TRANSLATIONAL",t.CINEMATIC="CINEMATIC"}(Ga||(Ga={})),function(t){t.ORTHOGRAPHIC="ORTHOGRAPHIC",t.PERSPECTIVE="PERSPECTIVE"}(Ua||(Ua={}));var Za="updated",Qa=Math.PI/180,ts=180/Math.PI,es=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.matrix=Se(),e.right=Mt(1,0,0),e.up=Mt(0,1,0),e.forward=Mt(0,0,1),e.position=Mt(0,0,1),e.focalPoint=Mt(0,0,0),e.distanceVector=Mt(0,0,0),e.distance=1,e.azimuth=0,e.elevation=0,e.roll=0,e.relAzimuth=0,e.relElevation=0,e.relRoll=0,e.dollyingStep=0,e.maxDistance=1/0,e.minDistance=-1/0,e.zoom=1,e.rotateWorld=!1,e.fov=30,e.near=.1,e.far=1e3,e.aspect=1,e.projectionMatrix=Se(),e.projectionMatrixInverse=Se(),e.jitteredProjectionMatrix=void 0,e.following=void 0,e.type=Fa.EXPLORING,e.trackingMode=Ga.DEFAULT,e.projectionMode=Ua.PERSPECTIVE,e.frustum=new He,e.landmarks=[],e.orthoMatrix=Se(),e}return r(e,t),e.prototype.isOrtho=function(){return this.projectionMode===Ua.ORTHOGRAPHIC},e.prototype.clone=function(){var t=new e;return t.setType(this.type,void 0),t},e.prototype.getProjectionMode=function(){return this.projectionMode},e.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},e.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},e.prototype.getFrustum=function(){return this.frustum},e.prototype.getPosition=function(){return this.position},e.prototype.getFocalPoint=function(){return this.focalPoint},e.prototype.getNear=function(){return this.near},e.prototype.getFar=function(){return this.far},e.prototype.getZoom=function(){return this.zoom},e.prototype.getOrthoMatrix=function(){return this.orthoMatrix},e.prototype.setType=function(t,e){return this.type=t,this.type===Fa.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Fa.TRACKING&&void 0!==e&&this.setTrackingMode(e),this},e.prototype.setProjectionMode=function(t){return this.projectionMode=t,this},e.prototype.setTrackingMode=function(t){if(this.type!==Fa.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this},e.prototype.setWorldRotation=function(t){this.rotateWorld=t,this._getAngles()},e.prototype.getViewTransform=function(){return Oe(Se(),this.matrix)},e.prototype.getWorldTransform=function(){return this.matrix},e.prototype.jitterProjectionMatrix=function(t,e){var n,r,i=(r=[t,e,0],(n=Se())[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n);this.jitteredProjectionMatrix=Ie(Se(),i,this.projectionMatrix)},e.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},e.prototype.setMatrix=function(t){return this.matrix=t,this._update(),this},e.prototype.setFov=function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this},e.prototype.setAspect=function(t){return this.setPerspective(this.near,this.far,this.fov,t),this},e.prototype.setNear=function(t){return this.projectionMode===Ua.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this},e.prototype.setFar=function(t){return this.projectionMode===Ua.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this},e.prototype.setViewOffset=function(t,e,n,r,i,o){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.projectionMode===Ua.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.prototype.clearViewOffset=function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===Ua.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},e.prototype.setZoom=function(t){return this.zoom=t,this.projectionMode===Ua.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ua.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},e.prototype.setPerspective=function(t,e,n,r){this.projectionMode=Ua.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var i=this.near*Math.tan(.5*Qa*this.fov)/this.zoom,o=2*i,a=this.aspect*o,s=-.5*a;if(void 0!==this.view&&this.view.enabled){var u=this.view.fullWidth,c=this.view.fullHeight;s+=this.view.offsetX*a/u,i-=this.view.offsetY*o/c,a*=this.view.width/u,o*=this.view.height/c}return function(t,e,n,r,i,o,a){var s=2*o/(n-e),u=2*o/(r-i),c=(n+e)/(n-e),h=(r+i)/(r-i),l=-(a+o)/(a-o),p=-2*a*o/(a-o);t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=c,t[9]=h,t[10]=l,t[11]=-1,t[12]=0,t[13]=0,t[14]=p,t[15]=0}(this.projectionMatrix,s,s+a,i,i-o,t,this.far),Re(this.projectionMatrix,this.projectionMatrix,Mt(1,-1,1)),Oe(this.projectionMatrixInverse,this.projectionMatrix),this.emit(Za),this},e.prototype.setOrthographic=function(t,e,n,r,i,o){this.projectionMode=Ua.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=o;var a=(this.rright-this.left)/(2*this.zoom),s=(this.top-this.bottom)/(2*this.zoom),u=(this.rright+this.left)/2,c=(this.top+this.bottom)/2,h=u-a,l=u+a,p=c+s,f=c-s;if(void 0!==this.view&&this.view.enabled){var d=(this.rright-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l=(h+=d*this.view.offsetX)+d*this.view.width,f=(p-=y*this.view.offsetY)-y*this.view.height}return function(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*c,t[15]=1}(this.projectionMatrix,h,l,f,p,i,o),Re(this.projectionMatrix,this.projectionMatrix,Mt(1,-1,1)),Oe(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.emit(Za),this},e.prototype.setPosition=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),this._setPosition(t,e,n),this.setFocalPoint(this.focalPoint),this},e.prototype.setFocalPoint=function(t,e,n){var r,i,o,a,s,u,c,h,l,p,f,d,y,v=Mt(0,1,0);if(this.focalPoint=Ur(t,e,n),this.trackingMode===Ga.CINEMATIC){var g=Ct(xt(),this.focalPoint,this.position);t=g[0],e=g[1],n=g[2];var m=Pt(g),b=Math.asin(e/m)*ts,T=90+Math.atan2(n,t)*ts,E=Se();r=E,i=E,o=T*Qa,a=Math.sin(o),s=Math.cos(o),u=i[0],c=i[1],h=i[2],l=i[3],p=i[8],f=i[9],d=i[10],y=i[11],i!==r&&(r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15]),r[0]=u*s-p*a,r[1]=c*s-f*a,r[2]=h*s-d*a,r[3]=l*s-y*a,r[8]=u*a+p*s,r[9]=c*a+f*s,r[10]=h*a+d*s,r[11]=l*a+y*s,function(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],h=e[9],l=e[10],p=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=a*i+h*r,t[6]=s*i+l*r,t[7]=u*i+p*r,t[8]=c*i-o*r,t[9]=h*i-a*r,t[10]=l*i-s*r,t[11]=p*i-u*r}(E,E,b*Qa),v=Zt(xt(),[0,1,0],E)}return Oe(this.matrix,function(t,e,n,r){var i,o,a,s,u,c,h,l,p,f,d=e[0],y=e[1],v=e[2],g=r[0],m=r[1],b=r[2],T=n[0],E=n[1],w=n[2];return Math.abs(d-T)<vt&&Math.abs(y-E)<vt&&Math.abs(v-w)<vt?Ce(t):(h=d-T,l=y-E,p=v-w,i=m*(p*=f=1/Math.hypot(h,l,p))-b*(l*=f),o=b*(h*=f)-g*p,a=g*l-m*h,(f=Math.hypot(i,o,a))?(i*=f=1/f,o*=f,a*=f):(i=0,o=0,a=0),s=l*a-p*o,u=p*i-h*a,c=h*o-l*i,(f=Math.hypot(s,u,c))?(s*=f=1/f,u*=f,c*=f):(s=0,u=0,c=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=o,t[5]=u,t[6]=l,t[7]=0,t[8]=a,t[9]=c,t[10]=p,t[11]=0,t[12]=-(i*d+o*y+a*v),t[13]=-(s*d+u*y+c*v),t[14]=-(h*d+l*y+p*v),t[15]=1,t)}(Se(),this.position,this.focalPoint,v)),this._getAxes(),this._getDistance(),this._getAngles(),this},e.prototype.setDistance=function(t){if(!(this.distance===t||t<0)){this.distance=t,this.distance<2e-4&&(this.distance=2e-4),this.dollyingStep=this.distance/100;var e=xt();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this}},e.prototype.setMaxDistance=function(t){return this.maxDistance=t,this},e.prototype.setMinDistance=function(t){return this.minDistance=t,this},e.prototype.changeAzimuth=function(t){return this.setAzimuth(this.azimuth+t),this},e.prototype.changeElevation=function(t){return this.setElevation(this.elevation+t),this},e.prototype.changeRoll=function(t){return this.setRoll(this.roll+t),this},e.prototype.setAzimuth=function(t){return this.azimuth=Gr(t),this.computeMatrix(),this._getAxes(),this.type===Fa.ORBITING||this.type===Fa.EXPLORING?this._getPosition():this.type===Fa.TRACKING&&this._getFocalPoint(),this},e.prototype.getAzimuth=function(){return this.azimuth},e.prototype.setElevation=function(t){return this.elevation=Gr(t),this.computeMatrix(),this._getAxes(),this.type===Fa.ORBITING||this.type===Fa.EXPLORING?this._getPosition():this.type===Fa.TRACKING&&this._getFocalPoint(),this},e.prototype.setRoll=function(t){return this.roll=Gr(t),this.computeMatrix(),this._getAxes(),this.type===Fa.ORBITING||this.type===Fa.EXPLORING?this._getPosition():this.type===Fa.TRACKING&&this._getFocalPoint(),this},e.prototype.rotate=function(t,e,n){if(this.relElevation=Gr(e),this.relAzimuth=Gr(t),this.relRoll=Gr(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Fa.EXPLORING){var r=Ee(Te(),[1,0,0],(this.rotateWorld?1:-1)*this.relElevation*Qa),i=Ee(Te(),[0,1,0],(this.rotateWorld?1:-1)*this.relAzimuth*Qa),o=Ee(Te(),[0,0,1],this.relRoll*Qa),a=we(Te(),i,r);a=we(Te(),a,o);var s=Fe(Se(),a);ke(this.matrix,this.matrix,[0,0,-this.distance]),Ie(this.matrix,this.matrix,s),ke(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return;this.computeMatrix()}return this._getAxes(),this.type===Fa.ORBITING||this.type===Fa.EXPLORING?this._getPosition():this.type===Fa.TRACKING&&this._getFocalPoint(),this._update(),this},e.prototype.pan=function(t,e){var n=Ur(t,e,0),r=_t(this.position);return Nt(r,r,jt(xt(),this.right,n[0])),Nt(r,r,jt(xt(),this.up,n[1])),this._setPosition(r),this.emit(Za),this},e.prototype.dolly=function(t){var e=this.forward,n=_t(this.position),r=this.dollyingStep,i=this.distance+t*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*e[0],n[1]+=r*e[1],n[2]+=r*e[2],this._setPosition(n),this.type===Fa.ORBITING||this.type===Fa.EXPLORING?this._getDistance():this.type===Fa.TRACKING&&Nt(this.focalPoint,n,this.distanceVector),this.emit(Za),this},e.prototype.createLandmark=function(t,e){var n=this.clone();n.setPosition(e.position),n.setFocalPoint(e.focalPoint),void 0!==e.roll&&n.setRoll(e.roll);var r=new Ka(t,n);return this.landmarks.push(r),r},e.prototype.setLandmark=function(t){var e=new Ka(t,this);return this.landmarks.push(e),this},e.prototype.gotoLandmark=function(t,e){var n=this;void 0===e&&(e=1e3);var r=this.landmarks.find((function(e){return e.name===t}));if(r){if(0===e)return void r.retrieve(this);void 0!==this.landmarkAnimationID&&Yn(this.landmarkAnimationID);var i,o=r.getPosition(),a=r.getFocalPoint(),s=r.getRoll();qn((function t(r){void 0===i&&(i=r);var u,c=r-i,h=(1-Math.cos(c/e*Math.PI))/2,l=xt(),p=xt();if(Xt(l,n.focalPoint,a,h),Xt(p,n.position,o,h),u=n.roll*(1-h)+s*h,n.setFocalPoint(l),n.setPosition(p),n.setRoll(u),n.computeMatrix(),n.emit(Za),!(fe(l,a)+fe(p,o)>.01))return n.setFocalPoint(l),n.setPosition(p),n.setRoll(u),void n.computeMatrix();c<e&&(n.landmarkAnimationID=qn(t))}))}},e.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.emit(Za)},e.prototype.computeMatrix=function(){var t=Ee(Te(),[0,0,1],this.roll*Qa);Ce(this.matrix);var e=Ee(Te(),[1,0,0],(this.rotateWorld&&this.type!==Fa.TRACKING||this.type===Fa.TRACKING?1:-1)*this.elevation*Qa),n=Ee(Te(),[0,1,0],(this.rotateWorld&&this.type!==Fa.TRACKING||this.type===Fa.TRACKING?1:-1)*this.azimuth*Qa),r=we(Te(),n,e);r=we(Te(),r,t);var i=Fe(Se(),r);this.type===Fa.ORBITING||this.type===Fa.EXPLORING?(ke(this.matrix,this.matrix,this.focalPoint),Ie(this.matrix,this.matrix,i),ke(this.matrix,this.matrix,[0,0,this.distance])):this.type===Fa.TRACKING&&(ke(this.matrix,this.matrix,this.position),Ie(this.matrix,this.matrix,i))},e.prototype._setPosition=function(t,e,n){this.position=Ur(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()},e.prototype._getAxes=function(){At(this.right,Ur(be(me(),[1,0,0,0],this.matrix))),At(this.up,Ur(be(me(),[0,1,0,0],this.matrix))),At(this.forward,Ur(be(me(),[0,0,1,0],this.matrix))),Ht(this.right,this.right),Ht(this.up,this.up),Ht(this.forward,this.forward)},e.prototype._getAngles=function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=Pt(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===Fa.TRACKING||this.rotateWorld?(this.elevation=Math.asin(e/r)*ts,this.azimuth=Math.atan2(-t,-n)*ts):(this.elevation=-Math.asin(e/r)*ts,this.azimuth=-Math.atan2(-t,-n)*ts)},e.prototype._getPosition=function(){At(this.position,Ur(be(me(),[0,0,0,1],this.matrix))),this._getDistance()},e.prototype._getFocalPoint=function(){var t,e;Qt(this.distanceVector,[0,0,-this.distance],(t=bt(),e=this.matrix,t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t)),Nt(this.focalPoint,this.position,this.distanceVector),this._getDistance()},e.prototype._getDistance=function(){this.distanceVector=Ct(xt(),this.focalPoint,this.position),this.distance=Pt(this.distanceVector),this.dollyingStep=this.distance/100},e.prototype._getOrthoMatrix=function(){if(this.projectionMode===Ua.ORTHOGRAPHIC){var t=this.position,e=Ee(Te(),[0,0,1],-this.roll*Math.PI/180);je(this.orthoMatrix,e,Mt((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),Mt(this.zoom,this.zoom,1),t)}},e.ProjectionMode={ORTHOGRAPHIC:"ORTHOGRAPHIC",PERSPECTIVE:"PERSPECTIVE"},e}(q.EventEmitter),ns=function(){function t(){}var e;return e=t,t.prototype.apply=function(t){var n=this;t.hooks.prepare.tap(e.tag,(function(t){if(t){var e=n.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering;return t.renderable.dirty||n.renderingContext.renderReasons.has(ln.CameraChanged)||!e?t:null}return t}))},t.tag="DirtyCheckPlugin",a([R(pn),s("design:type",Object)],t.prototype,"canvasConfig",void 0),a([R(Nn),s("design:type",Object)],t.prototype,"renderingContext",void 0),e=a([k({contrib:Fi})],t)}(),rs=d.defineToken("CullingStrategyContribution"),is=function(){function t(){}var e;return e=t,t.prototype.apply=function(t){var n=this,r=this.strategyProvider.getContributions();t.hooks.prepare.tap(e.tag,(function(t){if(t){var e=t.cullable;if(0===r.length?e.visible=!0:e.visible=r.every((function(e){return e.isVisible(t)})),t.isVisible())return t;if(n.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering){var i=t.getRenderBounds();i&&(n.renderingContext.removedRenderBoundsList.push(i),n.renderingContext.renderReasons.add(ln.DisplayObjectRemoved))}return null}return t})),t.hooks.afterRender.tap(e.tag,(function(t){t.cullable.visibilityPlaneMask=-1}))},t.tag="CullingPlugin",a([R(pn),s("design:type",Object)],t.prototype,"canvasConfig",void 0),a([H(rs),s("design:type",Object)],t.prototype,"strategyProvider",void 0),a([R(Nn),s("design:type",Object)],t.prototype,"renderingContext",void 0),e=a([k({contrib:Fi})],t)}(),os=function(){function t(){}var e;return e=t,t.prototype.apply=function(t){var n=this,r=function(){n.renderingContext.renderReasons.add(ln.DisplayObjectChanged)},i=function(){t.dirtify()},o=function(e){rn(e.target),t.dirtify()},a=function(e){rn(e.target),t.dirtify()};t.hooks.init.tap(e.tag,(function(){n.renderingContext.root.addEventListener(ze.MOUNTED,o),n.renderingContext.root.addEventListener(ze.UNMOUNTED,a),n.renderingContext.root.addEventListener(ze.ATTRIBUTE_CHANGED,r),n.renderingContext.root.addEventListener(ze.BOUNDS_CHANGED,i)})),t.hooks.destroy.tap(e.tag,(function(){n.renderingContext.root.removeEventListener(ze.MOUNTED,o),n.renderingContext.root.removeEventListener(ze.UNMOUNTED,a),n.renderingContext.root.removeEventListener(ze.ATTRIBUTE_CHANGED,r),n.renderingContext.root.removeEventListener(ze.BOUNDS_CHANGED,i)}))},t.tag="PrepareRendererPlugin",a([R(Nn),s("design:type",Object)],t.prototype,"renderingContext",void 0),e=a([k({contrib:Fi})],t)}(),as=function(){function t(){}return t.prototype.isVisible=function(t){return!0},t.prototype.computeVisibilityWithPlaneMask=function(t,e,n){if(e===Ge.OUTSIDE||e===Ge.INSIDE)return e;for(var r=Ge.INSIDE,i=0,o=n.length;i<o;++i){var a=i<31?1<<i:0;if(!(i<31&&0==(e&a))){var s=n[i],u=s.normal,c=s.distance;if(qt(u,t.getPositiveFarPoint(n[i]))+c<0)return Ge.OUTSIDE;qt(u,t.getNegativeFarPoint(n[i]))+c<0&&(r|=a)}}return r},a([k({contrib:rs})],t)}(),ss=!!self.TouchEvent,us=!!self.PointerEvent,cs={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};function hs(t){var e=[];if(function(t){return ss&&t instanceof TouchEvent}(t))for(var n=0;n<t.changedTouches.length;n++){var r=t.changedTouches[n];ht(r.button)&&(r.button=t.touches.length?1:0),ht(r.buttons)&&(r.buttons=t.touches.length?1:0),ht(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),ht(r.width)&&(r.width=r.radiusX||1),ht(r.height)&&(r.height=r.radiusY||1),ht(r.tiltX)&&(r.tiltX=0),ht(r.tiltY)&&(r.tiltY=0),ht(r.pointerType)&&(r.pointerType="touch"),ht(r.pointerId)&&(r.pointerId=r.identifier||0),ht(r.pressure)&&(r.pressure=r.force||.5),ht(r.twist)&&(r.twist=0),ht(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(function(t){return!self.MouseEvent||t instanceof MouseEvent&&(!us||!(t instanceof self.PointerEvent))}(t)){var i=t;ht(i.isPrimary)&&(i.isPrimary=!0),ht(i.width)&&(i.width=1),ht(i.height)&&(i.height=1),ht(i.tiltX)&&(i.tiltX=0),ht(i.tiltY)&&(i.tiltY=0),ht(i.pointerType)&&(i.pointerType="mouse"),ht(i.pointerId)&&(i.pointerId=1),ht(i.pressure)&&(i.pressure=.5),ht(i.twist)&&(i.twist=0),ht(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}var ls,ps=function(){function t(){var t=this;this.autoPreventDefault=!0,this.rootPointerEvent=new Mi(null),this.rootWheelEvent=new Ai(null),this.onPointerMove=function(e){var n,r;if(!ss||"touch"!==e.pointerType){var i=hs(e);try{for(var o=h(i),a=o.next();!a.done;a=o.next()){var s=a.value,u=t.bootstrapEvent(t.rootPointerEvent,s);t.eventService.mapEvent(u)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}t.setCursor(t.eventService.cursor)}}}var e;return e=t,t.prototype.apply=function(t){var n=this;this.eventService.setPickHandler((function(t){return u(n,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.renderingService.hooks.pick.promise({position:t,picked:null})];case 1:return[2,e.sent().picked]}}))}))})),t.hooks.pointerWheel.tap(e.tag,(function(t){var e=n.normalizeWheelEvent(t);n.eventService.mapEvent(e)})),t.hooks.pointerDown.tap(e.tag,(function(t){var e,r;if(!ss||"touch"!==t.pointerType){var i=hs(t);n.autoPreventDefault&&i[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();try{for(var o=h(i),a=o.next();!a.done;a=o.next()){var s=a.value,u=n.bootstrapEvent(n.rootPointerEvent,s);n.eventService.mapEvent(u)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}n.setCursor(n.eventService.cursor)}})),t.hooks.pointerUp.tap(e.tag,(function(t){var e,r;if(!ss||"touch"!==t.pointerType){var i=n.contextService.getDomElement(),o=i&&t.target&&t.target!==i&&i.contains&&!i.contains(t.target)?"outside":"",a=hs(t);try{for(var s=h(a),u=s.next();!u.done;u=s.next()){var c=u.value,l=n.bootstrapEvent(n.rootPointerEvent,c);l.type+=o,n.eventService.mapEvent(l)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}n.setCursor(n.eventService.cursor)}})),t.hooks.pointerMove.tap(e.tag,this.onPointerMove),t.hooks.pointerOver.tap(e.tag,this.onPointerMove),t.hooks.pointerOut.tap(e.tag,this.onPointerMove)},t.prototype.bootstrapEvent=function(t,e){t._originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var n=this.eventService.client2Viewport(new Je(e.clientX,e.clientY)),r=n.x,i=n.y;t.viewport.x=r,t.viewport.y=i;var o=this.eventService.viewport2Canvas(t.viewport),a=o.x,s=o.y;return t.canvas.x=a,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=cs[t.type]||t.type),t},t.prototype.normalizeWheelEvent=function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.eventService.client2Viewport(new Je(t.clientX,t.clientY)),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var o=this.eventService.viewport2Canvas(e.viewport),a=o.x,s=o.y;return e.canvas.x=a,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e},t.prototype.transferMouseData=function(t,e){t.isTrusted=e.isTrusted,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null},t.prototype.setCursor=function(t){this.contextService.applyCursorStyle(t||this.canvasConfig.cursor||"default")},t.tag="EventPlugin",a([R(pn),s("design:type",Object)],t.prototype,"canvasConfig",void 0),a([R(An),s("design:type",Object)],t.prototype,"contextService",void 0),a([R(Gi),s("design:type",Gi)],t.prototype,"renderingService",void 0),a([R(Ui),s("design:type",Ui)],t.prototype,"eventService",void 0),e=a([k({contrib:Fi})],t)}(),fs=W((function(t,e){e.container.isBound(Gi)?(e.container.remove(Fi),e.container.remove(Gi),e.container.remove(as)):(z.register(t,Fi,{cache:!1}),z.register(t,rs,{cache:!1})),t(Gi),t(Ui),t(ps),t(os),t(ns),t(is),t(as)}));!function(t){t.READY="ready",t.BEFORE_RENDER="beforerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize"}(ls||(ls={}));var ds=function(t){function e(e){var n=t.call(this)||this;n.container=Va.createChild(),n.Element=wi,n.document=new _i,n.document.defaultView=n,n.customElements=new ji,function(t,e){var n="string"==typeof t?t:t.id||$a++;Xa[n]&&Xa[n].destroy(),Xa[n]=e}(e.container,n);var r=i({width:300,height:150,cursor:"default",background:"white"},e);return n.initRenderingContext(r),n.initDefaultCamera(r.width,r.height),n.initRenderer(r.renderer),n}return r(e,t),e.prototype.initRenderingContext=function(t){var e=this;this.container.register({token:pn,useValue:t}),this.container.register({token:Nn,useValue:{root:this.document.documentElement,removedRenderBoundsList:[],renderReasons:new Set,force:!1,dirty:!1}}),this.document.documentElement.addEventListener(ze.CHILD_INSERTED,(function(t){e.mountChildren(t.detail.child)})),this.document.documentElement.addEventListener(ze.CHILD_REMOVED,(function(t){e.unmountChildren(t.detail.child)}))},e.prototype.initDefaultCamera=function(t,e){var n=(new es).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),r=this.container.get(Nn);n.on(Za,(function(){r.renderReasons.add(ln.CameraChanged)})),this.container.register({token:Ja,useValue:n})},e.prototype.getConfig=function(){return this.container.get(pn)},e.prototype.getContainer=function(){return this.container},e.prototype.getRoot=function(){return this.document.documentElement},e.prototype.getCamera=function(){return this.container.get(Ja)},e.prototype.getContextService=function(){return this.container.get(An)},e.prototype.getEventService=function(){return this.eventService},e.prototype.getRenderingService=function(){return this.renderingService},e.prototype.getRenderingContext=function(){return this.container.get(Nn)},e.prototype.getStats=function(){return this.getRenderingService().getStats()},e.prototype.getComputedStyle=function(t){return t.parsedStyle},e.prototype.destroy=function(t){void 0===t&&(t=!0),this.emit(ls.BEFORE_DESTROY,(function(){})),this.frameId&&Yn(this.frameId);var e=this.getRoot();this.unmountChildren(e),t&&this.document.destroy(),this.getContextService().destroy(),this.getRenderingService().destroy(),this.emit(ls.AFTER_DESTROY,{})},e.prototype.changeSize=function(t,e){this.resize(t,e)},e.prototype.resize=function(t,e){var n=this.container.get(pn);n.width=t,n.height=e,this.getContextService().resize(t,e);var r=this.container.get(Ja),i=r.getProjectionMode();r.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),i===Ua.ORTHOGRAPHIC?r.setOrthographic(t/-2,t/2,e/2,e/-2,r.getNear(),r.getFar()):r.setAspect(t/e),this.emit(ls.RESIZE,{width:t,height:e})},e.prototype.appendChild=function(t,e){return this.document.documentElement.appendChild(t,e)},e.prototype.insertBefore=function(t,e){return this.document.documentElement.insertBefore(t,e)},e.prototype.removeChild=function(t,e){return void 0===e&&(e=!0),this.document.documentElement.removeChild(t,e)},e.prototype.removeChildren=function(t){void 0===t&&(t=!0),this.document.documentElement.removeChildren(t)},e.prototype.render=function(){this.emit(ls.BEFORE_RENDER,{}),this.container.isBound(Gi)&&this.container.get(Gi).render(),this.emit(ls.AFTER_RENDER,{})},e.prototype.run=function(){var t=this;!function e(){t.render(),t.frameId=requestAnimationFrame(e)}()},e.prototype.initRenderer=function(t){var e=this;if(!t)throw new Error("Renderer is required.");this.loadCommonContainerModule(),this.loadRendererContainerModule(t);var n=this.container.get(An);this.renderingService=this.container.get(Gi),this.eventService=this.container.get(Ui),n.init(),this.renderingService.init().then((function(){e.emit(ls.READY,{})})),t.getConfig().enableAutoRendering&&this.run(),this.getRoot().forEach((function(t){var e=t.renderable;e&&(e.renderBoundsDirty=!0,e.boundsDirty=!0,e.dirty=!0)})),this.mountChildren(this.getRoot())},e.prototype.loadCommonContainerModule=function(){this.container.load(fs,!0)},e.prototype.loadRendererContainerModule=function(t){var e=this;t.getPlugins().forEach((function(t){t.init(e.container)}))},e.prototype.setRenderer=function(t){var e=this,n=this.getConfig();if(n.renderer!==t){var r=n.renderer;n.renderer=t,this.destroy(!1),null==r||r.getPlugins().reverse().forEach((function(t){t.destroy(e.container)})),this.initRenderer(t)}},e.prototype.unmountChildren=function(t){var e=[];t.forEach((function(t){t.isConnected&&e.push(t)})),e.reverse().forEach((function(t){t.emit(ze.UNMOUNTED,{}),t.ownerDocument=null,t.isConnected=!1}))},e.prototype.mountChildren=function(t){var e=this;t.forEach((function(t){t.isConnected||(t.ownerDocument=e.document,t.isConnected=!0,t.emit(ze.MOUNTED,{}))}))},e.prototype.client2Viewport=function(t){return this.getEventService().client2Viewport(t)},e.prototype.viewport2Client=function(t){return this.getEventService().viewport2Client(t)},e.prototype.viewport2Canvas=function(t){return this.getEventService().viewport2Canvas(t)},e.prototype.canvas2Viewport=function(t){return this.getEventService().canvas2Viewport(t)},e.prototype.getPointByClient=function(t,e){return this.client2Viewport({x:t,y:e})},e.prototype.getClientByPoint=function(t,e){return this.viewport2Client({x:t,y:e})},e}(kn);Va.load(qa);var ys="ontouchstart"in self,vs=!!self.PointerEvent,gs=function(){function t(){}var e;return e=t,t.prototype.apply=function(t){var n=this,r=function(e){t.hooks.pointerMove.call(e)},i=function(e){t.hooks.pointerUp.call(e)},o=function(e){t.hooks.pointerDown.call(e)},a=function(e){t.hooks.pointerOver.call(e)},s=function(e){t.hooks.pointerOut.call(e)},u=function(e){t.hooks.pointerWheel.call(e)};t.hooks.init.tap(e.tag,(function(){var t=n.contextService.getDomElement();vs?(self.document.addEventListener("pointermove",r,!0),t.addEventListener("pointerdown",o,!0),t.addEventListener("pointerleave",s,!0),t.addEventListener("pointerover",a,!0),self.addEventListener("pointerup",i,!0)):(self.document.addEventListener("mousemove",r,!0),t.addEventListener("mousedown",o,!0),t.addEventListener("mouseout",s,!0),t.addEventListener("mouseover",a,!0),self.addEventListener("mouseup",i,!0)),ys&&(t.addEventListener("touchstart",o,!0),t.addEventListener("touchend",i,!0),t.addEventListener("touchmove",r,!0)),t.addEventListener("wheel",u,{passive:!0,capture:!0})})),t.hooks.destroy.tap(e.tag,(function(){var t=n.contextService.getDomElement();vs?(self.document.removeEventListener("pointermove",r,!0),t.removeEventListener("pointerdown",o,!0),t.removeEventListener("pointerleave",s,!0),t.removeEventListener("pointerover",a,!0),self.removeEventListener("pointerup",i,!0)):(self.document.removeEventListener("mousemove",r,!0),t.removeEventListener("mousedown",o,!0),t.removeEventListener("mouseout",s,!0),t.removeEventListener("mouseover",a,!0),self.removeEventListener("mouseup",i,!0)),ys&&(t.removeEventListener("touchstart",o,!0),t.removeEventListener("touchend",i,!0),t.removeEventListener("touchmove",r,!0)),t.removeEventListener("wheel",u,!0)}))},t.tag="DOMInteractionPlugin",a([R(An),s("design:type",Object)],t.prototype,"contextService",void 0),e=a([k({contrib:Fi})],t)}(),ms=W((function(t){t(gs)})),bs=function(){function t(){}return t.prototype.init=function(t){t.load(ms,!0)},t.prototype.destroy=function(t){t.remove(gs)},t}(),Ts=n(2582),Es=n.n(Ts),ws=d.defineToken("StyleRendererFactory"),xs=d.defineToken("StyleRenderer"),_s=function(){function t(){}return t.prototype.hash=function(t){return t.fill,t.opacity,t.fillOpacity,t.stroke,t.strokeOpacity,t.lineWidth,t.lineCap,t.lineJoin,""},t.prototype.render=function(t,e){var n=e.fill,r=e.opacity,i=e.fillOpacity,o=e.stroke,a=e.strokeOpacity,s=e.lineWidth,u=e.lineCap,c=e.lineJoin,h=e.shadowColor,l=e.filter;if(ct(n)||(ct(i)||1===i?t.fill():(t.globalAlpha=i,t.fill(),t.globalAlpha=r)),!ct(o)&&s&&s>0){!ct(a)&&1!==a&&(t.globalAlpha=a),t.lineWidth=s,ct(u)||(t.lineCap=u),ct(c)||(t.lineJoin=c);var p=void 0,f=void 0,d=void 0,y=!ct(h),v=!ct(l);y&&(p=t.shadowBlur,f=t.shadowColor,ct(p)||(t.shadowColor="transparent",t.shadowBlur=0)),v&&(d=t.filter,!ct(d)&&d.indexOf("drop-shadow")>-1&&(t.filter=d.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")),t.stroke(),y&&(t.shadowColor=f,t.shadowBlur=p),v&&(t.filter=d)}},a([k({token:[{token:xs,named:on.Circle},{token:xs,named:on.Ellipse},{token:xs,named:on.Rect},{token:xs,named:on.Line},{token:xs,named:on.Polyline},{token:xs,named:on.Polygon},{token:xs,named:on.Path}]})],t)}(),Ps=function(){function t(){this.imageCache={},this.patternCache={}}return t.prototype.getImageSync=function(t){return this.imageCache[t]},t.prototype.getOrCreateImage=function(t){var e=this;return this.imageCache[t]?Promise.resolve(this.imageCache[t]):new Promise((function(n,r){var i=new window.Image;i.onload=function(){n(i)},i.onerror=function(t){r(t)},i.crossOrigin="Anonymous",i.src=t,e.imageCache[t]=i}))},t.prototype.getPatternSync=function(t){var e=this.generatePatternKey(t);if(this.patternCache[e])return this.patternCache[e]},t.prototype.createPattern=function(t,e){var n=this;return this.getOrCreateImage(t.src).then((function(r){var i=n.generatePatternKey(t),o=e.createPattern(r,t.repetition);return o&&(n.patternCache[i]=o),n.patternCache[i]}))},t.prototype.generatePatternKey=function(t){return"pattern-"+t.src+"-"+t.repetition},a([k()],t)}(),Ms=function(){function t(){}return t.prototype.hash=function(t){return""},t.prototype.render=function(t,e){var n,r=e.width,i=void 0===r?0:r,o=e.height,a=void 0===o?0:o,s=e.img,u=i,c=a;rt(s)?n=this.imagePool.getImageSync(s):(u||(u=s.width),c||(c=s.height),n=s),t.drawImage(n,0,0,u,c)},a([R(Ps),s("design:type",Ps)],t.prototype,"imagePool",void 0),a([k({token:{token:xs,named:on.Image}})],t)}(),As=function(){function t(){}return t.prototype.hash=function(t){return""},t.prototype.render=function(t,e){e.text;var n=e.lineWidth,r=void 0===n?0:n,i=e.textAlign,o=e.textBaseline,a=e.lineJoin,s=e.miterLimit,u=void 0===s?0:s,c=e.padding,h=void 0===c?0:c,l=e.letterSpacing,p=void 0===l?0:l,f=e.stroke,d=e.fill,y=e.fillOpacity,v=e.strokeOpacity,g=e.opacity,m=e.metrics,b=m.font,T=m.lines,E=m.height,w=m.lineHeight;t.font=b,t.lineWidth=r,t.textAlign=i,t.textBaseline=o,t.lineJoin=a,t.miterLimit=u;var x=0;"middle"===o?x=-E/2-w/2:"bottom"===o||"alphabetic"===o||"ideographic"===o?x=-E:"top"!==o&&"hanging"!==o||(x=-w);for(var _=0;_<T.length;_++){var P=r/2;x+=w,!ct(f)&&r&&this.drawLetterSpacing(t,T[_],P+h,x+h,p,y,v,g,!0),ct(d)||this.drawLetterSpacing(t,T[_],P+h,x+h,p,y,v,g)}},t.prototype.drawLetterSpacing=function(t,e,n,r,i,o,a,s,u){if(void 0===u&&(u=!1),0!==i)for(var c=n,h=Array.from(e),l=t.measureText(e).width,p=0,f=0;f<h.length;++f){var d=h[f];u?this.strokeText(t,d,c,r,a):this.fillText(t,d,c,r,o,s),c+=l-(p=t.measureText(e.substring(f+1)).width)+i,l=p}else u?this.strokeText(t,e,n,r,a):this.fillText(t,e,n,r,o,s)},t.prototype.fillText=function(t,e,n,r,i,o){var a=!ct(i)&&1!==i;a&&(t.globalAlpha=i),t.fillText(e,n,r),a&&(t.globalAlpha=o)},t.prototype.strokeText=function(t,e,n,r,i){!ct(i)&&1!==i&&(t.globalAlpha=i),t.strokeText(e,n,r)},a([R(wn),s("design:type",wn)],t.prototype,"textService",void 0),a([k({token:{token:xs,named:on.Text}})],t)}(),Ss=function(){function t(){this.gradientCache={}}return t.prototype.getOrCreateGradient=function(t,e){var n=this.generateCacheKey(t),r=t.type,i=t.x0,o=t.y0,a=t.x1,s=t.y1,u=t.steps,c=t.width,h=t.height;if(this.gradientCache[n])return this.gradientCache[n];var p=null;if(r===qi.LinearGradient)p=e.createLinearGradient(i*c,o*h,a*c,s*h);else if(r===qi.RadialGradient){var f=Math.sqrt(c*c+h*h)/2;p=e.createRadialGradient(i*c,o*h,0,a*c,s*h,t.r1*f)}return p&&(u.forEach((function(t){var e=l(t,2),n=e[0],r=e[1];null==p||p.addColorStop(Number(n),r)})),this.gradientCache[n]=p),this.gradientCache[n]},t.prototype.generateCacheKey=function(t){var e=t.type,n=t.x0,r=t.y0,i=t.x1,o=t.y1,a=t.r1,s=t.steps;return"gradient-"+e+"-"+n+"-"+r+"-"+i+"-"+o+"-"+(a||0)+"-"+t.width+"-"+t.height+"-"+s.map((function(t){return t.join("")})).join("-")},a([k()],t)}(),Ns="PathGeneratorFactory",Cs="PathGenerator",Os=function(){function t(){}return t.tag="c-canvas-rbush-node",t}(),Is="RBushRoot",ks=function(){function t(){this.renderQueue=[],this.restoreStack=[],this.clearFullScreen=!1,this.enableBatch=!1,this.batchedStyleHash="",this.batchedDisplayObject=null,this.toSync=new Set}var e;return e=t,t.prototype.syncRTree=function(){var t=this,e=[];this.toSync.forEach((function(n){var r=n.rBushNode;r&&t.rBush.remove(r.aabb);var i=n.getRenderBounds();if(i){var o=l(i.getMin(),2),a=o[0],s=o[1],u=l(i.getMax(),2),c=u[0],h=u[1];r.aabb={id:n.entity,minX:a,minY:s,maxX:c,maxY:h}}e.push(r.aabb)})),this.rBush.load(e),this.toSync.clear()},t.prototype.pushToSync=function(t){var e=this;t.forEach((function(t){e.toSync.add(t)}))},t.prototype.apply=function(t){var n=this,r=function(t){t.target.rBushNode=new Os,n.pushToSync(t.composedPath().slice(0,-2))},i=function(t){var e=t.target,r=e.rBushNode;n.rBush.remove(r.aabb),n.toSync.delete(e)},o=function(t){var e,r=t.target;(null===(e=r.ownerDocument)||void 0===e?void 0:e.documentElement)===n.renderingContext.root&&(t.detail.affectChildren&&r.forEach((function(t){n.pushToSync([t])})),n.pushToSync(t.composedPath().slice(0,-2)))};t.hooks.init.tap(e.tag,(function(){n.renderingContext.root.addEventListener(ze.MOUNTED,r),n.renderingContext.root.addEventListener(ze.UNMOUNTED,i),n.renderingContext.root.addEventListener(ze.BOUNDS_CHANGED,o)})),t.hooks.destroy.tap(e.tag,(function(){n.renderingContext.root.removeEventListener(ze.MOUNTED,r),n.renderingContext.root.removeEventListener(ze.UNMOUNTED,i),n.renderingContext.root.removeEventListener(ze.BOUNDS_CHANGED,o)})),t.hooks.beginFrame.tap(e.tag,(function(){var t=n.contextService.getContext(),e=n.canvasConfig.renderer.getConfig(),r=e.enableDirtyRectangleRendering;e.enableDirtyRectangleRenderingDebug,n.clearFullScreen=!r||n.renderingContext.renderReasons.has(ln.CameraChanged),t&&(t.save(),n.clearFullScreen&&t.clearRect(0,0,n.canvasConfig.width,n.canvasConfig.height),n.applyTransform(t,n.camera.getOrthoMatrix()))})),t.hooks.endFrame.tap(e.tag,(function(){n.syncRTree();var e=n.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering,r=n.contextService.getContext();if(e){var i=n.safeMergeAABB.apply(n,p([n.mergeDirtyAABBs(n.renderQueue)],l(n.renderingContext.removedRenderBoundsList),!1));if(n.renderingContext.removedRenderBoundsList=[],!i)return;var o=n.convertAABB2Rect(i),a=o.x,s=o.y,u=o.width,c=o.height;r.clearRect(a,s,u,c),r.beginPath(),r.rect(a,s,u,c),r.clip(),n.searchDirtyObjects(i).sort(n.sceneGraphService.sort).forEach((function(e){e.isVisible()&&n.renderDisplayObject(e,t)})),n.enableBatch&&n.batchedStyleHash&&n.flush(r,t),n.renderQueue.forEach((function(t){n.saveDirtyAABB(t)})),n.renderQueue=[]}n.restoreStack.forEach((function(t){r.restore()})),n.restoreStack=[],r.restore()})),t.hooks.render.tap(e.tag,(function(e){n.canvasConfig.renderer.getConfig().enableDirtyRectangleRendering?n.renderQueue.push(e):n.renderDisplayObject(e,t)}))},t.prototype.flush=function(t,e){if(this.batchedDisplayObject){var n=this.styleRendererFactory(this.batchedDisplayObject.nodeName);n&&(this.applyAttributesToContext(t,this.batchedDisplayObject,e),t.closePath(),n.render(t,this.batchedDisplayObject.parsedStyle,this.batchedDisplayObject),t.restore()),this.batchedStyleHash="",this.batchedDisplayObject=null}},t.prototype.renderDisplayObject=function(t,e){for(var n=this,r=this.contextService.getContext(),i=this.restoreStack[this.restoreStack.length-1];i&&t.parentNode!==i;)r.restore(),this.restoreStack.pop(),i=this.restoreStack[this.restoreStack.length-1];var o=t.nodeName,a=this.styleRendererFactory(o),s=!1;if(this.enableBatch&&a){var u=a.hash(t.attributes);this.batchedStyleHash&&u!==this.batchedStyleHash&&this.flush(r,e),this.batchedStyleHash||(this.batchedStyleHash=u,this.batchedDisplayObject=t,s=!0)}r.save(),this.applyTransform(r,t.getLocalTransform());var c=t.style.clipPath;if(c){r.save(),this.applyTransform(r,c.getLocalTransform());var h=this.pathGeneratorFactory(c.nodeName);h&&this.useAnchor(r,c,(function(){r.beginPath(),h(r,c.parsedStyle),r.closePath()})),r.restore(),r.clip()}this.enableBatch||(r.save(),this.applyAttributesToContext(r,t,e)),this.useAnchor(r,t,(function(){var e=n.pathGeneratorFactory(t.nodeName);e&&(!s&&n.enableBatch||r.beginPath(),e(r,t.parsedStyle),n.enableBatch||t.nodeName===on.Line||t.nodeName===on.Path||t.nodeName===on.Polyline||r.closePath()),a&&!n.enableBatch&&a.render(r,t.parsedStyle,t)})),this.enableBatch||r.restore(),t.renderable.dirty=!1,this.restoreStack.push(t)},t.prototype.convertAABB2Rect=function(t){var e=t.getMin(),n=t.getMax(),r=Math.floor(e[0]),i=Math.floor(e[1]);return{x:r,y:i,width:Math.ceil(n[0])-r,height:Math.ceil(n[1])-i}},t.prototype.insertRBushNode=function(t){var e=t.rBushNode;if(e){this.rBush.remove(e.aabb);var n=t.getRenderBounds();if(n){var r=l(n.getMin(),2),i=r[0],o=r[1],a=l(n.getMax(),2),s=a[0],u=a[1];e.aabb={id:t.entity,minX:i,minY:o,maxX:s,maxY:u}}this.rBush.insert(e.aabb)}},t.prototype.mergeDirtyAABBs=function(t){var e;return t.forEach((function(t){var n=t.getRenderBounds();n&&(e?e.add(n):e=new Ue(n.center,n.halfExtents));var r=t.renderable.dirtyRenderBounds;r&&(e?e.add(r):e=new Ue(r.center,r.halfExtents))})),e},t.prototype.searchDirtyObjects=function(t){var e=this,n=l(t.getMin(),2),r=n[0],i=n[1],o=l(t.getMax(),2),a=o[0],s=o[1];return this.rBush.search({minX:r,minY:i,maxX:a,maxY:s}).map((function(t){var n=t.id;return e.displayObjectPool.getByEntity(n)}))},t.prototype.saveDirtyAABB=function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new Ue);var n=t.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)},t.prototype.applyTransform=function(t,e){var n=l(De(xt(),e),2),r=n[0],i=n[1],o=l(Be(xt(),e),2),a=o[0],s=o[1],u=Le(Te(),e),c=l(Wr(xt(),u),3),h=c[0],p=(c[1],c[2]),f=zr(h||p,r,i,a,s);t.transform(f[0],f[1],f[3],f[4],f[6],f[7])},t.prototype.getColor=function(t,e,n,r){var o;if(t.type===qi.LinearGradient||t.type===qi.RadialGradient){var a=e.getGeometryBounds(),s=a&&2*a.halfExtents[0]||0,u=a&&2*a.halfExtents[1]||0;o=this.gradientPool.getOrCreateGradient(i(i({type:t.type},t.value),{width:s,height:u}),n)}else if(t.type===qi.Pattern){var c=this.imagePool.getPatternSync(t.value);c?o=c:this.imagePool.createPattern(t.value,n).then((function(){e.renderable.dirty=!0,r.dirtify()}))}else o=t.formatted;return o},t.prototype.applyAttributesToContext=function(t,e,n){var r=e.parsedStyle,i=r.stroke,o=r.fill,a=r.opacity,s=r.lineDash,u=r.lineDashOffset,c=r.filter,h=r.shadowColor,l=r.shadowBlur,p=r.shadowOffsetX,f=r.shadowOffsetY;s&&J(s)&&t.setLineDash(s),ct(u)||(t.lineDashOffset=u),ct(a)||(t.globalAlpha*=a),ct(i)||(t.strokeStyle=this.getColor(i,e,t,n)),ct(o)||(t.fillStyle=this.getColor(o,e,t,n)),ct(c)||(t.filter=e.style.filter),ct(h)||(t.shadowColor=h.formatted,t.shadowBlur=l,t.shadowOffsetX=p,t.shadowOffsetY=f)},t.prototype.useAnchor=function(t,e,n){var r=e.getGeometryBounds();if(r){var i=r.halfExtents,o=(e.parsedStyle||{}).anchor,a=void 0===o?[0,0]:o;t.translate(-a[0]*i[0]*2,-a[1]*i[1]*2),n()}else n()},t.prototype.safeMergeAABB=function(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return e.forEach((function(e){e&&(t?t.add(e):t=e)})),t},t.tag="CanvasRendererPlugin",a([R(pn),s("design:type",Object)],t.prototype,"canvasConfig",void 0),a([R(Ja),s("design:type",es)],t.prototype,"camera",void 0),a([R(An),s("design:type",Object)],t.prototype,"contextService",void 0),a([R(sn),s("design:type",Object)],t.prototype,"sceneGraphService",void 0),a([R(Nn),s("design:type",Object)],t.prototype,"renderingContext",void 0),a([R(Ps),s("design:type",Ps)],t.prototype,"imagePool",void 0),a([R(Ss),s("design:type",Ss)],t.prototype,"gradientPool",void 0),a([R(Ns),s("design:type",Function)],t.prototype,"pathGeneratorFactory",void 0),a([R(ws),s("design:type",Function)],t.prototype,"styleRendererFactory",void 0),a([R(Y),s("design:type",Y)],t.prototype,"displayObjectPool",void 0),a([R(Is),s("design:type",Es())],t.prototype,"rBush",void 0),e=a([k({contrib:Fi})],t)}(),Rs=function(){function t(){}var e;return e=t,t.prototype.apply=function(t){var n=this,r=function(e){var r=e.target,i=r.nodeName,o=r.attributes;if(i===on.Image){var a=o.img;rt(a)&&n.imagePool.getOrCreateImage(a).then((function(){r.renderable.dirty=!0,t.dirtify()}))}},i=function(e){var r=e.target,i=e.detail,o=i.attributeName,a=i.newValue;r.nodeName===on.Image&&"img"===o&&rt(a)&&n.imagePool.getOrCreateImage(a).then((function(){r.renderable.dirty=!0,t.dirtify()}))};t.hooks.init.tap(e.tag,(function(){n.renderingContext.root.addEventListener(ze.MOUNTED,r),n.renderingContext.root.addEventListener(ze.ATTRIBUTE_CHANGED,i)})),t.hooks.destroy.tap(e.tag,(function(){n.renderingContext.root.removeEventListener(ze.MOUNTED,r),n.renderingContext.root.removeEventListener(ze.ATTRIBUTE_CHANGED,i)}))},t.tag="LoadImagePlugin",a([R(Ps),s("design:type",Ps)],t.prototype,"imagePool",void 0),a([R(Nn),s("design:type",Object)],t.prototype,"renderingContext",void 0),e=a([k({contrib:Fi})],t)}();Va.register({token:{token:Cs,named:on.Circle},useValue:function(t,e){var n=e.r,r=void 0===n?0:n;t.arc(r,r,r,0,2*Math.PI,!1)}}),Va.register({token:{token:Cs,named:on.Ellipse},useValue:function(t,e){var n=e.rx,r=e.ry;if(t.ellipse)t.ellipse(n,r,n,r,0,0,2*Math.PI,!1);else{var i=n>r?n:r,o=n>r?1:n/r,a=n>r?r/n:1;t.save(),t.scale(o,a),t.arc(0,0,i,0,2*Math.PI)}}}),Va.register({token:{token:Cs,named:on.Rect},useValue:function(t,e){var n=e.radius,r=void 0===n?0:n,i=e.width,o=void 0===i?0:i,a=e.height,s=void 0===a?0:a;if(0===r)t.rect(0,0,o,s);else{var u=l(function(t){var e=0,n=0,r=0,i=0;return J(t)?1===t.length?e=n=r=i=t[0]:2===t.length?(e=r=t[0],n=i=t[1]):3===t.length?(e=t[0],n=i=t[1],r=t[2]):(e=t[0],n=t[1],r=t[2],i=t[3]):e=n=r=i=t,[e,n,r,i]}(r),4),c=u[0],h=u[1],p=u[2],f=u[3];t.moveTo(c,0),t.lineTo(o-h,0),0!==h&&t.arc(o-h,h,h,-Math.PI/2,0),t.lineTo(o,s-p),0!==p&&t.arc(o-p,s-p,p,0,Math.PI/2),t.lineTo(f,s),0!==f&&t.arc(f,s-f,f,Math.PI/2,Math.PI),t.lineTo(0,c),0!==c&&t.arc(c,c,c,Math.PI,1.5*Math.PI)}}}),Va.register({token:{token:Cs,named:on.Line},useValue:function(t,e){var n=e.x1,r=e.y1,i=e.x2,o=e.y2,a=e.defX,s=void 0===a?0:a,u=e.defY,c=void 0===u?0:u;t.moveTo(n-s,r-c),t.lineTo(i-s,o-c)}}),Va.register({token:{token:Cs,named:on.Polyline},useValue:function(t,e){var n=e.defX,r=void 0===n?0:n,i=e.defY,o=void 0===i?0:i,a=e.points.points,s=a.length,u=a[0][0]-r,c=a[0][1]-o,h=a[s-1][0]-r,l=a[s-1][1]-o;t.moveTo(u,c);for(var p=0;p<s-1;p++){var f=a[p];t.lineTo(f[0]-r,f[1]-o)}t.lineTo(h,l)}}),Va.register({token:{token:Cs,named:on.Polygon},useValue:function(t,e){var n=e.defX,r=void 0===n?0:n,i=e.defY,o=void 0===i?0:i,a=e.points.points,s=a.length,u=a[0][0]-r,c=a[0][1]-o,h=a[s-1][0]-r,l=a[s-1][1]-o;t.moveTo(u,c);for(var p=0;p<s-1;p++){var f=a[p];t.lineTo(f[0]-r,f[1]-o)}t.lineTo(h,l)}}),Va.register({token:{token:Cs,named:on.Path},useValue:function(t,e){var n=e.defX,r=void 0===n?0:n,i=e.defY,o=void 0===i?0:i,a=e.path,s=a.curve,u=a.zCommandIndexes,c=s;u.forEach((function(t,e){c.splice(t+e,0,["Z"])}));for(var h=0;h<c.length;h++){var l=c[h],p=l[0];switch(p){case"M":t.moveTo(l[1]-r,l[2]-o),[l[1]-r,l[2]-o];break;case"C":t.bezierCurveTo(l[1]-r,l[2]-o,l[3]-r,l[4]-o,l[5]-r,l[6]-o);break;case"Z":t.closePath()}if("Z"===p);else{var f=l.length;l[f-2],l[f-1]}}}}),Va.register({token:Ns,useFactory:function(t){var e={};return function(n){return e[n]||t.container.isBoundNamed(Cs,n)&&(e[n]=t.container.getNamed(Cs,n)),e[n]}}});var Ds=W((function(t){t(Ps),t({token:Is,useValue:new(Es())}),t(_s),t(Ms),t(As),t({token:ws,useFactory:function(t){var e={};return function(n){return e[n]||t.container.isBoundNamed(xs,n)&&(e[n]=t.container.getNamed(xs,n)),e[n]}}}),t(Ss),t(ks),t(Rs)})),Bs=function(){function t(){}return t.prototype.init=function(t){t.load(Ds,!0)},t.prototype.destroy=function(t){t.remove(Ps),t.remove(Is),t.remove(_s),t.remove(Ms),t.remove(As),t.remove(xs),t.remove(ws),t.remove(Ss),t.remove(ks),t.remove(Rs)},t}(),Ls="PointInPathPicker",js=function(){function t(){var t=this;this.isHit=function(e,n,r){var i=t.pointInPathPickerFactory(e.nodeName);if(i){var o=Oe(Se(),r),a=Zt(xt(),Mt(n[0],n[1],0),o),s=e.getGeometryBounds().halfExtents,u=e.parsedStyle.anchor,c=void 0===u?[0,0]:u;if(a[0]+=c[0]*s[0]*2,a[1]+=c[1]*s[1]*2,i(e,new Je(a[0],a[1]),t.isPointInPath))return!0}return!1},this.isPointInPath=function(e,n){var r=t.offscreenCanvas.getOrCreateContext(),i=t.pathGeneratorFactory(e.nodeName);return i&&i(r,e.parsedStyle),r.isPointInPath(n.x,n.y)}}var e;return e=t,t.prototype.apply=function(t){var n=this;t.hooks.pick.tap(e.tag,(function(t){var e=t.position,r=Mt(e.x,e.y,0),i=[],o=n.rBush.search({minX:r[0],minY:r[1],maxX:r[0],maxY:r[1]}),a=o.map((function(t){return t.id}));return o.forEach((function(t){var e=t.id,o=n.displayObjectPool.getByEntity(e);if(o.isVisible()&&o.interactive){if(o.parentNode&&-1===a.indexOf(o.parentNode.entity))return;var s=o.style.clipPath||o,u=o.getWorldTransform();o.style.clipPath&&(u=Ie(Se(),u,o.style.clipPath.getLocalTransform())),n.isHit(s,r,u)&&i.push(o)}})),i.sort(n.sceneGraphService.sort),t.picked=i[i.length-1]||null,t}))},t.tag="CanvasPickerPlugin",a([R(sn),s("design:type",Object)],t.prototype,"sceneGraphService",void 0),a([R(Y),s("design:type",Y)],t.prototype,"displayObjectPool",void 0),a([R(gn),s("design:type",gn)],t.prototype,"offscreenCanvas",void 0),a([R(Is),s("design:type",Function)],t.prototype,"rBush",void 0),a([R(Ns),s("design:type",Function)],t.prototype,"pathGeneratorFactory",void 0),a([R(Ls),s("design:type",Function)],t.prototype,"pointInPathPickerFactory",void 0),e=a([k({contrib:Fi})],t)}();function Fs(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function Gs(t,e,n,r,i,o){return i>=t&&i<=t+n&&o>=e&&o<=e+r}function Us(t,e,n,r,i,o,a,s){var u=(Math.atan2(s-e,a-t)+2*Math.PI)%(2*Math.PI);if(u<r||u>i)return!1;var c={x:t+n*Math.cos(u),y:e+n*Math.sin(u)};return Fs(c.x,c.y,a,s)<=o/2}function Vs(t,e,n,r,i,o,a){var s=Math.min(t,n),u=Math.max(t,n),c=Math.min(e,r),h=Math.max(e,r),l=i/2;return o>=s-l&&o<=u+l&&a>=c-l&&a<=h+l&&Qr(t,e,n,r,o,a)<=i/2}function Ws(t,e,n,r,i){var o=t.length;if(o<2)return!1;for(var a=0;a<o-1;a++)if(Vs(t[a][0],t[a][1],t[a+1][0],t[a+1][1],e,n,r))return!0;if(i){var s=t[0],u=t[o-1];if(Vs(s[0],s[1],u[0],u[1],e,n,r))return!0}return!1}function zs(t){return Math.abs(t)<1e-6?0:t<0?-1:1}function Hs(t,e,n){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function qs(t,e,n){var r=!1,i=t.length;if(i<=2)return!1;for(var o=0;o<i;o++){var a=t[o],s=t[(o+1)%i];if(Hs(a,s,[e,n]))return!0;zs(a[1]-n)>0!=zs(s[1]-n)>0&&zs(e-(n-a[1])*(a[0]-s[0])/(a[1]-s[1])-a[0])<0&&(r=!r)}return r}function Ys(t,e,n){for(var r=!1,i=0;i<t.length&&!(r=qs(t[i],e,n));i++);return r}function Xs(t,e){var n=t.parsedStyle,r=n.r,i=void 0===r?0:r,o=n.fill,a=n.stroke,s=n.lineWidth,u=void 0===s?0:s,c=n.clipPathTargets,h=u/2,l=Fs(i,i,e.x,e.y),p=!!(null==c?void 0:c.length);return o&&a||p?l<=i+h:o?l<=i:!!a&&l>=i-h&&l<=i+h}function $s(t,e,n,r){return t/(n*n)+e/(r*r)}function Ks(t,e){var n=e.x,r=e.y,i=t.parsedStyle,o=i.rx,a=void 0===o?0:o,s=i.ry,u=void 0===s?0:s,c=i.fill,h=i.stroke,l=i.lineWidth,p=void 0===l?0:l,f=i.clipPathTargets,d=!!(null==f?void 0:f.length),y=p/2,v=(n-a)*(n-a),g=(r-u)*(r-u);return c&&h||d?$s(v,g,a+y,u+y)<=1:c?$s(v,g,a,u)<=1:!!h&&$s(v,g,a-y,u-y)>=1&&$s(v,g,a+y,u+y)<=1}function Js(t,e){var n=t.parsedStyle,r=n.x1,i=n.y1,o=n.x2,a=n.y2,s=n.lineWidth,u=void 0===s?0:s,c=n.defX,h=void 0===c?0:c,l=n.defY,p=void 0===l?0:l;return Vs(r,i,o,a,u,e.x+h,e.y+p)}function Zs(t,e){var n=t.parsedStyle,r=n.stroke,i=n.lineWidth,o=void 0===i?0:i,a=n.points,s=n.defX,u=void 0===s?0:s,c=n.defY,h=void 0===c?0:c,l=n.clipPathTargets,p=!!(null==l?void 0:l.length);return!(!r&&!p||!o)&&Ws(a.points,o,e.x+u,e.y+h,!1)}function Qs(t,e,n){var r=t.parsedStyle,i=r.lineWidth,o=void 0===i?0:i,a=r.stroke,s=r.fill,u=r.defX,c=void 0===u?0:u,h=r.defY,l=void 0===h?0:h,p=r.clipPathTargets,f=r.path,d=f.segments,y=f.hasArc,v=f.polylines,g=f.polygons,m=f.totalLength,b=!!(null==p?void 0:p.length),T=!1;return(a||b)&&(T=function(t,e,n,r,i,o,a){for(var s,u,c=!1,h=e/2,l=0;l<t.length;l++){var p=t[l],f=p.currentPoint,d=p.params,y=p.prePoint,v=p.box;if(!v||Gs(v.x-h,v.y-h,v.width+e,v.height+e,n,r)){switch(p.command){case"L":case"Z":c=Vs(y[0],y[1],f[0],f[1],e,n,r);break;case"Q":c=ai.pointDistance(y[0],y[1],d[1],d[2],d[3],d[4],n,r)<=e/2;break;case"C":c=pi.pointDistance(y[0],y[1],d[1],d[2],d[3],d[4],d[5],d[6],n,r,i)<=e/2;break;case"A":var g=p.arcParams,m=g.cx,b=g.cy,T=g.rx,E=g.ry,w=g.startAngle,x=g.endAngle,_=g.xRotation,P=T>E?T:E,M=T>E?1:T/E,A=T>E?E/T:1,S=(u=[-m,-b],(s=bt())[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=1,s[5]=0,s[6]=u[0],s[7]=u[1],s[8]=1,s);Tt(S,Et(bt(),-_),S),Tt(S,wt(bt(),[1/M,1/A]),S);var N=$r(n,r);c=Us(0,0,P,w,x,e,(N=Kr(N,N,S))[0],N[1])}if(c)break}}return c}(d,o,e.x+c,e.y+l,m)),T||!s&&!b||(T=y?n(t,e):Ys(g,e.x+c,e.y+l)||Ys(v,e.x+c,e.y+l)),T}function tu(t,e,n){var r=t.parsedStyle,i=r.radius,o=r.fill,a=r.stroke,s=r.lineWidth,u=void 0===s?0:s,c=r.width,h=r.height,l=r.clipPathTargets,p=!!(null==l?void 0:l.length);if(i){var f=!1;return(a||p)&&(f=function(t,e,n,r,i,o,a,s){return Vs(0+i,0,0+n-i,0,o,a,s)||Vs(0+n,0+i,0+n,0+r-i,o,a,s)||Vs(0+n-i,0+r,0+i,0+r,o,a,s)||Vs(0,0+r-i,0,0+i,o,a,s)||Us(0+n-i,0+i,i,1.5*Math.PI,2*Math.PI,o,a,s)||Us(0+n-i,0+r-i,i,0,.5*Math.PI,o,a,s)||Us(0+i,0+r-i,i,.5*Math.PI,Math.PI,o,a,s)||Us(0+i,0+i,i,Math.PI,1.5*Math.PI,o,a,s)}(0,0,c,h,i,u,e.x,e.y)),f||!o&&!p||(f=n(t,e)),f}var d=u/2;return o&&a||p?Gs(0-d,0-d,c+d,h+d,e.x,e.y):o?Gs(0,0,c,h,e.x,e.y):!!a&&function(t,e,n,r,i,o,a){var s=i/2;return Gs(0-s,0-s,n,i,o,a)||Gs(0+n-s,0-s,i,r,o,a)||Gs(0+s,0+r-s,n,i,o,a)||Gs(0-s,0+s,i,r,o,a)}(0,0,c,h,u,e.x,e.y)}function eu(t,e){var n=t.parsedStyle,r=n.stroke,i=n.fill,o=n.lineWidth,a=void 0===o?0:o,s=n.points,u=n.defX,c=void 0===u?0:u,h=n.defY,l=void 0===h?0:h,p=n.clipPathTargets,f=!!(null==p?void 0:p.length),d=!1;return(r||f)&&(d=Ws(s.points,a,e.x+c,e.y+l,!0)),d||!i&&!f||(d=qs(s.points,e.x+c,e.y+l)),d}var nu=W((function(t){t({token:Ls,useFactory:function(t){return function(t){return t===on.Circle?Xs:t===on.Ellipse?Ks:t===on.Rect?tu:t===on.Line?Js:t===on.Polyline?Zs:t===on.Polygon?eu:t===on.Path?Qs:t===on.Image||t===on.Text?function(){return!0}:null}}}),t(js)})),ru=function(){function t(){}return t.prototype.init=function(t){t.load(nu,!0)},t.prototype.destroy=function(t){t.remove(Ls),t.remove(js)},t}(),iu="g-html-",ou=function(){function t(){}var e;return e=t,t.prototype.apply=function(t){var n=this,r=function(t){var e=t.target;if(e.nodeName===on.HTML){var r=e.parsedStyle.innerHTML,i=iu+e.entity,o=n.contextService.getDomElement().parentNode;if(!o.querySelector("#"+i)){var a=document.createElement("div");e.parsedStyle.$el=a,a.id=i,rt(r)?a.innerHTML=r:a.appendChild(r),o.appendChild(a)}}},i=function(t){var e=t.target;if(e.nodeName===on.HTML){var r=iu+e.entity,i=n.contextService.getDomElement().parentNode,o=i.querySelector("#"+r);o&&i.removeChild(o)}};t.hooks.init.tap(e.tag,(function(){n.renderingContext.root.addEventListener(ze.MOUNTED,r),n.renderingContext.root.addEventListener(ze.UNMOUNTED,i)})),t.hooks.destroy.tap(e.tag,(function(){n.renderingContext.root.removeEventListener(ze.MOUNTED,r),n.renderingContext.root.removeEventListener(ze.UNMOUNTED,i)})),t.hooks.render.tap(e.tag,(function(t){if(t.nodeName===on.HTML){var e=iu+t.entity,r=n.contextService.getDomElement().parentNode.querySelector("#"+e);n.updateCSSStyle(r,t.parsedStyle,t)}}))},t.prototype.updateCSSStyle=function(t,e,n){var r=e.zIndex,i=void 0===r?0:r,o=e.visibility,a=void 0===o?"visible":o,s=e.opacity,u=void 0===s?1:s,c=e.fill,h=e.lineWidth,l=void 0===h?0:h,p=e.lineDash,f=e.stroke,d=e.anchor,y=e.width,v=void 0===y?0:y,g=e.height,m=void 0===g?0:g,b=e.style,T=void 0===b?"":b,E=e.className,w=void 0===E?"":E,x={position:"absolute",top:0,left:0};if(x.width=v+"px",x.height=m+"px",x.transform="matrix3d("+n.getWorldTransform().join(",")+")",d&&(x.transform+=" translate("+100*d[0]+"%, "+100*d[0]+"%)"),n.style.transformOrigin&&(x["transform-origin"]=n.style.transformOrigin),x["z-index"]=i,x.visibility=a,x.opacity=u,c){var _="";c.type===qi.Constant?_=c.formatted:c.type===qi.LinearGradient?_="linear-gradient(to right, "+c.value.steps.map((function(t){return t[1]+" "+100*Number(t[0])+"%"})).join(",")+");":c.type===qi.RadialGradient||(c.type,qi.Pattern),x.background=_}x["border-width"]=l+"px",f&&f.type===qi.Constant&&(x["border-color"]=f.formatted,x["border-style"]="solid"),p&&(x["border-style"]="dashed"),n.style.filter&&(x.filter=n.style.filter),w&&(Array.isArray(w)?w.forEach((function(e){t.classList.add(e)})):t.classList.add(w)),t.setAttribute("style",Object.keys(x).map((function(t){return t+":"+x[t]})).join(";")+T)},t.tag="HTMLRenderingPlugin",a([R(An),s("design:type",Object)],t.prototype,"contextService",void 0),a([R(Nn),s("design:type",Object)],t.prototype,"renderingContext",void 0),e=a([k({contrib:Fi})],t)}(),au=W((function(t){t(ou)})),su=function(){function t(){}return t.prototype.init=function(t){t.load(au,!0)},t.prototype.destroy=function(t){t.remove(ou)},t}(),uu="undefined"!=typeof window&&void 0!==window.document,cu=function(){function t(){}return t.prototype.init=function(){var t=this.canvasConfig,e=t.container,n=t.width,r=t.height;if(this.$container=rt(e)?document.getElementById(e):e,this.$container){var i=document.createElement("canvas");this.context=i.getContext("2d"),this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i;var o=window.devicePixelRatio||1;o=o>=1?Math.ceil(o):1,this.dpr=o,this.resize(n,r)}},t.prototype.getContext=function(){return this.context},t.prototype.getDomElement=function(){return this.$canvas},t.prototype.getDPR=function(){return this.dpr},t.prototype.getBoundingClientRect=function(){var t;return null===(t=this.$canvas)||void 0===t?void 0:t.getBoundingClientRect()},t.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},t.prototype.resize=function(t,e){if(this.$canvas){this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,function(t,e,n){uu&&(t.style.width=e+"px",t.style.height=n+"px")}(this.$canvas,t,e);var n=this.getDPR();this.context.scale(n,n)}},t.prototype.applyCursorStyle=function(t){this.$container&&(this.$container.style.cursor=t)},a([R(pn),s("design:type",Object)],t.prototype,"canvasConfig",void 0),a([k({token:An})],t)}(),hu=W((function(t){t(cu)})),lu=function(){function t(){}return t.prototype.init=function(t){t.load(hu,!0)},t.prototype.destroy=function(t){t.remove(cu)},t}(),pu=function(t){function e(e){var n=t.call(this,e)||this;return n.registerPlugin(new lu),n.registerPlugin(new Bs),n.registerPlugin(new bs),n.registerPlugin(new ru),n.registerPlugin(new su),n}return r(e,t),e}(Ya);class fu extends HTMLElement{gElement=null;connectedCallback(){const{clientWidth:t,clientHeight:e}=this,n=this.attachShadow({mode:"closed"}),r=document.createElement("div");n.appendChild(r),this.gElement=new ds({container:r,width:t||0,height:e||0,renderer:this.renderer})}}const du=fu,yu=(t,e)=>customElements.get(t)||customElements.define(t,e);class vu extends HTMLElement{gElement=null;connectedCallback(){if(this.parentElement.gElement){const t=this.callClass,e=Object.fromEntries(Array.from(this.attributes).map((t=>[t.name,Number.isNaN(Number(t.value))?t.value:Number(t.value)])));this.innerText&&(e.text=this.innerText),this.gElement=new t({style:e}),this.parentElement.gElement.appendChild(this.gElement)}}static get observedAttributes(){return["x","y","z","visibility","zIndex","cursor","width","height","zIndex","r","path","points","fill","stroke","opacity","text"]}attributeChangedCallback(t,e,n){this.gElement&&this.gElement.attr(t,Number.isNaN(Number(n))?n:Number(n))}disconnectedCallback(){this.gElement.remove(),this.gElement=null}}yu("g-circle",class extends vu{callClass=Si}),yu("g-ellipse",class extends vu{callClass=Ni}),yu("g-text",class extends vu{callClass=Bi}),yu("g-rect",class extends vu{callClass=Di}),yu("g-path",class extends vu{callClass=Ii}),yu("g-polygon",class extends vu{callClass=ki}),customElements.define("g-canvas",class extends du{renderer=new pu})})()})();